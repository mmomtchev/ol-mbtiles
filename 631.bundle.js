(()=>{"use strict";var e,t,r={4631:(e,t,r)=>{var n=r(6186);const o={};var s=r(7028),i=r(7400);const a={};n.fF.threads("SQLite worker started"),globalThis.onmessage=({data:e})=>{n.fF.threads("SQLite received green light",e);const t=e;r.e(88).then(r.bind(r,88)).then((e=>e.default())).then((e=>{n.fF.threads("SQLite init"),e.initWorker1API(),"object"==typeof t.httpChannel?function(e,t,r){if("undefined"==typeof SharedArrayBuffer)throw new Error('SharedArrayBuffer is not available. If your browser supports it, the webserver must send "Cross-Origin-Opener-Policy: same-origin "and "Cross-Origin-Embedder-Policy: require-corp" headers.');if(!(t&&t.port instanceof MessagePort&&t.shm instanceof SharedArrayBuffer))throw new Error("No backend message channel in options");const s=new Int32Array(t.shm,t.shm.byteLength-Int32Array.BYTES_PER_ELEMENT),i=new Uint8Array(t.shm,0,t.shm.byteLength-Int32Array.BYTES_PER_ELEMENT),a=e.capi,c=e.wasm,u=a.sqlite3_vfs,f=a.sqlite3_file,l=a.sqlite3_io_methods,p=new u,d=new l;p.$iVersion=1,p.$szOsFile=a.sqlite3_file.structInfo.sizeof,p.$mxPathname=1024,p.$zName=c.allocCString("http"),p.$xDlOpen=p.$xDlError=p.$xDlSym=p.$xDlClose=null;const v=e=>{var o;let i,a;Atomics.store(s,0,n.J3.WORKMSG),t.port.postMessage(e);do{i=Atomics.wait(s,0,n.J3.WORKMSG,null!==(o=null==r?void 0:r.timeout)&&void 0!==o?o:n.vC.timeout),a=Atomics.load(s,0)}while("ok"===i&&a===n.J3.WORKMSG);return"timed-out"===i?(console.error("Backend timeout",i,s,e),-1):a},h={xCheckReservedLock:function(e,t){return n.fF.vfs("xCheckReservedLock",e,t),c.poke(t,0,"i32"),0},xClose:function(e){return n.fF.vfs("xClose",e),o[e]?(delete o[e],0):a.SQLITE_NOTFOUND},xDeviceCharacteristics:function(e){return n.fF.vfs("xDeviceCharacteristics",e),a.SQLITE_IOCAP_IMMUTABLE},xFileControl:function(e,t,r){return n.fF.vfs("xFileControl",e,t,r),t===a.SQLITE_FCNTL_SYNC?a.SQLITE_OK:a.SQLITE_NOTFOUND},xFileSize:function(e,r){if(n.fF.vfs("xFileSize",e,r),!o[e])return a.SQLITE_NOTFOUND;if(0!==v({msg:"xFilesize",url:o[e].url}))return a.SQLITE_IOERR;const s=new BigUint64Array(t.shm,0,1)[0];return n.fF.vfs("file size is ",s),c.poke(r,s,"i64"),0},xLock:function(e,t){return n.fF.vfs("xLock",e,t),0},xRead:function(e,t,r,s){if(n.fF.vfs("xRead",e,t,r,s),Number(s)>Number.MAX_SAFE_INTEGER)return a.SQLITE_TOOBIG;if(!o[e])return a.SQLITE_NOTFOUND;const u=v({msg:"xRead",url:o[e].url,n:r,offset:s});return 0!==u?(console.error("xRead",u),a.SQLITE_IOERR):(c.heap8u().set(i.subarray(0,r),t),a.SQLITE_OK)},xSync:function(e,t){return n.fF.vfs("xSync",e,t),0},xTruncate:function(e,t){return n.fF.vfs("xTruncate",e,t),0},xUnlock:function(e,t){return n.fF.vfs("xUnlock",e,t),0},xWrite:function(e,t,r,o){return n.fF.vfs("xWrite",e,t,r,o),a.SQLITE_READONLY}},E={xAccess:function(e,r,o,s){if(n.fF.vfs("xAccess",e,r,o,s),0==(o&a.SQLITE_OPEN_READONLY))return c.poke(s,0,"i32"),a.SQLITE_OK;const i=c.cstrToJs(r),u=v({msg:"xAccess",url:i});if(0!==u)return console.error("xAccess",u),a.SQLITE_IOERR;const f=new Uint32Array(t.shm,0,1)[0];return c.poke(s,f,"i32"),a.SQLITE_OK},xCurrentTime:function(e,t){return n.fF.vfs("xCurrentTime",e,t),c.poke(t,2440587.5+(new Date).getTime()/864e5,"double"),0},xCurrentTimeInt64:function(e,t){return n.fF.vfs("xCurrentTimeInt64",e,t),c.poke(t,BigInt(2440587.5)*BigInt(864e5)+BigInt((new Date).getTime()),"i64"),0},xDelete:function(e,t,r){return n.fF.vfs("xDelete",e,t,r),a.SQLITE_READONLY},xFullPathname:function(e,t,r,o){return n.fF.vfs("xFullPathname",e,t,r,o),c.cstrncpy(o,t,r)<r?0:a.SQLITE_CANTOPEN},xGetLastError:function(e,t,r){return n.fF.vfs("xGetLastError",e,t,r),0},xOpen:function(e,t,r,s,i){if(n.fF.vfs("xOpen",e,t,r,s,i),0===t)return console.error("HTTP VFS does not support anonymous files"),a.SQLITE_CANTOPEN;if("number"!=typeof t)return a.SQLITE_ERROR;c.poke(i,a.SQLITE_OPEN_READONLY,"i32");const u=c.cstrToJs(t),l=Object.create(null);l.fid=r,l.url=u,l.sq3File=new f(r),l.sq3File.$pMethods=d.pointer,o[r]=l;const p=v({msg:"xOpen",url:u});return p<0?(console.error("xOpen",p),a.SQLITE_IOERR):0!==p?(console.error("xOpen",p),a.SQLITE_CANTOPEN):a.SQLITE_OK}};e.vfs.installVfs({io:{struct:d,methods:h},vfs:{struct:p,methods:E}}),e.oo1.DB.dbCtorHelper.setVfsPostOpenSql(p.pointer,(function(e,t){var o;t.capi.sqlite3_busy_timeout(e,null!==(o=null==r?void 0:r.timeout)&&void 0!==o?o:n.vC.timeout),t.capi.sqlite3_exec(e,["PRAGMA journal_mode=DELETE;","PRAGMA cache_size=0;"],0,0,0)}))}(e,t.httpChannel,t.httpOptions):!0===t.httpChannel&&(void 0===globalThis.XMLHttpRequest&&(globalThis.XMLHttpRequest=class extends(null){get response(){return Uint8Array.from(this.responseText.split("").map((e=>e.charCodeAt(0)))).buffer}}),function(e,t){const r=e.capi,o=e.wasm,c=r.sqlite3_vfs,u=r.sqlite3_file,f=r.sqlite3_io_methods,l=new c,p=new f;l.$iVersion=1,l.$szOsFile=r.sqlite3_file.structInfo.sizeof,l.$mxPathname=1024,l.$zName=o.allocCString("http"),l.$xDlOpen=l.$xDlError=l.$xDlSym=l.$xDlClose=null;const d={xCheckReservedLock:function(e,t){return n.fF.vfs("xCheckReservedLock",e,t),o.poke(t,0,"i32"),0},xClose:function(e){return n.fF.vfs("xClose",e),a[e]?(delete a[e],0):r.SQLITE_NOTFOUND},xDeviceCharacteristics:function(e){return n.fF.vfs("xDeviceCharacteristics",e),r.SQLITE_IOCAP_IMMUTABLE},xFileControl:function(e,t,o){return n.fF.vfs("xFileControl",e,t,o),t===r.SQLITE_FCNTL_SYNC?r.SQLITE_OK:r.SQLITE_NOTFOUND},xFileSize:function(e,t){return n.fF.vfs("xFileSize",e,t),a[e]?(n.fF.vfs("file size is ",a[e].size),o.poke(t,a[e].size,"i64"),0):r.SQLITE_NOTFOUND},xLock:function(e,t){return n.fF.vfs("xLock",e,t),0},xRead:function(e,s,c,u){var f,l,p,v;if(n.fF.vfs("xRead (sync)",e,s,c,u),Number(u)>Number.MAX_SAFE_INTEGER)return r.SQLITE_TOOBIG;if(!a[e])return r.SQLITE_NOTFOUND;const h=a[e];if(!h.pageSize){h.pageSize=1024;const o=new Uint8Array(2),s=d.xRead(e,o,2,BigInt(16)),a=new Uint16Array(o.buffer);if(0!==s)return r.SQLITE_IOERR;if((0,i.g)(a),h.pageSize=a[0],n.fF.vfs(`page size is ${h.pageSize}`),1024!=h.pageSize&&(console.warn(`Page size for ${h.url} is ${h.pageSize}, recommended size is 1024`),h.pageCache.delete(0)),h.pageSize>(null!==(f=null==t?void 0:t.maxPageSize)&&void 0!==f?f:n.vC.maxPageSize))throw new Error(`${h.pageSize} is over the maximum configured ${null!==(l=null==t?void 0:t.maxPageSize)&&void 0!==l?l:n.vC.maxPageSize}`)}try{const e=BigInt(h.pageSize),i=BigInt(c),a=u/e;a*e!==u&&n.fF.vfs(`Read chunk ${u} is not page-aligned`);let f=a*e;if(f+e<u+i)throw new Error(`Read chunk ${u}:${c} spans across a page-boundary`);let l=h.pageCache.get(Number(a));if("number"==typeof l){n.fF.cache(`[sync] cache hit (multi-page segment) for ${h.url}:${a}`);const t=BigInt(l)*e;l=h.pageCache.get(l),l instanceof Uint8Array?f=t:l=void 0}if(void 0===l){n.fF.cache(`[sync] cache miss for ${h.url}:${a}`);let e=h.pageSize,o=a>0&&h.pageCache.get(Number(a)-1);o&&("number"==typeof o&&(o=h.pageCache.get(o)),o instanceof Uint8Array&&(e=2*o.byteLength,n.fF.cache(`[sync] downloading super page of size ${e}`)));const s=e/h.pageSize;n.fF.http(`downloading page ${a} of size ${e} starting at ${f}`);const i=new XMLHttpRequest;i.open("GET",h.url,!1);for(const e of Object.keys(null!==(p=null==t?void 0:t.headers)&&void 0!==p?p:n.vC.headers))i.setRequestHeader(e,(null!==(v=null==t?void 0:t.headers)&&void 0!==v?v:n.vC.headers)[e]);if(i.setRequestHeader("Range",`bytes=${f}-${f+BigInt(e-1)}`),i.responseType="arraybuffer",i.onload=()=>{i.response instanceof ArrayBuffer&&(l=new Uint8Array(i.response))},i.send(),!l)return r.SQLITE_IOERR;if(!(l instanceof Uint8Array)||0===l.length)throw new Error(`Invalid HTTP response received: ${JSON.stringify(i.response)}`);h.pageCache.set(Number(a),l);for(let e=Number(a)+1;e<Number(a)+s;e++)h.pageCache.set(e,Number(a))}else n.fF.cache(`[sync] cache hit for ${h.url}:${a}`);const d=Number(u-f);return s instanceof Uint8Array?s.set(l.subarray(d,d+c)):o.heap8u().set(l.subarray(d,d+c),s),r.SQLITE_OK}catch(e){return console.error(e),r.SQLITE_ERROR}},xSync:function(e,t){return n.fF.vfs("xSync",e,t),0},xTruncate:function(e,t){return n.fF.vfs("xTruncate",e,t),0},xUnlock:function(e,t){return n.fF.vfs("xUnlock",e,t),0},xWrite:function(e,t,o,s){return n.fF.vfs("xWrite",e,t,o,s),r.SQLITE_READONLY}},v={xAccess:function(e,t,s,i){if(n.fF.vfs("xAccess",e,t,s,i),0==(s&r.SQLITE_OPEN_READONLY))return o.poke(i,0,"i32"),r.SQLITE_OK;const a=Symbol();return v.xOpen(e,t,a,s,i)===r.SQLITE_OK?(d.xClose(a),o.poke(i,1,"i32")):o.poke(i,0,"i32"),r.SQLITE_OK},xCurrentTime:function(e,t){return n.fF.vfs("xCurrentTime",e,t),o.poke(t,2440587.5+(new Date).getTime()/864e5,"double"),0},xCurrentTimeInt64:function(e,t){return n.fF.vfs("xCurrentTimeInt64",e,t),o.poke(t,BigInt(2440587.5)*BigInt(864e5)+BigInt((new Date).getTime()),"i64"),0},xDelete:function(e,t,o){return n.fF.vfs("xDelete",e,t,o),r.SQLITE_READONLY},xFullPathname:function(e,t,s,i){return n.fF.vfs("xFullPathname",e,t,s,i),o.cstrncpy(i,t,s)<s?0:r.SQLITE_CANTOPEN},xGetLastError:function(e,t,r){return n.fF.vfs("xGetLastError",e,t,r),0},xOpen:function(e,i,c,f,l){var d,v;if(n.fF.vfs("xOpen (sync)",e,i,c,f,l),0===i)return console.error("HTTP VFS does not support anonymous files"),r.SQLITE_CANTOPEN;if("number"!=typeof i)return r.SQLITE_ERROR;const h=o.cstrToJs(i);let E=!1;try{const e=new XMLHttpRequest;e.open("HEAD",h,!1);for(const r of Object.keys(null!==(d=null==t?void 0:t.headers)&&void 0!==d?d:n.vC.headers))e.setRequestHeader(r,(null!==(v=null==t?void 0:t.headers)&&void 0!==v?v:n.vC.headers)[r]);e.onload=()=>{var r,o;const i=Object.create(null);i.fid=c,i.url=h,i.sq3File=new u(c),i.sq3File.$pMethods=p.pointer,i.size=BigInt(null!==(r=e.getResponseHeader("Content-Length"))&&void 0!==r?r:0),i.pageCache=new s.Z({maxSize:1024*(null!==(o=null==t?void 0:t.cacheSize)&&void 0!==o?o:n.vC.cacheSize),sizeCalculation:e=>{var t;return null!==(t=e.byteLength)&&void 0!==t?t:4}}),"bytes"!==e.getResponseHeader("Accept-Ranges")&&console.warn(`Server for ${h} does not advertise 'Accept-Ranges'. If the server supports it, in order to remove this message, add "Accept-Ranges: bytes". Additionally, if using CORS, add "Access-Control-Expose-Headers: *".`),a[c]=i,E=!0},e.send()}catch(e){console.error("xOpen",e)}return E?(o.poke(l,r.SQLITE_OPEN_READONLY,"i32"),r.SQLITE_OK):(console.error("xOpen"),r.SQLITE_CANTOPEN)}};e.vfs.installVfs({io:{struct:p,methods:d},vfs:{struct:l,methods:v}}),e.oo1.DB.dbCtorHelper.setVfsPostOpenSql(l.pointer,(function(e,r){var o;r.capi.sqlite3_busy_timeout(e,null!==(o=null==t?void 0:t.timeout)&&void 0!==o?o:n.vC.timeout),r.capi.sqlite3_exec(e,["PRAGMA journal_mode=DELETE;","PRAGMA cache_size=0;"],0,0,0)}))}(e,t.httpOptions))}))}}},n={};function o(e){var t=n[e];if(void 0!==t)return t.exports;var s=n[e]={exports:{}};return r[e](s,s.exports,o),s.exports}o.m=r,o.x=()=>{var e=o.O(void 0,[906],(()=>o(4631)));return o.O(e)},e=[],o.O=(t,r,n,s)=>{if(!r){var i=1/0;for(f=0;f<e.length;f++){for(var[r,n,s]=e[f],a=!0,c=0;c<r.length;c++)(!1&s||i>=s)&&Object.keys(o.O).every((e=>o.O[e](r[c])))?r.splice(c--,1):(a=!1,s<i&&(i=s));if(a){e.splice(f--,1);var u=n();void 0!==u&&(t=u)}}return t}s=s||0;for(var f=e.length;f>0&&e[f-1][2]>s;f--)e[f]=e[f-1];e[f]=[r,n,s]},o.d=(e,t)=>{for(var r in t)o.o(t,r)&&!o.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},o.f={},o.e=e=>Promise.all(Object.keys(o.f).reduce(((t,r)=>(o.f[r](e,t),t)),[])),o.u=e=>e+".bundle.js",o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;o.g.importScripts&&(e=o.g.location+"");var t=o.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");r.length&&(e=r[r.length-1].src)}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),o.p=e})(),(()=>{o.b=self.location+"";var e={631:1};o.f.i=(t,r)=>{e[t]||importScripts(o.p+o.u(t))};var t=self.webpackChunkol_mbtiles=self.webpackChunkol_mbtiles||[],r=t.push.bind(t);t.push=t=>{var[n,s,i]=t;for(var a in s)o.o(s,a)&&(o.m[a]=s[a]);for(i&&i(o);n.length;)e[n.pop()]=1;r(t)}})(),t=o.x,o.x=()=>o.e(906).then(t),o.x()})();
//# sourceMappingURL=631.bundle.js.map
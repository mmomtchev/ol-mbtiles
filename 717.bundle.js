(self.webpackChunkol_mbtiles=self.webpackChunkol_mbtiles||[]).push([[717],{2582:function(t){t.exports=function(){"use strict";function t(t,n,r,s,o){!function t(i,n,r,s,o){for(;s>r;){if(s-r>600){var a=s-r+1,l=n-r+1,h=Math.log(a),c=.5*Math.exp(2*h/3),u=.5*Math.sqrt(h*c*(a-c)/a)*(l-a/2<0?-1:1);t(i,n,Math.max(r,Math.floor(n-l*c/a+u)),Math.min(s,Math.floor(n+(a-l)*c/a+u)),o)}var g=i[n],d=r,f=s;for(e(i,r,n),o(i[s],g)>0&&e(i,r,s);d<f;){for(e(i,d,f),d++,f--;o(i[d],g)<0;)d++;for(;o(i[f],g)>0;)f--}0===o(i[r],g)?e(i,r,f):e(i,++f,s),f<=n&&(r=f+1),n<=f&&(s=f-1)}}(t,n,r||0,s||t.length-1,o||i)}function e(t,e,i){var n=t[e];t[e]=t[i],t[i]=n}function i(t,e){return t<e?-1:t>e?1:0}var n=function(t){void 0===t&&(t=9),this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function r(t,e,i){if(!i)return e.indexOf(t);for(var n=0;n<e.length;n++)if(i(t,e[n]))return n;return-1}function s(t,e){o(t,0,t.children.length,e,t)}function o(t,e,i,n,r){r||(r=f(null)),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(var s=e;s<i;s++){var o=t.children[s];a(r,t.leaf?n(o):o)}return r}function a(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function l(t,e){return t.minX-e.minX}function h(t,e){return t.minY-e.minY}function c(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function u(t){return t.maxX-t.minX+(t.maxY-t.minY)}function g(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function d(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function f(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function _(e,i,n,r,s){for(var o=[i,n];o.length;)if(!((n=o.pop())-(i=o.pop())<=r)){var a=i+Math.ceil((n-i)/r/2)*r;t(e,a,i,n,s),o.push(i,a,a,n)}}return n.prototype.all=function(){return this._all(this.data,[])},n.prototype.search=function(t){var e=this.data,i=[];if(!d(t,e))return i;for(var n=this.toBBox,r=[];e;){for(var s=0;s<e.children.length;s++){var o=e.children[s],a=e.leaf?n(o):o;d(t,a)&&(e.leaf?i.push(o):g(t,a)?this._all(o,i):r.push(o))}e=r.pop()}return i},n.prototype.collides=function(t){var e=this.data;if(!d(t,e))return!1;for(var i=[];e;){for(var n=0;n<e.children.length;n++){var r=e.children[n],s=e.leaf?this.toBBox(r):r;if(d(t,s)){if(e.leaf||g(t,s))return!0;i.push(r)}}e=i.pop()}return!1},n.prototype.load=function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0;e<t.length;e++)this.insert(t[e]);return this}var i=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===i.height)this._splitRoot(this.data,i);else{if(this.data.height<i.height){var n=this.data;this.data=i,i=n}this._insert(i,this.data.height-i.height-1,!0)}else this.data=i;return this},n.prototype.insert=function(t){return t&&this._insert(t,this.data.height-1),this},n.prototype.clear=function(){return this.data=f([]),this},n.prototype.remove=function(t,e){if(!t)return this;for(var i,n,s,o=this.data,a=this.toBBox(t),l=[],h=[];o||l.length;){if(o||(o=l.pop(),n=l[l.length-1],i=h.pop(),s=!0),o.leaf){var c=r(t,o.children,e);if(-1!==c)return o.children.splice(c,1),l.push(o),this._condense(l),this}s||o.leaf||!g(o,a)?n?(i++,o=n.children[i],s=!1):o=null:(l.push(o),h.push(i),i=0,n=o,o=o.children[0])}return this},n.prototype.toBBox=function(t){return t},n.prototype.compareMinX=function(t,e){return t.minX-e.minX},n.prototype.compareMinY=function(t,e){return t.minY-e.minY},n.prototype.toJSON=function(){return this.data},n.prototype.fromJSON=function(t){return this.data=t,this},n.prototype._all=function(t,e){for(var i=[];t;)t.leaf?e.push.apply(e,t.children):i.push.apply(i,t.children),t=i.pop();return e},n.prototype._build=function(t,e,i,n){var r,o=i-e+1,a=this._maxEntries;if(o<=a)return s(r=f(t.slice(e,i+1)),this.toBBox),r;n||(n=Math.ceil(Math.log(o)/Math.log(a)),a=Math.ceil(o/Math.pow(a,n-1))),(r=f([])).leaf=!1,r.height=n;var l=Math.ceil(o/a),h=l*Math.ceil(Math.sqrt(a));_(t,e,i,h,this.compareMinX);for(var c=e;c<=i;c+=h){var u=Math.min(c+h-1,i);_(t,c,u,l,this.compareMinY);for(var g=c;g<=u;g+=l){var d=Math.min(g+l-1,u);r.children.push(this._build(t,g,d,n-1))}}return s(r,this.toBBox),r},n.prototype._chooseSubtree=function(t,e,i,n){for(;n.push(e),!e.leaf&&n.length-1!==i;){for(var r=1/0,s=1/0,o=void 0,a=0;a<e.children.length;a++){var l=e.children[a],h=c(l),u=(g=t,d=l,(Math.max(d.maxX,g.maxX)-Math.min(d.minX,g.minX))*(Math.max(d.maxY,g.maxY)-Math.min(d.minY,g.minY))-h);u<s?(s=u,r=h<r?h:r,o=l):u===s&&h<r&&(r=h,o=l)}e=o||e.children[0]}var g,d;return e},n.prototype._insert=function(t,e,i){var n=i?t:this.toBBox(t),r=[],s=this._chooseSubtree(n,this.data,e,r);for(s.children.push(t),a(s,n);e>=0&&r[e].children.length>this._maxEntries;)this._split(r,e),e--;this._adjustParentBBoxes(n,r,e)},n.prototype._split=function(t,e){var i=t[e],n=i.children.length,r=this._minEntries;this._chooseSplitAxis(i,r,n);var o=this._chooseSplitIndex(i,r,n),a=f(i.children.splice(o,i.children.length-o));a.height=i.height,a.leaf=i.leaf,s(i,this.toBBox),s(a,this.toBBox),e?t[e-1].children.push(a):this._splitRoot(i,a)},n.prototype._splitRoot=function(t,e){this.data=f([t,e]),this.data.height=t.height+1,this.data.leaf=!1,s(this.data,this.toBBox)},n.prototype._chooseSplitIndex=function(t,e,i){for(var n,r,s,a,l,h,u,g=1/0,d=1/0,f=e;f<=i-e;f++){var _=o(t,0,f,this.toBBox),p=o(t,f,i,this.toBBox),m=(r=_,s=p,void 0,void 0,void 0,void 0,a=Math.max(r.minX,s.minX),l=Math.max(r.minY,s.minY),h=Math.min(r.maxX,s.maxX),u=Math.min(r.maxY,s.maxY),Math.max(0,h-a)*Math.max(0,u-l)),x=c(_)+c(p);m<g?(g=m,n=f,d=x<d?x:d):m===g&&x<d&&(d=x,n=f)}return n||i-e},n.prototype._chooseSplitAxis=function(t,e,i){var n=t.leaf?this.compareMinX:l,r=t.leaf?this.compareMinY:h;this._allDistMargin(t,e,i,n)<this._allDistMargin(t,e,i,r)&&t.children.sort(n)},n.prototype._allDistMargin=function(t,e,i,n){t.children.sort(n);for(var r=this.toBBox,s=o(t,0,e,r),l=o(t,i-e,i,r),h=u(s)+u(l),c=e;c<i-e;c++){var g=t.children[c];a(s,t.leaf?r(g):g),h+=u(s)}for(var d=i-e-1;d>=e;d--){var f=t.children[d];a(l,t.leaf?r(f):f),h+=u(l)}return h},n.prototype._adjustParentBBoxes=function(t,e,i){for(var n=i;n>=0;n--)a(e[n],t)},n.prototype._condense=function(t){for(var e=t.length-1,i=void 0;e>=0;e--)0===t[e].children.length?e>0?(i=t[e-1].children).splice(i.indexOf(t[e]),1):this.clear():s(t[e],this.toBBox)},n}()},6620:(t,e,i)=>{"use strict";i.d(e,{y:()=>r});var n=i(8532);function r(t){return Array.isArray(t)?(0,n.BB)(t):t}},4717:(t,e,i)=>{"use strict";i.d(e,{Z:()=>Re});var n=i(1295),r=i(2582),s=i(7539),o=i(283),a=i(1345),l=i(5487),h=i(553),c=i(8443),u=i(8532),g=i(9515),d=i(208),f=i(8326),_=i(8096),p=i(2710);let m=null;class x extends d.Z{constructor(t,e,i,n,r){super(),this.hitDetectionImage_=null,this.image_=t,this.crossOrigin_=i,this.canvas_={},this.color_=r,this.imageState_=void 0===n?h.Z.IDLE:n,this.size_=t&&t.width&&t.height?[t.width,t.height]:null,this.src_=e,this.tainted_}initializeImage_(){this.image_=new Image,null!==this.crossOrigin_&&(this.image_.crossOrigin=this.crossOrigin_)}isTainted_(){if(void 0===this.tainted_&&this.imageState_===h.Z.LOADED){m||(m=(0,f.E4)(1,1,void 0,{willReadFrequently:!0})),m.drawImage(this.image_,0,0);try{m.getImageData(0,0,1,1),this.tainted_=!1}catch(t){m=null,this.tainted_=!0}}return!0===this.tainted_}dispatchChangeEvent_(){this.dispatchEvent(l.Z.CHANGE)}handleImageError_(){this.imageState_=h.Z.ERROR,this.dispatchChangeEvent_()}handleImageLoad_(){this.imageState_=h.Z.LOADED,this.size_=[this.image_.width,this.image_.height],this.dispatchChangeEvent_()}getImage(t){return this.image_||this.initializeImage_(),this.replaceColor_(t),this.canvas_[t]?this.canvas_[t]:this.image_}getPixelRatio(t){return this.replaceColor_(t),this.canvas_[t]?t:1}getImageState(){return this.imageState_}getHitDetectionImage(){if(this.image_||this.initializeImage_(),!this.hitDetectionImage_)if(this.isTainted_()){const t=this.size_[0],e=this.size_[1],i=(0,f.E4)(t,e);i.fillRect(0,0,t,e),this.hitDetectionImage_=i.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_}getSize(){return this.size_}getSrc(){return this.src_}load(){if(this.imageState_===h.Z.IDLE){this.image_||this.initializeImage_(),this.imageState_=h.Z.LOADING;try{void 0!==this.src_&&(this.image_.src=this.src_)}catch(t){this.handleImageError_()}this.image_ instanceof HTMLImageElement&&(0,_.Q9)(this.image_,this.src_).then((t=>{this.image_=t,this.handleImageLoad_()})).catch(this.handleImageError_.bind(this))}}replaceColor_(t){if(!this.color_||this.canvas_[t]||this.imageState_!==h.Z.LOADED)return;const e=this.image_,i=document.createElement("canvas");i.width=Math.ceil(e.width*t),i.height=Math.ceil(e.height*t);const n=i.getContext("2d");n.scale(t,t),n.drawImage(e,0,0),n.globalCompositeOperation="multiply",n.fillStyle=(0,u.XC)(this.color_),n.fillRect(0,0,i.width/t,i.height/t),n.globalCompositeOperation="destination-in",n.drawImage(e,0,0),this.canvas_[t]=i}}var y=i(4187);function S(t,e,i,n){return void 0!==i&&void 0!==n?[i/t,n/e]:void 0!==i?i/t:void 0!==n?n/e:1}class w extends c.Z{constructor(t){const e=void 0!==(t=t||{}).opacity?t.opacity:1,i=void 0!==t.rotation?t.rotation:0,n=void 0!==t.scale?t.scale:1,r=void 0!==t.rotateWithView&&t.rotateWithView;super({opacity:e,rotation:i,scale:n,displacement:void 0!==t.displacement?t.displacement:[0,0],rotateWithView:r,declutterMode:t.declutterMode}),this.anchor_=void 0!==t.anchor?t.anchor:[.5,.5],this.normalizedAnchor_=null,this.anchorOrigin_=void 0!==t.anchorOrigin?t.anchorOrigin:"top-left",this.anchorXUnits_=void 0!==t.anchorXUnits?t.anchorXUnits:"fraction",this.anchorYUnits_=void 0!==t.anchorYUnits?t.anchorYUnits:"fraction",this.crossOrigin_=void 0!==t.crossOrigin?t.crossOrigin:null;const s=void 0!==t.img?t.img:null;let o,a=t.src;if((0,g.h)(!(void 0!==a&&s),"`image` and `src` cannot be provided at the same time"),void 0!==a&&0!==a.length||!s||(a=s.src||(0,y.sq)(s)),(0,g.h)(void 0!==a&&a.length>0,"A defined and non-empty `src` or `image` must be provided"),(0,g.h)(!((void 0!==t.width||void 0!==t.height)&&void 0!==t.scale),"`width` or `height` cannot be provided together with `scale`"),void 0!==t.src?o=h.Z.IDLE:void 0!==s&&(o=s instanceof HTMLImageElement?s.complete?s.src?h.Z.LOADED:h.Z.IDLE:h.Z.LOADING:h.Z.LOADED),this.color_=void 0!==t.color?(0,u._2)(t.color):null,this.iconImage_=function(t,e,i,n,r){let s=void 0===e?void 0:p.c.get(e,i,r);return s||(s=new x(t,t instanceof HTMLImageElement?t.src||void 0:e,i,n,r),p.c.set(e,i,r,s)),s}(s,a,this.crossOrigin_,o,this.color_),this.offset_=void 0!==t.offset?t.offset:[0,0],this.offsetOrigin_=void 0!==t.offsetOrigin?t.offsetOrigin:"top-left",this.origin_=null,this.size_=void 0!==t.size?t.size:null,void 0!==t.width||void 0!==t.height){let e,i;if(t.size)[e,i]=t.size;else{const n=this.getImage(1);if(n.width&&n.height)e=n.width,i=n.height;else if(n instanceof HTMLImageElement){this.initialOptions_=t;const e=()=>{if(this.unlistenImageChange(e),!this.initialOptions_)return;const i=this.iconImage_.getSize();this.setScale(S(i[0],i[1],t.width,t.height))};return void this.listenImageChange(e)}}void 0!==e&&this.setScale(S(e,i,t.width,t.height))}}clone(){let t,e,i;return this.initialOptions_?(e=this.initialOptions_.width,i=this.initialOptions_.height):(t=this.getScale(),t=Array.isArray(t)?t.slice():t),new w({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,crossOrigin:this.crossOrigin_,offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,opacity:this.getOpacity(),rotateWithView:this.getRotateWithView(),rotation:this.getRotation(),scale:t,width:e,height:i,size:null!==this.size_?this.size_.slice():void 0,src:this.getSrc(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getAnchor(){let t=this.normalizedAnchor_;if(!t){t=this.anchor_;const e=this.getSize();if("fraction"==this.anchorXUnits_||"fraction"==this.anchorYUnits_){if(!e)return null;t=this.anchor_.slice(),"fraction"==this.anchorXUnits_&&(t[0]*=e[0]),"fraction"==this.anchorYUnits_&&(t[1]*=e[1])}if("top-left"!=this.anchorOrigin_){if(!e)return null;t===this.anchor_&&(t=this.anchor_.slice()),"top-right"!=this.anchorOrigin_&&"bottom-right"!=this.anchorOrigin_||(t[0]=-t[0]+e[0]),"bottom-left"!=this.anchorOrigin_&&"bottom-right"!=this.anchorOrigin_||(t[1]=-t[1]+e[1])}this.normalizedAnchor_=t}const e=this.getDisplacement(),i=this.getScaleArray();return[t[0]-e[0]/i[0],t[1]+e[1]/i[1]]}setAnchor(t){this.anchor_=t,this.normalizedAnchor_=null}getColor(){return this.color_}getImage(t){return this.iconImage_.getImage(t)}getPixelRatio(t){return this.iconImage_.getPixelRatio(t)}getImageSize(){return this.iconImage_.getSize()}getImageState(){return this.iconImage_.getImageState()}getHitDetectionImage(){return this.iconImage_.getHitDetectionImage()}getOrigin(){if(this.origin_)return this.origin_;let t=this.offset_;if("top-left"!=this.offsetOrigin_){const e=this.getSize(),i=this.iconImage_.getSize();if(!e||!i)return null;t=t.slice(),"top-right"!=this.offsetOrigin_&&"bottom-right"!=this.offsetOrigin_||(t[0]=i[0]-e[0]-t[0]),"bottom-left"!=this.offsetOrigin_&&"bottom-right"!=this.offsetOrigin_||(t[1]=i[1]-e[1]-t[1])}return this.origin_=t,this.origin_}getSrc(){return this.iconImage_.getSrc()}getSize(){return this.size_?this.size_:this.iconImage_.getSize()}getWidth(){const t=this.getScaleArray();return this.size_?this.size_[0]*t[0]:this.iconImage_.getImageState()==h.Z.LOADED?this.iconImage_.getSize()[0]*t[0]:void 0}getHeight(){const t=this.getScaleArray();return this.size_?this.size_[1]*t[1]:this.iconImage_.getImageState()==h.Z.LOADED?this.iconImage_.getSize()[1]*t[1]:void 0}setScale(t){delete this.initialOptions_,super.setScale(t)}listenImageChange(t){this.iconImage_.addEventListener(l.Z.CHANGE,t)}load(){this.iconImage_.load()}unlistenImageChange(t){this.iconImage_.removeEventListener(l.Z.CHANGE,t)}}const v=w;var T=i(5393),I=i(8958),E=i(1280),k=i(5537);let C=0;const R=0,b=1<<C++,O=1<<C++,D=1<<C++,M=1<<C++,L=1<<C++,A=Math.pow(2,5)-1,F={[b]:"boolean",[O]:"number",[D]:"string",[M]:"color",[L]:"number[]"},P=Object.keys(F).map(Number).sort(k.j2);function W(t){const e=[];for(const n of P)(t&(i=n))===i&&e.push(F[n]);var i;return 0===e.length?"untyped":e.length<3?e.join(" or "):e.slice(0,-1).join(", ")+", or "+e[e.length-1]}function B(t,e){return!!(t&e)}function G(t,e){return t===e}class Y{constructor(t,e){this.type=t,this.value=e}}class X{constructor(t,e,...i){this.type=t,this.operator=e,this.args=i}}function Z(){return{variables:new Set,properties:new Set,featureId:!1,style:{}}}function N(t,e,i){switch(typeof t){case"boolean":return new Y(b,t);case"number":return new Y(O,t);case"string":{let e=D;return(0,u.e1)(t)&&(e|=M),G(e&i,R)||(e&=i),new Y(e,t)}}if(!Array.isArray(t))throw new Error("Expression must be an array or a primitive value");if(0===t.length)throw new Error("Empty expression");if("string"==typeof t[0])return function(t,e,i){const n=t[0],r=q[n];if(!r)throw new Error(`Unknown operator: ${n}`);return r(t,e,i)}(t,e,i);for(const e of t)if("number"!=typeof e)throw new Error("Expected an array of numbers");let n=L;return 3!==t.length&&4!==t.length||(n|=M),i&&(n&=i),new Y(n,t)}const z={Get:"get",Var:"var",Concat:"concat",GeometryType:"geometry-type",Any:"any",All:"all",Not:"!",Resolution:"resolution",Zoom:"zoom",Time:"time",Equal:"==",NotEqual:"!=",GreaterThan:">",GreaterThanOrEqualTo:">=",LessThan:"<",LessThanOrEqualTo:"<=",Multiply:"*",Divide:"/",Add:"+",Subtract:"-",Clamp:"clamp",Mod:"%",Pow:"^",Abs:"abs",Floor:"floor",Ceil:"ceil",Round:"round",Sin:"sin",Cos:"cos",Atan:"atan",Sqrt:"sqrt",Match:"match",Between:"between",Interpolate:"interpolate",Case:"case",In:"in",Number:"number",String:"string",Array:"array",Color:"color",Id:"id",Band:"band",Palette:"palette"},q={[z.Get]:j((([t,e])=>void 0!==e?function(t){switch(t){case"string":return D;case"color":return M;case"number":return O;case"boolean":return b;case"number[]":return L;default:throw new Error(`Unrecognized type hint: ${t}`)}}(e.value):A),J(1,2),(function(t,e){const i=N(t[1],e);if(!(i instanceof Y))throw new Error("Expected a literal argument for get operation");if("string"!=typeof i.value)throw new Error("Expected a string argument for get operation");return e.properties.add(i.value),3===t.length?[i,N(t[2],e)]:[i]})),[z.Var]:j((([t])=>t.type),J(1,1),(function(t,e,i,n){const r=t[1];if("string"!=typeof r)throw new Error("Expected a string argument for var operation");if(e.variables.add(r),!("variables"in e.style)||void 0===e.style.variables[r])return[new Y(A,r)];const s=N(e.style.variables[r],e);if(s.value=r,n&&!B(n,s.type))throw new Error(`The variable ${r} has type ${W(s.type)} but the following type was expected: ${W(n)}`);return[s]})),[z.Id]:j(O|D,V,(function(t,e){e.featureId=!0})),[z.Concat]:j(D,J(2,1/0),$(A)),[z.GeometryType]:j(D,V),[z.Resolution]:j(O,V),[z.Zoom]:j(O,V),[z.Time]:j(O,V),[z.Any]:j(b,J(2,1/0),$(b)),[z.All]:j(b,J(2,1/0),$(b)),[z.Not]:j(b,J(1,1),$(b)),[z.Equal]:j(b,J(2,2),$(A),H),[z.NotEqual]:j(b,J(2,2),$(A),H),[z.GreaterThan]:j(b,J(2,2),$(A),H),[z.GreaterThanOrEqualTo]:j(b,J(2,2),$(A),H),[z.LessThan]:j(b,J(2,2),$(A),H),[z.LessThanOrEqualTo]:j(b,J(2,2),$(A),H),[z.Multiply]:j((t=>{let e=O|M;for(let i=0;i<t.length;i++)e&=t[i].type;return e}),J(2,1/0),$(O|M),H),[z.Divide]:j(O,J(2,2),$(O)),[z.Add]:j(O,J(2,1/0),$(O)),[z.Subtract]:j(O,J(2,2),$(O)),[z.Clamp]:j(O,J(3,3),$(O)),[z.Mod]:j(O,J(2,2),$(O)),[z.Pow]:j(O,J(2,2),$(O)),[z.Abs]:j(O,J(1,1),$(O)),[z.Floor]:j(O,J(1,1),$(O)),[z.Ceil]:j(O,J(1,1),$(O)),[z.Round]:j(O,J(1,1),$(O)),[z.Sin]:j(O,J(1,1),$(O)),[z.Cos]:j(O,J(1,1),$(O)),[z.Atan]:j(O,J(1,2),$(O)),[z.Sqrt]:j(O,J(1,1),$(O)),[z.Match]:j((t=>{let e=A;for(let i=2;i<t.length;i+=2)e&=t[i].type;return e&=t[t.length-1].type,e}),J(4,1/0),U,(function(t,e,i,n){const r=t.length-1;let s=N(t[1],e).type;const o=N(t[t.length-1],e);let a=void 0!==n?n&o.type:o.type;const l=new Array(r-2);for(let i=0;i<r-2;i+=2){const n=N(t[i+2],e),r=N(t[i+3],e);s&=n.type,a&=r.type,l[i]=n,l[i+1]=r}const h=D|O|b;if(!B(h,s))throw new Error(`Expected an input of type ${W(h)} for the interpolate operation, got ${W(s)} instead`);if(G(a,R))throw new Error("Could not find a common output type for the following match operation: "+JSON.stringify(t));for(let i=0;i<r-2;i+=2){const n=N(t[i+2],e,s),r=N(t[i+3],e,a);l[i]=n,l[i+1]=r}return[N(t[1],e,s),...l,N(t[t.length-1],e,a)]})),[z.Between]:j(b,J(3,3),$(O)),[z.Interpolate]:j((t=>{let e=M|O;for(let i=3;i<t.length;i+=2)e&=t[i].type;return e}),J(6,1/0),U,(function(t,e,i,n){const r=t[1];let s;switch(r[0]){case"linear":s=1;break;case"exponential":if(s=r[1],"number"!=typeof s)throw new Error(`Expected a number base for exponential interpolation, got ${JSON.stringify(s)} instead`);break;default:s=null}if(!s)throw new Error(`Invalid interpolation type: ${JSON.stringify(r)}`);s=N(s,e);let o=N(t[2],e);if(!B(O,o.type))throw new Error(`Expected an input of type number for the interpolate operation, got ${W(o.type)} instead`);o=N(t[2],e,O);const a=new Array(t.length-3);for(let i=0;i<a.length;i+=2){let n=N(t[i+3],e);if(!B(O,n.type))throw new Error(`Expected all stop input values in the interpolate operation to be of type number, got ${W(n.type)} at position ${i+2} instead`);let r=N(t[i+4],e);if(!B(O|M,r.type))throw new Error(`Expected all stop output values in the interpolate operation to be a number or color, got ${W(r.type)} at position ${i+3} instead`);n=N(t[i+3],e,O),r=N(t[i+4],e,O|M),a[i]=n,a[i+1]=r}return[s,o,...a]})),[z.Case]:j((t=>{let e=A;for(let i=1;i<t.length;i+=2)e&=t[i].type;return e&=t[t.length-1].type,e}),J(3,1/0),(function(t,e){const i=t[0],n=t.length-1;if(n%2==0)throw new Error(`An odd amount of arguments was expected for operation ${i}, got ${JSON.stringify(n)} instead`)}),(function(t,e,i,n){const r=N(t[t.length-1],e);let s=void 0!==n?n&r.type:r.type;const o=new Array(t.length-1);for(let i=0;i<o.length-1;i+=2){const n=N(t[i+1],e),r=N(t[i+2],e);if(!B(b,n.type))throw new Error(`Expected all conditions in the case operation to be of type boolean, got ${W(n.type)} at position ${i} instead`);s&=r.type,o[i]=n,o[i+1]=r}if(G(s,R))throw new Error("Could not find a common output type for the following case operation: "+JSON.stringify(t));for(let i=0;i<o.length-1;i+=2)o[i+1]=N(t[i+2],e,s);return o[o.length-1]=N(t[t.length-1],e,s),o})),[z.In]:j(b,J(2,2),(function(t,e){let i=t[2];if(!Array.isArray(i))throw new Error('The "in" operator was provided a literal value which was not an array as second argument.');if("string"==typeof i[0]){if("literal"!==i[0])throw new Error('For the "in" operator, a string array should be wrapped in a "literal" operator to disambiguate from expressions.');if(!Array.isArray(i[1]))throw new Error('The "in" operator was provided a literal value which was not an array as second argument.');i=i[1]}let n=D|O;const r=new Array(i.length);for(let t=0;t<r.length;t++){const s=N(i[t],e);n&=s.type,r[t]=s}if(G(n,R))throw new Error("Could not find a common type for the following in operation: "+JSON.stringify(t));return[N(t[1],e,n),...r]})),[z.Number]:j(O,J(1,1/0),$(A)),[z.String]:j(D,J(1,1/0),$(A)),[z.Array]:j((t=>3===t.length||4===t.length?L|M:L),J(1,1/0),$(O)),[z.Color]:j(M,J(3,4),$(O)),[z.Band]:j(O,J(1,3),$(O)),[z.Palette]:j(M,J(2,2),(function(t,e){const i=N(t[1],e,O);if(i.type!==O)throw new Error(`The first argument of palette must be an number, got ${W(i.type)} instead`);const n=t[2];if(!Array.isArray(n))throw new Error("The second argument of palette must be an array");const r=new Array(n.length);for(let t=0;t<r.length;t++){const i=N(n[t],e,M);if(!(i instanceof Y))throw new Error(`The palette color at index ${t} must be a literal value`);if(!B(i.type,M))throw new Error(`The palette color at index ${t} should be of type color, got ${W(i.type)} instead`);r[t]=i}return[i,...r]}))};function V(t,e){const i=t[0];if(1!==t.length)throw new Error(`Expected no arguments for ${i} operation`);return[]}function J(t,e){return function(i,n){const r=i[0],s=i.length-1;if(t===e){if(s!==t)throw new Error(`Expected ${t} argument${1===t?"":"s"} for ${r}, got ${s}`)}else if(s<t||s>e)throw new Error(`Expected ${e===1/0?`${t} or more`:`${t} to ${e}`} arguments for ${r}, got ${s}`)}}function $(t){return function(e,i){const n=e[0],r=e.length-1,s=new Array(r);for(let o=0;o<r;++o){const r=N(e[o+1],i);if(!B(t,r.type)){const e=W(t),i=W(r.type);throw new Error(`Unexpected type for argument ${o} of ${n} operation, got ${e} but expected ${i}`)}r.type&=t,s[o]=r}return s}}function H(t,e,i){const n=t[0],r=t.length-1;let s=A;for(let t=0;t<i.length;++t)s&=i[t].type;if(s===R)throw new Error(`No common type could be found for arguments of ${n} operation`);const o=new Array(r);for(let i=0;i<r;++i)o[i]=N(t[i+1],e,s);return o}function U(t,e){const i=t[0],n=t.length-1;if(n%2==1)throw new Error(`An even amount of arguments was expected for operation ${i}, got ${JSON.stringify(n)} instead`)}function j(t,...e){return function(i,n,r){const s=i[0];let o=[];for(let t=0;t<e.length;t++)o=e[t](i,n,o,r)||o;let a="function"==typeof t?t(o):t;if(void 0!==r){if(!B(a,r))throw new Error(`The following expression was expected to return ${W(r)}, but returns ${W(a)} instead: ${JSON.stringify(i)}`);a&=r}if(a===R)throw new Error(`No matching type was found for the following expression: ${JSON.stringify(i)}`);return new X(a,s,...o)}}function K(t,e,i){const n=N(t,i);if(!B(e,n.type)){const t=W(e),i=W(n.type);throw new Error(`Expected expression to be of type ${t}, got ${i}`)}return Q(n,i)}function Q(t,e){if(t instanceof Y){if(t.type===M&&"string"==typeof t.value){const e=(0,u.mL)(t.value);return function(){return e}}return function(){return t.value}}const i=t.operator;switch(i){case z.Number:case z.String:return function(t,e){const i=t.operator,n=t.args.length,r=new Array(n);for(let i=0;i<n;++i)r[i]=Q(t.args[i],e);switch(i){case z.Number:case z.String:return t=>{for(let e=0;e<n;++e){const n=r[e](t);if(typeof n===i)return n}throw new Error(`Expected one of the values to be a ${i}`)};default:throw new Error(`Unsupported assertion operator ${i}`)}}(t,e);case z.Get:case z.Var:return function(t,e){const i=t.args[0].value;switch(t.operator){case z.Get:return t=>t.properties[i];case z.Var:return t=>t.variables[i];default:throw new Error(`Unsupported accessor operator ${t.operator}`)}}(t);case z.Id:return t=>t.featureId;case z.Concat:{const i=t.args.map((t=>Q(t,e)));return t=>"".concat(...i.map((e=>e(t).toString())))}case z.Resolution:return t=>t.resolution;case z.Any:case z.All:case z.Not:return function(t,e){const i=t.operator,n=t.args.length,r=new Array(n);for(let i=0;i<n;++i)r[i]=Q(t.args[i],e);switch(i){case z.Any:return t=>{for(let e=0;e<n;++e)if(r[e](t))return!0;return!1};case z.All:return t=>{for(let e=0;e<n;++e)if(!r[e](t))return!1;return!0};case z.Not:return t=>!r[0](t);default:throw new Error(`Unsupported logical operator ${i}`)}}(t,e);case z.Equal:case z.NotEqual:case z.LessThan:case z.LessThanOrEqualTo:case z.GreaterThan:case z.GreaterThanOrEqualTo:return function(t,e){const i=t.operator,n=Q(t.args[0],e),r=Q(t.args[1],e);switch(i){case z.Equal:return t=>n(t)===r(t);case z.NotEqual:return t=>n(t)!==r(t);case z.LessThan:return t=>n(t)<r(t);case z.LessThanOrEqualTo:return t=>n(t)<=r(t);case z.GreaterThan:return t=>n(t)>r(t);case z.GreaterThanOrEqualTo:return t=>n(t)>=r(t);default:throw new Error(`Unsupported comparison operator ${i}`)}}(t,e);case z.Multiply:case z.Divide:case z.Add:case z.Subtract:case z.Clamp:case z.Mod:case z.Pow:case z.Abs:case z.Floor:case z.Ceil:case z.Round:case z.Sin:case z.Cos:case z.Atan:case z.Sqrt:return function(t,e){const i=t.operator,n=t.args.length,r=new Array(n);for(let i=0;i<n;++i)r[i]=Q(t.args[i],e);switch(i){case z.Multiply:return t=>{let e=1;for(let i=0;i<n;++i)e*=r[i](t);return e};case z.Divide:return t=>r[0](t)/r[1](t);case z.Add:return t=>{let e=0;for(let i=0;i<n;++i)e+=r[i](t);return e};case z.Subtract:return t=>r[0](t)-r[1](t);case z.Clamp:return t=>{const e=r[0](t),i=r[1](t);if(e<i)return i;const n=r[2](t);return e>n?n:e};case z.Mod:return t=>r[0](t)%r[1](t);case z.Pow:return t=>Math.pow(r[0](t),r[1](t));case z.Abs:return t=>Math.abs(r[0](t));case z.Floor:return t=>Math.floor(r[0](t));case z.Ceil:return t=>Math.ceil(r[0](t));case z.Round:return t=>Math.round(r[0](t));case z.Sin:return t=>Math.sin(r[0](t));case z.Cos:return t=>Math.cos(r[0](t));case z.Atan:return 2===n?t=>Math.atan2(r[0](t),r[1](t)):t=>Math.atan(r[0](t));case z.Sqrt:return t=>Math.sqrt(r[0](t));default:throw new Error(`Unsupported numeric operator ${i}`)}}(t,e);case z.Match:return function(t,e){const i=t.args.length,n=new Array(i);for(let r=0;r<i;++r)n[r]=Q(t.args[r],e);return t=>{const e=n[0](t);for(let r=1;r<i;r+=2)if(e===n[r](t))return n[r+1](t);return n[i-1](t)}}(t,e);case z.Interpolate:return function(t,e){const i=t.args.length,n=new Array(i);for(let r=0;r<i;++r)n[r]=Q(t.args[r],e);return t=>{const e=n[0](t),r=n[1](t);let s,o;for(let a=2;a<i;a+=2){const i=n[a](t);let l=n[a+1](t);const h=Array.isArray(l);if(h&&(l=(0,u.fG)(l)),i>=r)return 2===a?l:h?et(e,r,s,o,i,l):tt(e,r,s,o,i,l);s=i,o=l}return o}}(t,e);default:throw new Error(`Unsupported operator ${i}`)}}function tt(t,e,i,n,r,s){const o=r-i;if(0===o)return n;const a=e-i;return n+(1===t?a/o:(Math.pow(t,a)-1)/(Math.pow(t,o)-1))*(s-n)}function et(t,e,i,n,r,s){if(0==r-i)return n;const o=(0,u.WV)(n),a=(0,u.WV)(s);let l=a[2]-o[2];l>180?l-=360:l<-180&&(l+=360);const h=[tt(t,e,i,o[0],r,a[0]),tt(t,e,i,o[1],r,a[1]),o[2]+tt(t,e,i,0,r,l),tt(t,e,i,n[3],r,s[3])];return(0,u.Fv)((0,u.TF)(h))}var it=i(9374),nt=i(4307);function rt(t){return!0}function st(t){const e=Z(),i=t.length,n=new Array(i);for(let r=0;r<i;++r)n[r]=ot(t[r],e);const r={variables:{},properties:{},resolution:NaN,featureId:null},s=new Array(i);return function(t,o){if(r.properties=t.getPropertiesInternal(),r.resolution=o,e.featureId){const e=t.getId();r.featureId=void 0!==e?e:null}let a=0;for(let t=0;t<i;++t){const e=n[t](r);e&&(s[a]=e,a+=1)}return s.length=a,s}}function ot(t,e){const i=at(t,"",e),n=lt(t,"",e),r=function(t,e){const i="text-",n=ct(t,i+"value",e);if(!n)return null;const r=at(t,i,e),s=at(t,i+"background-",e),o=lt(t,i,e),a=lt(t,i+"background-",e),l=ct(t,i+"font",e),h=ht(t,i+"max-angle",e),c=ht(t,i+"offset-x",e),u=ht(t,i+"offset-y",e),g=ut(t,i+"overflow",e),d=ct(t,i+"placement",e),f=ht(t,i+"repeat",e),_=_t(t,i+"scale",e),p=ut(t,i+"rotate-with-view",e),m=ht(t,i+"rotation",e),x=ct(t,i+"align",e),y=ct(t,i+"justify",e),S=ct(t,i+"baseline",e),w=dt(t,i+"padding",e),v=new E.Z({});return function(t){if(v.setText(n(t)),r&&v.setFill(r(t)),s&&v.setBackgroundFill(s(t)),o&&v.setStroke(o(t)),a&&v.setBackgroundStroke(a(t)),l&&v.setFont(l(t)),h&&v.setMaxAngle(h(t)),c&&v.setOffsetX(c(t)),u&&v.setOffsetY(u(t)),g&&v.setOverflow(g(t)),d){const e=d(t);if("point"!==e&&"line"!==e)throw new Error("Expected point or line for text-placement");v.setPlacement(e)}if(f&&v.setRepeat(f(t)),_&&v.setScale(_(t)),p&&v.setRotateWithView(p(t)),m&&v.setRotation(m(t)),x){const e=x(t);if("left"!==e&&"center"!==e&&"right"!==e&&"end"!==e&&"start"!==e)throw new Error("Expected left, right, center, start, or end for text-align");v.setTextAlign(e)}if(y){const e=y(t);if("left"!==e&&"right"!==e&&"center"!==e)throw new Error("Expected left, right, or center for text-justify");v.setJustify(e)}if(S){const e=S(t);if("bottom"!==e&&"top"!==e&&"middle"!==e&&"alphabetic"!==e&&"hanging"!==e)throw new Error("Expected bottom, top, middle, alphabetic, or hanging for text-baseline");v.setTextBaseline(e)}return w&&v.setPadding(w(t)),v}}(t,e),a=function(t,e){return"icon-src"in t?function(t,e){const i="icon-",n=i+"src",r=vt(t[n],n),s=ft(t,i+"anchor",e),o=_t(t,i+"scale",e),a=ht(t,i+"opacity",e),l=ft(t,i+"displacement",e),h=ht(t,i+"rotation",e),c=ut(t,i+"rotate-with-view",e),u=xt(t,i+"anchor-origin"),g=yt(t,i+"anchor-x-units"),d=yt(t,i+"anchor-y-units"),f=function(t,e){const i=t[e];if(void 0!==i)return It(i,e)}(t,i+"color"),_=function(t,e){const i=t[e];if(void 0!==i){if("string"!=typeof i)throw new Error(`Expected a string for ${e}`);return i}}(t,i+"cross-origin"),p=function(t,e){const i=t[e];if(void 0!==i)return wt(i,e)}(t,i+"offset"),m=xt(t,i+"offset-origin"),x=pt(t,i+"width"),y=pt(t,i+"height"),S=mt(t,i+"size"),w=St(t,i+"declutter"),T=new v({src:r,anchorOrigin:u,anchorXUnits:g,anchorYUnits:d,color:f,crossOrigin:_,offset:p,offsetOrigin:m,height:y,width:x,size:S,declutterMode:w});return function(t){return a&&T.setOpacity(a(t)),l&&T.setDisplacement(l(t)),h&&T.setRotation(h(t)),c&&T.setRotateWithView(c(t)),o&&T.setScale(o(t)),s&&T.setAnchor(s(t)),T}}(t,e):"shape-points"in t?function(t,e){const i="shape-",n=i+"points",r=Tt(t[n],n),s=at(t,i,e),o=lt(t,i,e),a=_t(t,i+"scale",e),l=ft(t,i+"displacement",e),h=ht(t,i+"rotation",e),c=ut(t,i+"rotate-with-view",e),u=pt(t,i+"radius"),g=pt(t,i+"radius1"),d=pt(t,i+"radius2"),f=pt(t,i+"angle"),_=St(t,i+"declutter-mode"),p=new T.Z({points:r,radius:u,radius1:g,radius2:d,angle:f,declutterMode:_});return function(t){return s&&p.setFill(s(t)),o&&p.setStroke(o(t)),l&&p.setDisplacement(l(t)),h&&p.setRotation(h(t)),c&&p.setRotateWithView(c(t)),a&&p.setScale(a(t)),p}}(t,e):"circle-radius"in t?function(t,e){const i="circle-",n=at(t,i,e),r=lt(t,i,e),s=ht(t,i+"radius",e),a=_t(t,i+"scale",e),l=ft(t,i+"displacement",e),h=ht(t,i+"rotation",e),c=ut(t,i+"rotate-with-view",e),u=St(t,i+"declutter-mode"),g=new o.Z({radius:5,declutterMode:u});return function(t){return s&&g.setRadius(s(t)),n&&g.setFill(n(t)),r&&g.setStroke(r(t)),l&&g.setDisplacement(l(t)),h&&g.setRotation(h(t)),c&&g.setRotateWithView(c(t)),a&&g.setScale(a(t)),g}}(t,e):null}(t,e),l=ht(t,"z-index",e);if(!(i||n||r||a||(0,it.x)(t)))throw new Error("No fill, stroke, point, or text symbolizer properties in style: "+JSON.stringify(t));const h=new s.ZP;return function(t){let e=!0;if(i){const n=i(t);n&&(e=!1),h.setFill(n)}if(n){const i=n(t);i&&(e=!1),h.setStroke(i)}if(r){const i=r(t);i&&(e=!1),h.setText(i)}if(a){const i=a(t);i&&(e=!1),h.setImage(i)}return l&&h.setZIndex(l(t)),e?null:h}}function at(t,e,i){const n=gt(t,e+"fill-color",i);if(!n)return null;const r=new a.Z;return function(t){const e=n(t);return"none"===e?null:(r.setColor(e),r)}}function lt(t,e,i){const n=ht(t,e+"stroke-width",i),r=gt(t,e+"stroke-color",i);if(!n&&!r)return null;const s=ct(t,e+"stroke-line-cap",i),o=ct(t,e+"stroke-line-join",i),a=dt(t,e+"stroke-line-dash",i),l=ht(t,e+"stroke-line-dash-offset",i),h=ht(t,e+"stroke-miter-limit",i),c=new I.Z;return function(t){if(r){const e=r(t);if("none"===e)return null;c.setColor(e)}if(n&&c.setWidth(n(t)),s){const e=s(t);if("butt"!==e&&"round"!==e&&"square"!==e)throw new Error("Expected butt, round, or square line cap");c.setLineCap(e)}if(o){const e=o(t);if("bevel"!==e&&"round"!==e&&"miter"!==e)throw new Error("Expected bevel, round, or miter line join");c.setLineJoin(e)}return a&&c.setLineDash(a(t)),l&&c.setLineDashOffset(l(t)),h&&c.setMiterLimit(h(t)),c}}function ht(t,e,i){if(!(e in t))return;const n=K(t[e],O,i);return function(t){return Tt(n(t),e)}}function ct(t,e,i){if(!(e in t))return null;const n=K(t[e],D,i);return function(t){return vt(n(t),e)}}function ut(t,e,i){if(!(e in t))return null;const n=K(t[e],b,i);return function(t){const i=n(t);if("boolean"!=typeof i)throw new Error(`Expected a boolean for ${e}`);return i}}function gt(t,e,i){if(!(e in t))return null;const n=K(t[e],M|D,i);return function(t){return It(n(t),e)}}function dt(t,e,i){if(!(e in t))return null;const n=K(t[e],L,i);return function(t){return wt(n(t),e)}}function ft(t,e,i){if(!(e in t))return null;const n=K(t[e],L,i);return function(t){const i=wt(n(t),e);if(2!==i.length)throw new Error(`Expected two numbers for ${e}`);return i}}function _t(t,e,i){if(!(e in t))return null;const n=K(t[e],L|O,i);return function(t){return function(t,e){if("number"==typeof t)return t;const i=wt(t,e);if(2!==i.length)throw new Error(`Expected an array of two numbers for ${e}`);return i}(n(t),e)}}function pt(t,e){const i=t[e];if(void 0!==i){if("number"!=typeof i)throw new Error(`Expected a number for ${e}`);return i}}function mt(t,e){const i=t[e];if(void 0!==i){if("number"==typeof i)return(0,nt.Pq)(i);if(!Array.isArray(i))throw new Error(`Expected a number or size array for ${e}`);if(2!==i.length||"number"!=typeof i[0]||"number"!=typeof i[1])throw new Error(`Expected a number or size array for ${e}`);return i}}function xt(t,e){const i=t[e];if(void 0!==i){if("bottom-left"!==i&&"bottom-right"!==i&&"top-left"!==i&&"top-right"!==i)throw new Error(`Expected bottom-left, bottom-right, top-left, or top-right for ${e}`);return i}}function yt(t,e){const i=t[e];if(void 0!==i){if("pixels"!==i&&"fraction"!==i)throw new Error(`Expected pixels or fraction for ${e}`);return i}}function St(t,e){const i=t[e];if(void 0!==i){if("string"!=typeof i)throw new Error(`Expected a string for ${e}`);if("declutter"!==i&&"obstacle"!==i&&"none"!==i)throw new Error(`Expected declutter, obstacle, or none for ${e}`);return i}}function wt(t,e){if(!Array.isArray(t))throw new Error(`Expected an array for ${e}`);const i=t.length;for(let n=0;n<i;++n)if("number"!=typeof t[n])throw new Error(`Expected an array of numbers for ${e}`);return t}function vt(t,e){if("string"!=typeof t)throw new Error(`Expected a string for ${e}`);return t}function Tt(t,e){if("number"!=typeof t)throw new Error(`Expected a number for ${e}`);return t}function It(t,e){if("string"==typeof t)return t;const i=wt(t,e),n=i.length;if(n<3||n>4)throw new Error(`Expected a color with 3 or 4 values for ${e}`);return i}const Et="renderOrder";class kt extends n.Z{constructor(t){t=t||{};const e=Object.assign({},t);delete e.style,delete e.renderBuffer,delete e.updateWhileAnimating,delete e.updateWhileInteracting,super(e),this.declutter_=void 0!==t.declutter&&t.declutter,this.renderBuffer_=void 0!==t.renderBuffer?t.renderBuffer:100,this.style_=null,this.styleFunction_=void 0,this.setStyle(t.style),this.updateWhileAnimating_=void 0!==t.updateWhileAnimating&&t.updateWhileAnimating,this.updateWhileInteracting_=void 0!==t.updateWhileInteracting&&t.updateWhileInteracting}getDeclutter(){return this.declutter_}getFeatures(t){return super.getFeatures(t)}getRenderBuffer(){return this.renderBuffer_}getRenderOrder(){return this.get(Et)}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}getUpdateWhileAnimating(){return this.updateWhileAnimating_}getUpdateWhileInteracting(){return this.updateWhileInteracting_}renderDeclutter(t){t.declutterTree||(t.declutterTree=new r(9)),this.getRenderer().renderDeclutter(t)}setRenderOrder(t){this.set(Et,t)}setStyle(t){this.style_=function(t){if(void 0===t)return s.yF;if(!t)return null;if("function"==typeof t)return t;if(t instanceof s.ZP)return t;if(!Array.isArray(t))return st([t]);if(0===t.length)return[];const e=t.length,i=t[0];if(i instanceof s.ZP){const i=new Array(e);for(let n=0;n<e;++n){const e=t[n];if(!(e instanceof s.ZP))throw new Error("Expected a list of style instances");i[n]=e}return i}if("style"in i){const i=new Array(e);for(let n=0;n<e;++n){const e=t[n];if(!("style"in e))throw new Error("Expected a list of rules with a style property");i[n]=e}return function(t){const e=Z(),i=function(t,e){const i=t.length,n=new Array(i);for(let r=0;r<i;++r){const i=t[r],s="filter"in i?K(i.filter,b,e):rt;let o;if(Array.isArray(i.style)){const t=i.style.length;o=new Array(t);for(let n=0;n<t;++n)o[n]=ot(i.style[n],e)}else o=[ot(i.style,e)];n[r]={filter:s,styles:o}}return function(e){const r=[];let s=!1;for(let o=0;o<i;++o)if((0,n[o].filter)(e)&&(!t[o].else||!s)){s=!0;for(const t of n[o].styles){const i=t(e);i&&r.push(i)}}return r}}(t,e),n={variables:{},properties:{},resolution:NaN,featureId:null};return function(t,r){if(n.properties=t.getPropertiesInternal(),n.resolution=r,e.featureId){const e=t.getId();n.featureId=void 0!==e?e:null}return i(n)}}(i)}return st(t)}(t),this.styleFunction_=null===t?void 0:(0,s.J$)(this.style_),this.changed()}}const Ct=kt,Rt={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},bt=[Rt.FILL],Ot=[Rt.STROKE],Dt=[Rt.BEGIN_PATH],Mt=[Rt.CLOSE_PATH],Lt=Rt;var At=i(8716);const Ft=class{drawCustom(t,e,i,n){}drawGeometry(t){}setStyle(t){}drawCircle(t,e){}drawFeature(t,e){}drawGeometryCollection(t,e){}drawLineString(t,e){}drawMultiLineString(t,e){}drawMultiPoint(t,e){}drawMultiPolygon(t,e){}drawPoint(t,e){}drawPolygon(t,e){}drawText(t,e){}setFillStrokeStyle(t,e){}setImageStyle(t,e){}setTextStyle(t,e){}};var Pt=i(6620),Wt=i(8641),Bt=i(147),Gt=i(9241);const Yt=class extends Ft{constructor(t,e,i,n){super(),this.tolerance=t,this.maxExtent=e,this.pixelRatio=n,this.maxLineWidth=0,this.resolution=i,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_=null,this.bufferedMaxExtent_=null,this.instructions=[],this.coordinates=[],this.tmpCoordinate_=[],this.hitDetectionInstructions=[],this.state={}}applyPixelRatio(t){const e=this.pixelRatio;return 1==e?t:t.map((function(t){return t*e}))}appendFlatPointCoordinates(t,e){const i=this.getBufferedMaxExtent(),n=this.tmpCoordinate_,r=this.coordinates;let s=r.length;for(let o=0,a=t.length;o<a;o+=e)n[0]=t[o],n[1]=t[o+1],(0,Wt.b8)(i,n)&&(r[s++]=n[0],r[s++]=n[1]);return s}appendFlatLineCoordinates(t,e,i,n,r,s){const o=this.coordinates;let a=o.length;const l=this.getBufferedMaxExtent();s&&(e+=n);let h=t[e],c=t[e+1];const u=this.tmpCoordinate_;let g,d,f,_=!0;for(g=e+n;g<i;g+=n)u[0]=t[g],u[1]=t[g+1],f=(0,Wt.pX)(l,u),f!==d?(_&&(o[a++]=h,o[a++]=c,_=!1),o[a++]=u[0],o[a++]=u[1]):f===At.Z.INTERSECTING?(o[a++]=u[0],o[a++]=u[1],_=!1):_=!0,h=u[0],c=u[1],d=f;return(r&&_||g===e+n)&&(o[a++]=h,o[a++]=c),a}drawCustomCoordinates_(t,e,i,n,r){for(let s=0,o=i.length;s<o;++s){const o=i[s],a=this.appendFlatLineCoordinates(t,e,o,n,!1,!1);r.push(a),e=o}return e}drawCustom(t,e,i,n){this.beginGeometry(t,e);const r=t.getType(),s=t.getStride(),o=this.coordinates.length;let a,l,h,c,u;switch(r){case"MultiPolygon":a=t.getOrientedFlatCoordinates(),c=[];const e=t.getEndss();u=0;for(let t=0,i=e.length;t<i;++t){const i=[];u=this.drawCustomCoordinates_(a,u,e[t],s,i),c.push(i)}this.instructions.push([Lt.CUSTOM,o,c,t,i,Gt.ug]),this.hitDetectionInstructions.push([Lt.CUSTOM,o,c,t,n||i,Gt.ug]);break;case"Polygon":case"MultiLineString":h=[],a="Polygon"==r?t.getOrientedFlatCoordinates():t.getFlatCoordinates(),u=this.drawCustomCoordinates_(a,0,t.getEnds(),s,h),this.instructions.push([Lt.CUSTOM,o,h,t,i,Gt.o1]),this.hitDetectionInstructions.push([Lt.CUSTOM,o,h,t,n||i,Gt.o1]);break;case"LineString":case"Circle":a=t.getFlatCoordinates(),l=this.appendFlatLineCoordinates(a,0,a.length,s,!1,!1),this.instructions.push([Lt.CUSTOM,o,l,t,i,Gt.Ml]),this.hitDetectionInstructions.push([Lt.CUSTOM,o,l,t,n||i,Gt.Ml]);break;case"MultiPoint":a=t.getFlatCoordinates(),l=this.appendFlatPointCoordinates(a,s),l>o&&(this.instructions.push([Lt.CUSTOM,o,l,t,i,Gt.Ml]),this.hitDetectionInstructions.push([Lt.CUSTOM,o,l,t,n||i,Gt.Ml]));break;case"Point":a=t.getFlatCoordinates(),this.coordinates.push(a[0],a[1]),l=this.coordinates.length,this.instructions.push([Lt.CUSTOM,o,l,t,i]),this.hitDetectionInstructions.push([Lt.CUSTOM,o,l,t,n||i])}this.endGeometry(e)}beginGeometry(t,e){this.beginGeometryInstruction1_=[Lt.BEGIN_GEOMETRY,e,0,t],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[Lt.BEGIN_GEOMETRY,e,0,t],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)}finish(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}}reverseHitDetectionInstructions(){const t=this.hitDetectionInstructions;let e;t.reverse();const i=t.length;let n,r,s=-1;for(e=0;e<i;++e)n=t[e],r=n[0],r==Lt.END_GEOMETRY?s=e:r==Lt.BEGIN_GEOMETRY&&(n[2]=e,(0,k.FZ)(this.hitDetectionInstructions,s,e),s=-1)}setFillStrokeStyle(t,e){const i=this.state;if(t){const e=t.getColor();i.fillStyle=(0,Pt.y)(e||Bt.bL)}else i.fillStyle=void 0;if(e){const t=e.getColor();i.strokeStyle=(0,Pt.y)(t||Bt.Tx);const n=e.getLineCap();i.lineCap=void 0!==n?n:Bt.mb;const r=e.getLineDash();i.lineDash=r?r.slice():Bt.X9;const s=e.getLineDashOffset();i.lineDashOffset=s||Bt.He;const o=e.getLineJoin();i.lineJoin=void 0!==o?o:Bt.rc;const a=e.getWidth();i.lineWidth=void 0!==a?a:Bt.yC;const l=e.getMiterLimit();i.miterLimit=void 0!==l?l:Bt.V4,i.lineWidth>this.maxLineWidth&&(this.maxLineWidth=i.lineWidth,this.bufferedMaxExtent_=null)}else i.strokeStyle=void 0,i.lineCap=void 0,i.lineDash=null,i.lineDashOffset=void 0,i.lineJoin=void 0,i.lineWidth=void 0,i.miterLimit=void 0}createFill(t){const e=t.fillStyle,i=[Lt.SET_FILL_STYLE,e];return"string"!=typeof e&&i.push(!0),i}applyStroke(t){this.instructions.push(this.createStroke(t))}createStroke(t){return[Lt.SET_STROKE_STYLE,t.strokeStyle,t.lineWidth*this.pixelRatio,t.lineCap,t.lineJoin,t.miterLimit,this.applyPixelRatio(t.lineDash),t.lineDashOffset*this.pixelRatio]}updateFillStyle(t,e){const i=t.fillStyle;"string"==typeof i&&t.currentFillStyle==i||(void 0!==i&&this.instructions.push(e.call(this,t)),t.currentFillStyle=i)}updateStrokeStyle(t,e){const i=t.strokeStyle,n=t.lineCap,r=t.lineDash,s=t.lineDashOffset,o=t.lineJoin,a=t.lineWidth,l=t.miterLimit;(t.currentStrokeStyle!=i||t.currentLineCap!=n||r!=t.currentLineDash&&!(0,k.fS)(t.currentLineDash,r)||t.currentLineDashOffset!=s||t.currentLineJoin!=o||t.currentLineWidth!=a||t.currentMiterLimit!=l)&&(void 0!==i&&e.call(this,t),t.currentStrokeStyle=i,t.currentLineCap=n,t.currentLineDash=r,t.currentLineDashOffset=s,t.currentLineJoin=o,t.currentLineWidth=a,t.currentMiterLimit=l)}endGeometry(t){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;const e=[Lt.END_GEOMETRY,t];this.instructions.push(e),this.hitDetectionInstructions.push(e)}getBufferedMaxExtent(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=(0,Wt.d9)(this.maxExtent),this.maxLineWidth>0)){const t=this.resolution*(this.maxLineWidth+1)/2;(0,Wt.f3)(this.bufferedMaxExtent_,t,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_}};var Xt=i(226);const Zt=class extends Yt{constructor(t,e,i,n){super(t,e,i,n)}drawFlatCoordinatess_(t,e,i,n){const r=this.state,s=void 0!==r.fillStyle,o=void 0!==r.strokeStyle,a=i.length;this.instructions.push(Dt),this.hitDetectionInstructions.push(Dt);for(let r=0;r<a;++r){const s=i[r],a=this.coordinates.length,l=this.appendFlatLineCoordinates(t,e,s,n,!0,!o),h=[Lt.MOVE_TO_LINE_TO,a,l];this.instructions.push(h),this.hitDetectionInstructions.push(h),o&&(this.instructions.push(Mt),this.hitDetectionInstructions.push(Mt)),e=s}return s&&(this.instructions.push(bt),this.hitDetectionInstructions.push(bt)),o&&(this.instructions.push(Ot),this.hitDetectionInstructions.push(Ot)),e}drawCircle(t,e){const i=this.state,n=i.fillStyle,r=i.strokeStyle;if(void 0===n&&void 0===r)return;this.setFillStrokeStyles_(),this.beginGeometry(t,e),void 0!==i.fillStyle&&this.hitDetectionInstructions.push([Lt.SET_FILL_STYLE,Bt.bL]),void 0!==i.strokeStyle&&this.hitDetectionInstructions.push([Lt.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,Bt.X9,Bt.He]);const s=t.getFlatCoordinates(),o=t.getStride(),a=this.coordinates.length;this.appendFlatLineCoordinates(s,0,s.length,o,!1,!1);const l=[Lt.CIRCLE,a];this.instructions.push(Dt,l),this.hitDetectionInstructions.push(Dt,l),void 0!==i.fillStyle&&(this.instructions.push(bt),this.hitDetectionInstructions.push(bt)),void 0!==i.strokeStyle&&(this.instructions.push(Ot),this.hitDetectionInstructions.push(Ot)),this.endGeometry(e)}drawPolygon(t,e){const i=this.state,n=i.fillStyle,r=i.strokeStyle;if(void 0===n&&void 0===r)return;this.setFillStrokeStyles_(),this.beginGeometry(t,e),void 0!==i.fillStyle&&this.hitDetectionInstructions.push([Lt.SET_FILL_STYLE,Bt.bL]),void 0!==i.strokeStyle&&this.hitDetectionInstructions.push([Lt.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,Bt.X9,Bt.He]);const s=t.getEnds(),o=t.getOrientedFlatCoordinates(),a=t.getStride();this.drawFlatCoordinatess_(o,0,s,a),this.endGeometry(e)}drawMultiPolygon(t,e){const i=this.state,n=i.fillStyle,r=i.strokeStyle;if(void 0===n&&void 0===r)return;this.setFillStrokeStyles_(),this.beginGeometry(t,e),void 0!==i.fillStyle&&this.hitDetectionInstructions.push([Lt.SET_FILL_STYLE,Bt.bL]),void 0!==i.strokeStyle&&this.hitDetectionInstructions.push([Lt.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,Bt.X9,Bt.He]);const s=t.getEndss(),o=t.getOrientedFlatCoordinates(),a=t.getStride();let l=0;for(let t=0,e=s.length;t<e;++t)l=this.drawFlatCoordinatess_(o,l,s[t],a);this.endGeometry(e)}finish(){this.reverseHitDetectionInstructions(),this.state=null;const t=this.tolerance;if(0!==t){const e=this.coordinates;for(let i=0,n=e.length;i<n;++i)e[i]=(0,Xt.uZ)(e[i],t)}return super.finish()}setFillStrokeStyles_(){const t=this.state;void 0!==t.fillStyle&&this.updateFillStyle(t,this.createFill),void 0!==t.strokeStyle&&this.updateStrokeStyle(t,this.applyStroke)}};var Nt=i(3983);function zt(t,e,i,n,r){const s=[];let o=i,a=0,l=e.slice(i,2);for(;a<t&&o+r<n;){const[i,n]=l.slice(-2),h=e[o+r],c=e[o+r+1],u=Math.sqrt((h-i)*(h-i)+(c-n)*(c-n));if(a+=u,a>=t){const e=(t-a+u)/u,g=(0,Nt.t7)(i,h,e),d=(0,Nt.t7)(n,c,e);l.push(g,d),s.push(l),l=[g,d],a==t&&(o+=r),a=0}else if(a<t)l.push(e[o+r],e[o+r+1]),o+=r;else{const t=u-a,e=(0,Nt.t7)(i,h,t/u),g=(0,Nt.t7)(n,c,t/u);l.push(e,g),s.push(l),l=[e,g],a=0,o+=r}}return a>0&&s.push(l),s}function qt(t,e,i,n,r){let s,o,a,l,h,c,u,g,d,f,_=i,p=i,m=0,x=0,y=i;for(o=i;o<n;o+=r){const i=e[o],n=e[o+1];void 0!==h&&(d=i-h,f=n-c,l=Math.sqrt(d*d+f*f),void 0!==u&&(x+=a,s=Math.acos((u*d+g*f)/(a*l)),s>t&&(x>m&&(m=x,_=y,p=o),x=0,y=o-r)),a=l,u=d,g=f),h=i,c=n}return x+=l,x>m?[y,o]:[_,p]}const Vt={left:0,center:.5,right:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1},Jt={Circle:Zt,Default:Yt,Image:class extends Yt{constructor(t,e,i,n){super(t,e,i,n),this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.anchorX_=void 0,this.anchorY_=void 0,this.height_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.scale_=void 0,this.width_=void 0,this.declutterMode_=void 0,this.declutterImageWithText_=void 0}drawPoint(t,e){if(!this.image_)return;this.beginGeometry(t,e);const i=t.getFlatCoordinates(),n=t.getStride(),r=this.coordinates.length,s=this.appendFlatPointCoordinates(i,n);this.instructions.push([Lt.DRAW_IMAGE,r,s,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([Lt.DRAW_IMAGE,r,s,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(e)}drawMultiPoint(t,e){if(!this.image_)return;this.beginGeometry(t,e);const i=t.getFlatCoordinates(),n=t.getStride(),r=this.coordinates.length,s=this.appendFlatPointCoordinates(i,n);this.instructions.push([Lt.DRAW_IMAGE,r,s,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([Lt.DRAW_IMAGE,r,s,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(e)}finish(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,super.finish()}setImageStyle(t,e){const i=t.getAnchor(),n=t.getSize(),r=t.getOrigin();this.imagePixelRatio_=t.getPixelRatio(this.pixelRatio),this.anchorX_=i[0],this.anchorY_=i[1],this.hitDetectionImage_=t.getHitDetectionImage(),this.image_=t.getImage(this.pixelRatio),this.height_=n[1],this.opacity_=t.getOpacity(),this.originX_=r[0],this.originY_=r[1],this.rotateWithView_=t.getRotateWithView(),this.rotation_=t.getRotation(),this.scale_=t.getScaleArray(),this.width_=n[0],this.declutterMode_=t.getDeclutterMode(),this.declutterImageWithText_=e}},LineString:class extends Yt{constructor(t,e,i,n){super(t,e,i,n)}drawFlatCoordinates_(t,e,i,n){const r=this.coordinates.length,s=this.appendFlatLineCoordinates(t,e,i,n,!1,!1),o=[Lt.MOVE_TO_LINE_TO,r,s];return this.instructions.push(o),this.hitDetectionInstructions.push(o),i}drawLineString(t,e){const i=this.state,n=i.strokeStyle,r=i.lineWidth;if(void 0===n||void 0===r)return;this.updateStrokeStyle(i,this.applyStroke),this.beginGeometry(t,e),this.hitDetectionInstructions.push([Lt.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,Bt.X9,Bt.He],Dt);const s=t.getFlatCoordinates(),o=t.getStride();this.drawFlatCoordinates_(s,0,s.length,o),this.hitDetectionInstructions.push(Ot),this.endGeometry(e)}drawMultiLineString(t,e){const i=this.state,n=i.strokeStyle,r=i.lineWidth;if(void 0===n||void 0===r)return;this.updateStrokeStyle(i,this.applyStroke),this.beginGeometry(t,e),this.hitDetectionInstructions.push([Lt.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,Bt.X9,Bt.He],Dt);const s=t.getEnds(),o=t.getFlatCoordinates(),a=t.getStride();let l=0;for(let t=0,e=s.length;t<e;++t)l=this.drawFlatCoordinates_(o,l,s[t],a);this.hitDetectionInstructions.push(Ot),this.endGeometry(e)}finish(){const t=this.state;return null!=t.lastStroke&&t.lastStroke!=this.coordinates.length&&this.instructions.push(Ot),this.reverseHitDetectionInstructions(),this.state=null,super.finish()}applyStroke(t){null!=t.lastStroke&&t.lastStroke!=this.coordinates.length&&(this.instructions.push(Ot),t.lastStroke=this.coordinates.length),t.lastStroke=0,super.applyStroke(t),this.instructions.push(Dt)}},Polygon:Zt,Text:class extends Yt{constructor(t,e,i,n){super(t,e,i,n),this.labels_=null,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=void 0,this.textRotation_=0,this.textFillState_=null,this.fillStates={},this.fillStates[Bt.bL]={fillStyle:Bt.bL},this.textStrokeState_=null,this.strokeStates={},this.textState_={},this.textStates={},this.textKey_="",this.fillKey_="",this.strokeKey_="",this.declutterImageWithText_=void 0}finish(){const t=super.finish();return t.textStates=this.textStates,t.fillStates=this.fillStates,t.strokeStates=this.strokeStates,t}drawText(t,e){const i=this.textFillState_,n=this.textStrokeState_,r=this.textState_;if(""===this.text_||!r||!i&&!n)return;const s=this.coordinates;let o=s.length;const a=t.getType();let l=null,h=t.getStride();if("line"!==r.placement||"LineString"!=a&&"MultiLineString"!=a&&"Polygon"!=a&&"MultiPolygon"!=a){let i=r.overflow?null:[];switch(a){case"Point":case"MultiPoint":l=t.getFlatCoordinates();break;case"LineString":l=t.getFlatMidpoint();break;case"Circle":l=t.getCenter();break;case"MultiLineString":l=t.getFlatMidpoints(),h=2;break;case"Polygon":l=t.getFlatInteriorPoint(),r.overflow||i.push(l[2]/this.resolution),h=3;break;case"MultiPolygon":const e=t.getFlatInteriorPoints();l=[];for(let t=0,n=e.length;t<n;t+=3)r.overflow||i.push(e[t+2]/this.resolution),l.push(e[t],e[t+1]);if(0===l.length)return;h=2}const n=this.appendFlatPointCoordinates(l,h);if(n===o)return;if(i&&(n-o)/2!=l.length/h){let t=o/2;i=i.filter(((e,i)=>{const n=s[2*(t+i)]===l[i*h]&&s[2*(t+i)+1]===l[i*h+1];return n||--t,n}))}this.saveTextStates_(),(r.backgroundFill||r.backgroundStroke)&&(this.setFillStrokeStyle(r.backgroundFill,r.backgroundStroke),r.backgroundFill&&this.updateFillStyle(this.state,this.createFill),r.backgroundStroke&&(this.updateStrokeStyle(this.state,this.applyStroke),this.hitDetectionInstructions.push(this.createStroke(this.state)))),this.beginGeometry(t,e);let c=r.padding;if(c!=Bt.oB&&(r.scale[0]<0||r.scale[1]<0)){let t=r.padding[0],e=r.padding[1],i=r.padding[2],n=r.padding[3];r.scale[0]<0&&(e=-e,n=-n),r.scale[1]<0&&(t=-t,i=-i),c=[t,e,i,n]}const u=this.pixelRatio;this.instructions.push([Lt.DRAW_IMAGE,o,n,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,void 0,this.declutterImageWithText_,c==Bt.oB?Bt.oB:c.map((function(t){return t*u})),!!r.backgroundFill,!!r.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,i]);const g=1/u,d=this.state.fillStyle;r.backgroundFill&&(this.state.fillStyle=Bt.bL,this.hitDetectionInstructions.push(this.createFill(this.state))),this.hitDetectionInstructions.push([Lt.DRAW_IMAGE,o,n,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[g,g],NaN,void 0,this.declutterImageWithText_,c,!!r.backgroundFill,!!r.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_?Bt.bL:this.fillKey_,this.textOffsetX_,this.textOffsetY_,i]),r.backgroundFill&&(this.state.fillStyle=d,this.hitDetectionInstructions.push(this.createFill(this.state))),this.endGeometry(e)}else{if(!(0,Wt.kK)(this.getBufferedMaxExtent(),t.getExtent()))return;let i;if(l=t.getFlatCoordinates(),"LineString"==a)i=[l.length];else if("MultiLineString"==a)i=t.getEnds();else if("Polygon"==a)i=t.getEnds().slice(0,1);else if("MultiPolygon"==a){const e=t.getEndss();i=[];for(let t=0,n=e.length;t<n;++t)i.push(e[t][0])}this.beginGeometry(t,e);const n=r.repeat,c=n?void 0:r.textAlign;let u=0;for(let t=0,e=i.length;t<e;++t){let e;e=n?zt(n*this.resolution,l,u,i[t],h):[l.slice(u,i[t])];for(let n=0,a=e.length;n<a;++n){const a=e[n];let l=0,g=a.length;if(null==c){const t=qt(r.maxAngle,a,0,a.length,2);l=t[0],g=t[1]}for(let t=l;t<g;t+=h)s.push(a[t],a[t+1]);const d=s.length;u=i[t],this.drawChars_(o,d),o=d}}this.endGeometry(e)}}saveTextStates_(){const t=this.textStrokeState_,e=this.textState_,i=this.textFillState_,n=this.strokeKey_;t&&(n in this.strokeStates||(this.strokeStates[n]={strokeStyle:t.strokeStyle,lineCap:t.lineCap,lineDashOffset:t.lineDashOffset,lineWidth:t.lineWidth,lineJoin:t.lineJoin,miterLimit:t.miterLimit,lineDash:t.lineDash}));const r=this.textKey_;r in this.textStates||(this.textStates[r]={font:e.font,textAlign:e.textAlign||Bt.PH,justify:e.justify,textBaseline:e.textBaseline||Bt.ru,scale:e.scale});const s=this.fillKey_;i&&(s in this.fillStates||(this.fillStates[s]={fillStyle:i.fillStyle}))}drawChars_(t,e){const i=this.textStrokeState_,n=this.textState_,r=this.strokeKey_,s=this.textKey_,o=this.fillKey_;this.saveTextStates_();const a=this.pixelRatio,l=Vt[n.textBaseline],h=this.textOffsetY_*a,c=this.text_,u=i?i.lineWidth*Math.abs(n.scale[0])/2:0;this.instructions.push([Lt.DRAW_CHARS,t,e,l,n.overflow,o,n.maxAngle,a,h,r,u*a,c,s,1]),this.hitDetectionInstructions.push([Lt.DRAW_CHARS,t,e,l,n.overflow,o?Bt.bL:o,n.maxAngle,a,h,r,u*a,c,s,1/a])}setTextStyle(t,e){let i,n,r;if(t){const e=t.getFill();e?(n=this.textFillState_,n||(n={},this.textFillState_=n),n.fillStyle=(0,Pt.y)(e.getColor()||Bt.bL)):(n=null,this.textFillState_=n);const s=t.getStroke();if(s){r=this.textStrokeState_,r||(r={},this.textStrokeState_=r);const t=s.getLineDash(),e=s.getLineDashOffset(),i=s.getWidth(),n=s.getMiterLimit();r.lineCap=s.getLineCap()||Bt.mb,r.lineDash=t?t.slice():Bt.X9,r.lineDashOffset=void 0===e?Bt.He:e,r.lineJoin=s.getLineJoin()||Bt.rc,r.lineWidth=void 0===i?Bt.yC:i,r.miterLimit=void 0===n?Bt.V4:n,r.strokeStyle=(0,Pt.y)(s.getColor()||Bt.Tx)}else r=null,this.textStrokeState_=r;i=this.textState_;const o=t.getFont()||Bt.Df;(0,Bt.Qx)(o);const a=t.getScaleArray();i.overflow=t.getOverflow(),i.font=o,i.maxAngle=t.getMaxAngle(),i.placement=t.getPlacement(),i.textAlign=t.getTextAlign(),i.repeat=t.getRepeat(),i.justify=t.getJustify(),i.textBaseline=t.getTextBaseline()||Bt.ru,i.backgroundFill=t.getBackgroundFill(),i.backgroundStroke=t.getBackgroundStroke(),i.padding=t.getPadding()||Bt.oB,i.scale=void 0===a?[1,1]:a;const l=t.getOffsetX(),h=t.getOffsetY(),c=t.getRotateWithView(),u=t.getRotation();this.text_=t.getText()||"",this.textOffsetX_=void 0===l?0:l,this.textOffsetY_=void 0===h?0:h,this.textRotateWithView_=void 0!==c&&c,this.textRotation_=void 0===u?0:u,this.strokeKey_=r?("string"==typeof r.strokeStyle?r.strokeStyle:(0,y.sq)(r.strokeStyle))+r.lineCap+r.lineDashOffset+"|"+r.lineWidth+r.lineJoin+r.miterLimit+"["+r.lineDash.join()+"]":"",this.textKey_=i.font+i.scale+(i.textAlign||"?")+(i.repeat||"?")+(i.justify||"?")+(i.textBaseline||"?"),this.fillKey_=n?"string"==typeof n.fillStyle?n.fillStyle:"|"+(0,y.sq)(n.fillStyle):""}else this.text_="";this.declutterImageWithText_=e}}},$t=class{constructor(t,e,i,n){this.tolerance_=t,this.maxExtent_=e,this.pixelRatio_=n,this.resolution_=i,this.buildersByZIndex_={}}finish(){const t={};for(const e in this.buildersByZIndex_){t[e]=t[e]||{};const i=this.buildersByZIndex_[e];for(const n in i){const r=i[n].finish();t[e][n]=r}}return t}getBuilder(t,e){const i=void 0!==t?t.toString():"0";let n=this.buildersByZIndex_[i];void 0===n&&(n={},this.buildersByZIndex_[i]=n);let r=n[e];return void 0===r&&(r=new(0,Jt[e])(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),n[e]=r),r}};var Ht=i(6101),Ut=i(6442);function jt(t,e,i,n,r,s,o,a,l,h,c,u){let g=t[e],d=t[e+1],f=0,_=0,p=0,m=0;function x(){f=g,_=d,g=t[e+=n],d=t[e+1],m+=p,p=Math.sqrt((g-f)*(g-f)+(d-_)*(d-_))}do{x()}while(e<i-n&&m+p<s);let y=0===p?0:(s-m)/p;const S=(0,Nt.t7)(f,g,y),w=(0,Nt.t7)(_,d,y),v=e-n,T=m,I=s+a*l(h,r,c);for(;e<i-n&&m+p<I;)x();y=0===p?0:(I-m)/p;const E=(0,Nt.t7)(f,g,y),k=(0,Nt.t7)(_,d,y);let C;if(u){const t=[S,w,E,k];(0,Ut.U1)(t,0,4,2,u,t,t),C=t[0]>t[2]}else C=S>E;const R=Math.PI,b=[],O=v+n===e;let D;if(p=0,m=T,g=t[e=v],d=t[e+1],O){x(),D=Math.atan2(d-_,g-f),C&&(D+=D>0?-R:R);const t=(E+S)/2,e=(k+w)/2;return b[0]=[t,e,(I-s)/2,D,r],b}for(let t=0,u=(r=r.replace(/\n/g," ")).length;t<u;){x();let S=Math.atan2(d-_,g-f);if(C&&(S+=S>0?-R:R),void 0!==D){let t=S-D;if(t+=t>R?-2*R:t<-R?2*R:0,Math.abs(t)>o)return null}D=S;const w=t;let v=0;for(;t<u;++t){const o=a*l(h,r[C?u-t-1:t],c);if(e+n<i&&m+p<s+v+o/2)break;v+=o}if(t===w)continue;const T=C?r.substring(u-w,u-t):r.substring(w,t);y=0===p?0:(s+v/2-m)/p;const I=(0,Nt.t7)(f,g,y),E=(0,Nt.t7)(_,d,y);b.push([I,E,v/2,S,T]),s+=v}return b}var Kt=i(7374);const Qt=(0,Wt.lJ)(),te=[],ee=[],ie=[],ne=[];function re(t){return t[3].declutterBox}const se=new RegExp("["+String.fromCharCode(1425)+"-"+String.fromCharCode(2303)+String.fromCharCode(64285)+"-"+String.fromCharCode(65023)+String.fromCharCode(65136)+"-"+String.fromCharCode(65276)+String.fromCharCode(67584)+"-"+String.fromCharCode(69631)+String.fromCharCode(124928)+"-"+String.fromCharCode(126975)+"]");function oe(t,e){return"start"===e?e=se.test(t)?"right":"left":"end"===e&&(e=se.test(t)?"left":"right"),Vt[e]}function ae(t,e,i){return i>0&&t.push("\n",""),t.push(e,""),t}const le=class{constructor(t,e,i,n){this.overlaps=i,this.pixelRatio=e,this.resolution=t,this.alignFill_,this.instructions=n.instructions,this.coordinates=n.coordinates,this.coordinateCache_={},this.renderedTransform_=(0,Ht.Ue)(),this.hitDetectionInstructions=n.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=n.fillStates||{},this.strokeStates=n.strokeStates||{},this.textStates=n.textStates||{},this.widths_={},this.labels_={}}createLabel(t,e,i,n){const r=t+e+i+n;if(this.labels_[r])return this.labels_[r];const s=n?this.strokeStates[n]:null,o=i?this.fillStates[i]:null,a=this.textStates[e],l=this.pixelRatio,h=[a.scale[0]*l,a.scale[1]*l],c=Array.isArray(t),u=a.justify?Vt[a.justify]:oe(Array.isArray(t)?t[0]:t,a.textAlign||Bt.PH),g=n&&s.lineWidth?s.lineWidth:0,d=c?t:t.split("\n").reduce(ae,[]),{width:f,height:_,widths:p,heights:m,lineWidths:x}=(0,Bt.Zw)(a,d),y=f+g,S=[],w=(y+2)*h[0],v=(_+g)*h[1],T={width:w<0?Math.floor(w):Math.ceil(w),height:v<0?Math.floor(v):Math.ceil(v),contextInstructions:S};1==h[0]&&1==h[1]||S.push("scale",h),n&&(S.push("strokeStyle",s.strokeStyle),S.push("lineWidth",g),S.push("lineCap",s.lineCap),S.push("lineJoin",s.lineJoin),S.push("miterLimit",s.miterLimit),S.push("setLineDash",[s.lineDash]),S.push("lineDashOffset",s.lineDashOffset)),i&&S.push("fillStyle",o.fillStyle),S.push("textBaseline","middle"),S.push("textAlign","center");const I=.5-u;let E=u*y+I*g;const k=[],C=[];let R,b=0,O=0,D=0,M=0;for(let t=0,e=d.length;t<e;t+=2){const e=d[t];if("\n"===e){O+=b,b=0,E=u*y+I*g,++M;continue}const r=d[t+1]||a.font;r!==R&&(n&&k.push("font",r),i&&C.push("font",r),R=r),b=Math.max(b,m[D]);const s=[e,E+I*p[D]+u*(p[D]-x[M]),.5*(g+b)+O];E+=p[D],n&&k.push("strokeText",s),i&&C.push("fillText",s),++D}return Array.prototype.push.apply(S,k),Array.prototype.push.apply(S,C),this.labels_[r]=T,T}replayTextBackground_(t,e,i,n,r,s,o){t.beginPath(),t.moveTo.apply(t,e),t.lineTo.apply(t,i),t.lineTo.apply(t,n),t.lineTo.apply(t,r),t.lineTo.apply(t,e),s&&(this.alignFill_=s[2],this.fill_(t)),o&&(this.setStrokeStyle_(t,o),t.stroke())}calculateImageOrLabelDimensions_(t,e,i,n,r,s,o,a,l,h,c,u,g,d,f,_){let p=i-(o*=u[0]),m=n-(a*=u[1]);const x=r+l>t?t-l:r,y=s+h>e?e-h:s,S=d[3]+x*u[0]+d[1],w=d[0]+y*u[1]+d[2],v=p-d[3],T=m-d[0];let I;return(f||0!==c)&&(te[0]=v,ne[0]=v,te[1]=T,ee[1]=T,ee[0]=v+S,ie[0]=ee[0],ie[1]=T+w,ne[1]=ie[1]),0!==c?(I=(0,Ht.qC)((0,Ht.Ue)(),i,n,1,1,c,-i,-n),(0,Ht.nn)(I,te),(0,Ht.nn)(I,ee),(0,Ht.nn)(I,ie),(0,Ht.nn)(I,ne),(0,Wt.T9)(Math.min(te[0],ee[0],ie[0],ne[0]),Math.min(te[1],ee[1],ie[1],ne[1]),Math.max(te[0],ee[0],ie[0],ne[0]),Math.max(te[1],ee[1],ie[1],ne[1]),Qt)):(0,Wt.T9)(Math.min(v,v+S),Math.min(T,T+w),Math.max(v,v+S),Math.max(T,T+w),Qt),g&&(p=Math.round(p),m=Math.round(m)),{drawImageX:p,drawImageY:m,drawImageW:x,drawImageH:y,originX:l,originY:h,declutterBox:{minX:Qt[0],minY:Qt[1],maxX:Qt[2],maxY:Qt[3],value:_},canvasTransform:I,scale:u}}replayImageOrLabel_(t,e,i,n,r,s,o){const a=!(!s&&!o),l=n.declutterBox,h=t.canvas,c=o?o[2]*n.scale[0]/2:0;return l.minX-c<=h.width/e&&l.maxX+c>=0&&l.minY-c<=h.height/e&&l.maxY+c>=0&&(a&&this.replayTextBackground_(t,te,ee,ie,ne,s,o),(0,Bt._f)(t,n.canvasTransform,r,i,n.originX,n.originY,n.drawImageW,n.drawImageH,n.drawImageX,n.drawImageY,n.scale)),!0}fill_(t){if(this.alignFill_){const e=(0,Ht.nn)(this.renderedTransform_,[0,0]),i=512*this.pixelRatio;t.save(),t.translate(e[0]%i,e[1]%i),t.rotate(this.viewRotation_)}t.fill(),this.alignFill_&&t.restore()}setStrokeStyle_(t,e){t.strokeStyle=e[1],t.lineWidth=e[2],t.lineCap=e[3],t.lineJoin=e[4],t.miterLimit=e[5],t.lineDashOffset=e[7],t.setLineDash(e[6])}drawLabelWithPointPlacement_(t,e,i,n){const r=this.textStates[e],s=this.createLabel(t,e,n,i),o=this.strokeStates[i],a=this.pixelRatio,l=oe(Array.isArray(t)?t[0]:t,r.textAlign||Bt.PH),h=Vt[r.textBaseline||Bt.ru],c=o&&o.lineWidth?o.lineWidth:0;return{label:s,anchorX:l*(s.width/a-2*r.scale[0])+2*(.5-l)*c,anchorY:h*s.height/a+2*(.5-h)*c}}execute_(t,e,i,n,r,s,o,a){let l;this.pixelCoordinates_&&(0,k.fS)(i,this.renderedTransform_)?l=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),l=(0,Ut.vT)(this.coordinates,0,this.coordinates.length,2,i,this.pixelCoordinates_),(0,Ht.lk)(this.renderedTransform_,i));let h=0;const c=n.length;let u,g,d,f,_,p,m,x,y,S,w,v,T=0,I=0,E=0,C=null,R=null;const b=this.coordinateCache_,O=this.viewRotation_,D=Math.round(1e12*Math.atan2(-i[1],i[0]))/1e12,M={context:t,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:O},L=this.instructions!=n||this.overlaps?0:200;let A,F,P,W;for(;h<c;){const i=n[h];switch(i[0]){case Lt.BEGIN_GEOMETRY:A=i[1],W=i[3],A.getGeometry()?void 0===o||(0,Wt.kK)(o,W.getExtent())?++h:h=i[2]+1:h=i[2];break;case Lt.BEGIN_PATH:I>L&&(this.fill_(t),I=0),E>L&&(t.stroke(),E=0),I||E||(t.beginPath(),f=NaN,_=NaN),++h;break;case Lt.CIRCLE:T=i[1];const n=l[T],c=l[T+1],k=l[T+2]-n,B=l[T+3]-c,G=Math.sqrt(k*k+B*B);t.moveTo(n+G,c),t.arc(n,c,G,0,2*Math.PI,!0),++h;break;case Lt.CLOSE_PATH:t.closePath(),++h;break;case Lt.CUSTOM:T=i[1],u=i[2];const Y=i[3],X=i[4],Z=6==i.length?i[5]:void 0;M.geometry=Y,M.feature=A,h in b||(b[h]=[]);const N=b[h];Z?Z(l,T,u,2,N):(N[0]=l[T],N[1]=l[T+1],N.length=2),X(N,M),++h;break;case Lt.DRAW_IMAGE:T=i[1],u=i[2],x=i[3],g=i[4],d=i[5];let z=i[6];const q=i[7],V=i[8],J=i[9],$=i[10];let H=i[11];const U=i[12];let j=i[13];const K=i[14],Q=i[15];if(!x&&i.length>=20){y=i[19],S=i[20],w=i[21],v=i[22];const t=this.drawLabelWithPointPlacement_(y,S,w,v);x=t.label,i[3]=x;const e=i[23];g=(t.anchorX-e)*this.pixelRatio,i[4]=g;const n=i[24];d=(t.anchorY-n)*this.pixelRatio,i[5]=d,z=x.height,i[6]=z,j=x.width,i[13]=j}let tt,et,it,nt;i.length>25&&(tt=i[25]),i.length>17?(et=i[16],it=i[17],nt=i[18]):(et=Bt.oB,it=!1,nt=!1),$&&D?H+=O:$||D||(H-=O);let rt=0;for(;T<u;T+=2){if(tt&&tt[rt++]<j/this.pixelRatio)continue;const i=this.calculateImageOrLabelDimensions_(x.width,x.height,l[T],l[T+1],j,z,g,d,V,J,H,U,r,et,it||nt,A),n=[t,e,x,i,q,it?C:null,nt?R:null];if(a){if("none"===K)continue;if("obstacle"===K){a.insert(i.declutterBox);continue}{let t,e;if(Q){const i=u-T;if(!Q[i]){Q[i]=n;continue}if(t=Q[i],delete Q[i],e=re(t),a.collides(e))continue}if(a.collides(i.declutterBox))continue;t&&(a.insert(e),this.replayImageOrLabel_.apply(this,t)),a.insert(i.declutterBox)}}this.replayImageOrLabel_.apply(this,n)}++h;break;case Lt.DRAW_CHARS:const st=i[1],ot=i[2],at=i[3],lt=i[4];v=i[5];const ht=i[6],ct=i[7],ut=i[8];w=i[9];const gt=i[10];y=i[11],S=i[12];const dt=[i[13],i[13]],ft=this.textStates[S],_t=ft.font,pt=[ft.scale[0]*ct,ft.scale[1]*ct];let mt;_t in this.widths_?mt=this.widths_[_t]:(mt={},this.widths_[_t]=mt);const xt=(0,Kt.W)(l,st,ot,2),yt=Math.abs(pt[0])*(0,Bt.Kd)(_t,y,mt);if(lt||yt<=xt){const i=jt(l,st,ot,2,y,(xt-yt)*oe(y,this.textStates[S].textAlign),ht,Math.abs(pt[0]),Bt.Kd,_t,mt,D?0:this.viewRotation_);t:if(i){const n=[];let r,s,o,l,h;if(w)for(r=0,s=i.length;r<s;++r){h=i[r],o=h[4],l=this.createLabel(o,S,"",w),g=h[2]+(pt[0]<0?-gt:gt),d=at*l.height+2*(.5-at)*gt*pt[1]/pt[0]-ut;const s=this.calculateImageOrLabelDimensions_(l.width,l.height,h[0],h[1],l.width,l.height,g,d,0,0,h[3],dt,!1,Bt.oB,!1,A);if(a&&a.collides(s.declutterBox))break t;n.push([t,e,l,s,1,null,null])}if(v)for(r=0,s=i.length;r<s;++r){h=i[r],o=h[4],l=this.createLabel(o,S,v,""),g=h[2],d=at*l.height-ut;const s=this.calculateImageOrLabelDimensions_(l.width,l.height,h[0],h[1],l.width,l.height,g,d,0,0,h[3],dt,!1,Bt.oB,!1,A);if(a&&a.collides(s.declutterBox))break t;n.push([t,e,l,s,1,null,null])}a&&a.load(n.map(re));for(let t=0,e=n.length;t<e;++t)this.replayImageOrLabel_.apply(this,n[t])}}++h;break;case Lt.END_GEOMETRY:if(void 0!==s){A=i[1];const t=s(A,W);if(t)return t}++h;break;case Lt.FILL:L?I++:this.fill_(t),++h;break;case Lt.MOVE_TO_LINE_TO:for(T=i[1],u=i[2],F=l[T],P=l[T+1],p=F+.5|0,m=P+.5|0,p===f&&m===_||(t.moveTo(F,P),f=p,_=m),T+=2;T<u;T+=2)F=l[T],P=l[T+1],p=F+.5|0,m=P+.5|0,T!=u-2&&p===f&&m===_||(t.lineTo(F,P),f=p,_=m);++h;break;case Lt.SET_FILL_STYLE:C=i,this.alignFill_=i[2],I&&(this.fill_(t),I=0,E&&(t.stroke(),E=0)),t.fillStyle=i[1],++h;break;case Lt.SET_STROKE_STYLE:R=i,E&&(t.stroke(),E=0),this.setStrokeStyle_(t,i),++h;break;case Lt.STROKE:L?E++:t.stroke(),++h;break;default:++h}}I&&this.fill_(t),E&&t.stroke()}execute(t,e,i,n,r,s){this.viewRotation_=n,this.execute_(t,e,i,this.instructions,r,void 0,void 0,s)}executeHitDetection(t,e,i,n,r){return this.viewRotation_=i,this.execute_(t,1,e,this.hitDetectionInstructions,!0,n,r)}},he=["Polygon","Circle","LineString","Image","Text","Default"],ce={},ue=class{constructor(t,e,i,n,r,s){this.maxExtent_=t,this.overlaps_=n,this.pixelRatio_=i,this.resolution_=e,this.renderBuffer_=s,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=(0,Ht.Ue)(),this.createExecutors_(r)}clip(t,e){const i=this.getClipCoords(e);t.beginPath(),t.moveTo(i[0],i[1]),t.lineTo(i[2],i[3]),t.lineTo(i[4],i[5]),t.lineTo(i[6],i[7]),t.clip()}createExecutors_(t){for(const e in t){let i=this.executorsByZIndex_[e];void 0===i&&(i={},this.executorsByZIndex_[e]=i);const n=t[e];for(const t in n){const e=n[t];i[t]=new le(this.resolution_,this.pixelRatio_,this.overlaps_,e)}}}hasExecutors(t){for(const e in this.executorsByZIndex_){const i=this.executorsByZIndex_[e];for(let e=0,n=t.length;e<n;++e)if(t[e]in i)return!0}return!1}forEachFeatureAtCoordinate(t,e,i,n,r,s){const o=2*(n=Math.round(n))+1,a=(0,Ht.qC)(this.hitDetectionTransform_,n+.5,n+.5,1/e,-1/e,-i,-t[0],-t[1]),l=!this.hitDetectionContext_;l&&(this.hitDetectionContext_=(0,f.E4)(o,o,void 0,{willReadFrequently:!0}));const h=this.hitDetectionContext_;let c;h.canvas.width!==o||h.canvas.height!==o?(h.canvas.width=o,h.canvas.height=o):l||h.clearRect(0,0,o,o),void 0!==this.renderBuffer_&&(c=(0,Wt.lJ)(),(0,Wt.Wj)(c,t),(0,Wt.f3)(c,e*(this.renderBuffer_+n),c));const u=function(t){if(void 0!==ce[t])return ce[t];const e=2*t+1,i=t*t,n=new Array(i+1);for(let r=0;r<=t;++r)for(let s=0;s<=t;++s){const o=r*r+s*s;if(o>i)break;let a=n[o];a||(a=[],n[o]=a),a.push(4*((t+r)*e+(t+s))+3),r>0&&a.push(4*((t-r)*e+(t+s))+3),s>0&&(a.push(4*((t+r)*e+(t-s))+3),r>0&&a.push(4*((t-r)*e+(t-s))+3))}const r=[];for(let t=0,e=n.length;t<e;++t)n[t]&&r.push(...n[t]);return ce[t]=r,r}(n);let g;function d(t,e){const i=h.getImageData(0,0,o,o).data;for(let a=0,l=u.length;a<l;a++)if(i[u[a]]>0){if(!s||"Image"!==g&&"Text"!==g||s.includes(t)){const i=(u[a]-3)/4,s=n-i%o,l=n-(i/o|0),h=r(t,e,s*s+l*l);if(h)return h}h.clearRect(0,0,o,o);break}}const _=Object.keys(this.executorsByZIndex_).map(Number);let p,m,x,y,S;for(_.sort(k.j2),p=_.length-1;p>=0;--p){const t=_[p].toString();for(x=this.executorsByZIndex_[t],m=he.length-1;m>=0;--m)if(g=he[m],y=x[g],void 0!==y&&(S=y.executeHitDetection(h,a,i,d,c),S))return S}}getClipCoords(t){const e=this.maxExtent_;if(!e)return null;const i=e[0],n=e[1],r=e[2],s=e[3],o=[i,n,i,s,r,s,r,n];return(0,Ut.vT)(o,0,8,2,t,o),o}isEmpty(){return(0,it.x)(this.executorsByZIndex_)}execute(t,e,i,n,r,s,o){const a=Object.keys(this.executorsByZIndex_).map(Number);let l,h,c,u,g,d;for(a.sort(k.j2),this.maxExtent_&&(t.save(),this.clip(t,i)),s=s||he,o&&a.reverse(),l=0,h=a.length;l<h;++l){const h=a[l].toString();for(g=this.executorsByZIndex_[h],c=0,u=s.length;c<u;++c)d=g[s[c]],void 0!==d&&d.execute(t,e,i,n,r,o)}this.maxExtent_&&t.restore()}};var ge=i(4708),de=i(7195),fe=i(7755),_e=i(6762);const pe=class extends Ft{constructor(t,e,i,n,r,s,o){super(),this.context_=t,this.pixelRatio_=e,this.extent_=i,this.transform_=n,this.transformRotation_=n?(0,Nt.FH)(Math.atan2(n[1],n[0]),10):0,this.viewRotation_=r,this.squaredTolerance_=s,this.userTransform_=o,this.contextFillState_=null,this.contextStrokeState_=null,this.contextTextState_=null,this.fillState_=null,this.strokeState_=null,this.image_=null,this.imageAnchorX_=0,this.imageAnchorY_=0,this.imageHeight_=0,this.imageOpacity_=0,this.imageOriginX_=0,this.imageOriginY_=0,this.imageRotateWithView_=!1,this.imageRotation_=0,this.imageScale_=[0,0],this.imageWidth_=0,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=!1,this.textRotation_=0,this.textScale_=[0,0],this.textFillState_=null,this.textStrokeState_=null,this.textState_=null,this.pixelCoordinates_=[],this.tmpLocalTransform_=(0,Ht.Ue)()}drawImages_(t,e,i,n){if(!this.image_)return;const r=(0,Ut.vT)(t,e,i,n,this.transform_,this.pixelCoordinates_),s=this.context_,o=this.tmpLocalTransform_,a=s.globalAlpha;1!=this.imageOpacity_&&(s.globalAlpha=a*this.imageOpacity_);let l=this.imageRotation_;0===this.transformRotation_&&(l-=this.viewRotation_),this.imageRotateWithView_&&(l+=this.viewRotation_);for(let t=0,e=r.length;t<e;t+=2){const e=r[t]-this.imageAnchorX_,i=r[t+1]-this.imageAnchorY_;if(0!==l||1!=this.imageScale_[0]||1!=this.imageScale_[1]){const t=e+this.imageAnchorX_,n=i+this.imageAnchorY_;(0,Ht.qC)(o,t,n,1,1,l,-t,-n),s.save(),s.transform.apply(s,o),s.translate(t,n),s.scale(this.imageScale_[0],this.imageScale_[1]),s.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),s.restore()}else s.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,e,i,this.imageWidth_,this.imageHeight_)}1!=this.imageOpacity_&&(s.globalAlpha=a)}drawText_(t,e,i,n){if(!this.textState_||""===this.text_)return;this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);const r=(0,Ut.vT)(t,e,i,n,this.transform_,this.pixelCoordinates_),s=this.context_;let o=this.textRotation_;for(0===this.transformRotation_&&(o-=this.viewRotation_),this.textRotateWithView_&&(o+=this.viewRotation_);e<i;e+=n){const t=r[e]+this.textOffsetX_,i=r[e+1]+this.textOffsetY_;0!==o||1!=this.textScale_[0]||1!=this.textScale_[1]?(s.save(),s.translate(t-this.textOffsetX_,i-this.textOffsetY_),s.rotate(o),s.translate(this.textOffsetX_,this.textOffsetY_),s.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&s.strokeText(this.text_,0,0),this.textFillState_&&s.fillText(this.text_,0,0),s.restore()):(this.textStrokeState_&&s.strokeText(this.text_,t,i),this.textFillState_&&s.fillText(this.text_,t,i))}}moveToLineTo_(t,e,i,n,r){const s=this.context_,o=(0,Ut.vT)(t,e,i,n,this.transform_,this.pixelCoordinates_);s.moveTo(o[0],o[1]);let a=o.length;r&&(a-=2);for(let t=2;t<a;t+=2)s.lineTo(o[t],o[t+1]);return r&&s.closePath(),i}drawRings_(t,e,i,n){for(let r=0,s=i.length;r<s;++r)e=this.moveToLineTo_(t,e,i[r],n,!0);return e}drawCircle(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),(0,Wt.kK)(this.extent_,t.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=(0,_e.Kr)(t,this.transform_,this.pixelCoordinates_),i=e[2]-e[0],n=e[3]-e[1],r=Math.sqrt(i*i+n*n),s=this.context_;s.beginPath(),s.arc(e[0],e[1],r,0,2*Math.PI),this.fillState_&&s.fill(),this.strokeState_&&s.stroke()}""!==this.text_&&this.drawText_(t.getCenter(),0,2,2)}}setStyle(t){this.setFillStrokeStyle(t.getFill(),t.getStroke()),this.setImageStyle(t.getImage()),this.setTextStyle(t.getText())}setTransform(t){this.transform_=t}drawGeometry(t){switch(t.getType()){case"Point":this.drawPoint(t);break;case"LineString":this.drawLineString(t);break;case"Polygon":this.drawPolygon(t);break;case"MultiPoint":this.drawMultiPoint(t);break;case"MultiLineString":this.drawMultiLineString(t);break;case"MultiPolygon":this.drawMultiPolygon(t);break;case"GeometryCollection":this.drawGeometryCollection(t);break;case"Circle":this.drawCircle(t)}}drawFeature(t,e){const i=e.getGeometryFunction()(t);i&&(this.setStyle(e),this.drawGeometry(i))}drawGeometryCollection(t){const e=t.getGeometriesArray();for(let t=0,i=e.length;t<i;++t)this.drawGeometry(e[t])}drawPoint(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const e=t.getFlatCoordinates(),i=t.getStride();this.image_&&this.drawImages_(e,0,e.length,i),""!==this.text_&&this.drawText_(e,0,e.length,i)}drawMultiPoint(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const e=t.getFlatCoordinates(),i=t.getStride();this.image_&&this.drawImages_(e,0,e.length,i),""!==this.text_&&this.drawText_(e,0,e.length,i)}drawLineString(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),(0,Wt.kK)(this.extent_,t.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const e=this.context_,i=t.getFlatCoordinates();e.beginPath(),this.moveToLineTo_(i,0,i.length,t.getStride(),!1),e.stroke()}if(""!==this.text_){const e=t.getFlatMidpoint();this.drawText_(e,0,2,2)}}}drawMultiLineString(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const e=t.getExtent();if((0,Wt.kK)(this.extent_,e)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const e=this.context_,i=t.getFlatCoordinates();let n=0;const r=t.getEnds(),s=t.getStride();e.beginPath();for(let t=0,e=r.length;t<e;++t)n=this.moveToLineTo_(i,n,r[t],s,!1);e.stroke()}if(""!==this.text_){const e=t.getFlatMidpoints();this.drawText_(e,0,e.length,2)}}}drawPolygon(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),(0,Wt.kK)(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=this.context_;e.beginPath(),this.drawRings_(t.getOrientedFlatCoordinates(),0,t.getEnds(),t.getStride()),this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(""!==this.text_){const e=t.getFlatInteriorPoint();this.drawText_(e,0,2,2)}}}drawMultiPolygon(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),(0,Wt.kK)(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=this.context_,i=t.getOrientedFlatCoordinates();let n=0;const r=t.getEndss(),s=t.getStride();e.beginPath();for(let t=0,e=r.length;t<e;++t){const e=r[t];n=this.drawRings_(i,n,e,s)}this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(""!==this.text_){const e=t.getFlatInteriorPoints();this.drawText_(e,0,e.length,2)}}}setContextFillState_(t){const e=this.context_,i=this.contextFillState_;i?i.fillStyle!=t.fillStyle&&(i.fillStyle=t.fillStyle,e.fillStyle=t.fillStyle):(e.fillStyle=t.fillStyle,this.contextFillState_={fillStyle:t.fillStyle})}setContextStrokeState_(t){const e=this.context_,i=this.contextStrokeState_;i?(i.lineCap!=t.lineCap&&(i.lineCap=t.lineCap,e.lineCap=t.lineCap),(0,k.fS)(i.lineDash,t.lineDash)||e.setLineDash(i.lineDash=t.lineDash),i.lineDashOffset!=t.lineDashOffset&&(i.lineDashOffset=t.lineDashOffset,e.lineDashOffset=t.lineDashOffset),i.lineJoin!=t.lineJoin&&(i.lineJoin=t.lineJoin,e.lineJoin=t.lineJoin),i.lineWidth!=t.lineWidth&&(i.lineWidth=t.lineWidth,e.lineWidth=t.lineWidth),i.miterLimit!=t.miterLimit&&(i.miterLimit=t.miterLimit,e.miterLimit=t.miterLimit),i.strokeStyle!=t.strokeStyle&&(i.strokeStyle=t.strokeStyle,e.strokeStyle=t.strokeStyle)):(e.lineCap=t.lineCap,e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset,e.lineJoin=t.lineJoin,e.lineWidth=t.lineWidth,e.miterLimit=t.miterLimit,e.strokeStyle=t.strokeStyle,this.contextStrokeState_={lineCap:t.lineCap,lineDash:t.lineDash,lineDashOffset:t.lineDashOffset,lineJoin:t.lineJoin,lineWidth:t.lineWidth,miterLimit:t.miterLimit,strokeStyle:t.strokeStyle})}setContextTextState_(t){const e=this.context_,i=this.contextTextState_,n=t.textAlign?t.textAlign:Bt.PH;i?(i.font!=t.font&&(i.font=t.font,e.font=t.font),i.textAlign!=n&&(i.textAlign=n,e.textAlign=n),i.textBaseline!=t.textBaseline&&(i.textBaseline=t.textBaseline,e.textBaseline=t.textBaseline)):(e.font=t.font,e.textAlign=n,e.textBaseline=t.textBaseline,this.contextTextState_={font:t.font,textAlign:n,textBaseline:t.textBaseline})}setFillStrokeStyle(t,e){if(t){const e=t.getColor();this.fillState_={fillStyle:(0,Pt.y)(e||Bt.bL)}}else this.fillState_=null;if(e){const t=e.getColor(),i=e.getLineCap(),n=e.getLineDash(),r=e.getLineDashOffset(),s=e.getLineJoin(),o=e.getWidth(),a=e.getMiterLimit(),l=n||Bt.X9;this.strokeState_={lineCap:void 0!==i?i:Bt.mb,lineDash:1===this.pixelRatio_?l:l.map((t=>t*this.pixelRatio_)),lineDashOffset:(r||Bt.He)*this.pixelRatio_,lineJoin:void 0!==s?s:Bt.rc,lineWidth:(void 0!==o?o:Bt.yC)*this.pixelRatio_,miterLimit:void 0!==a?a:Bt.V4,strokeStyle:(0,Pt.y)(t||Bt.Tx)}}else this.strokeState_=null}setImageStyle(t){let e;if(!t||!(e=t.getSize()))return void(this.image_=null);const i=t.getPixelRatio(this.pixelRatio_),n=t.getAnchor(),r=t.getOrigin();this.image_=t.getImage(this.pixelRatio_),this.imageAnchorX_=n[0]*i,this.imageAnchorY_=n[1]*i,this.imageHeight_=e[1]*i,this.imageOpacity_=t.getOpacity(),this.imageOriginX_=r[0],this.imageOriginY_=r[1],this.imageRotateWithView_=t.getRotateWithView(),this.imageRotation_=t.getRotation();const s=t.getScaleArray();this.imageScale_=[s[0]*this.pixelRatio_/i,s[1]*this.pixelRatio_/i],this.imageWidth_=e[0]*i}setTextStyle(t){if(t){const e=t.getFill();if(e){const t=e.getColor();this.textFillState_={fillStyle:(0,Pt.y)(t||Bt.bL)}}else this.textFillState_=null;const i=t.getStroke();if(i){const t=i.getColor(),e=i.getLineCap(),n=i.getLineDash(),r=i.getLineDashOffset(),s=i.getLineJoin(),o=i.getWidth(),a=i.getMiterLimit();this.textStrokeState_={lineCap:void 0!==e?e:Bt.mb,lineDash:n||Bt.X9,lineDashOffset:r||Bt.He,lineJoin:void 0!==s?s:Bt.rc,lineWidth:void 0!==o?o:Bt.yC,miterLimit:void 0!==a?a:Bt.V4,strokeStyle:(0,Pt.y)(t||Bt.Tx)}}else this.textStrokeState_=null;const n=t.getFont(),r=t.getOffsetX(),s=t.getOffsetY(),o=t.getRotateWithView(),a=t.getRotation(),l=t.getScaleArray(),h=t.getText(),c=t.getTextAlign(),u=t.getTextBaseline();this.textState_={font:void 0!==n?n:Bt.Df,textAlign:void 0!==c?c:Bt.PH,textBaseline:void 0!==u?u:Bt.ru},this.text_=void 0!==h?Array.isArray(h)?h.reduce(((t,e,i)=>t+(i%2?" ":e)),""):h:"",this.textOffsetX_=void 0!==r?this.pixelRatio_*r:0,this.textOffsetY_=void 0!==s?this.pixelRatio_*s:0,this.textRotateWithView_=void 0!==o&&o,this.textRotation_=void 0!==a?a:0,this.textScale_=[this.pixelRatio_*l[0],this.pixelRatio_*l[1]]}else this.text_=""}},me=.5,xe={Point:function(t,e,i,n,r){const s=i.getImage(),o=i.getText();let a;if(s){if(s.getImageState()!=h.Z.LOADED)return;let l=t;if(r){const h=s.getDeclutterMode();if("none"!==h)if(l=r,"obstacle"===h){const r=t.getBuilder(i.getZIndex(),"Image");r.setImageStyle(s,a),r.drawPoint(e,n)}else o&&o.getText()&&(a={})}const c=l.getBuilder(i.getZIndex(),"Image");c.setImageStyle(s,a),c.drawPoint(e,n)}if(o&&o.getText()){let s=t;r&&(s=r);const l=s.getBuilder(i.getZIndex(),"Text");l.setTextStyle(o,a),l.drawText(e,n)}},LineString:function(t,e,i,n,r){const s=i.getStroke();if(s){const r=t.getBuilder(i.getZIndex(),"LineString");r.setFillStrokeStyle(null,s),r.drawLineString(e,n)}const o=i.getText();if(o&&o.getText()){const s=(r||t).getBuilder(i.getZIndex(),"Text");s.setTextStyle(o),s.drawText(e,n)}},Polygon:function(t,e,i,n,r){const s=i.getFill(),o=i.getStroke();if(s||o){const r=t.getBuilder(i.getZIndex(),"Polygon");r.setFillStrokeStyle(s,o),r.drawPolygon(e,n)}const a=i.getText();if(a&&a.getText()){const s=(r||t).getBuilder(i.getZIndex(),"Text");s.setTextStyle(a),s.drawText(e,n)}},MultiPoint:function(t,e,i,n,r){const s=i.getImage(),o=i.getText();let a;if(s){if(s.getImageState()!=h.Z.LOADED)return;let l=t;if(r){const h=s.getDeclutterMode();if("none"!==h)if(l=r,"obstacle"===h){const r=t.getBuilder(i.getZIndex(),"Image");r.setImageStyle(s,a),r.drawMultiPoint(e,n)}else o&&o.getText()&&(a={})}const c=l.getBuilder(i.getZIndex(),"Image");c.setImageStyle(s,a),c.drawMultiPoint(e,n)}if(o&&o.getText()){let s=t;r&&(s=r);const l=s.getBuilder(i.getZIndex(),"Text");l.setTextStyle(o,a),l.drawText(e,n)}},MultiLineString:function(t,e,i,n,r){const s=i.getStroke();if(s){const r=t.getBuilder(i.getZIndex(),"LineString");r.setFillStrokeStyle(null,s),r.drawMultiLineString(e,n)}const o=i.getText();if(o&&o.getText()){const s=(r||t).getBuilder(i.getZIndex(),"Text");s.setTextStyle(o),s.drawText(e,n)}},MultiPolygon:function(t,e,i,n,r){const s=i.getFill(),o=i.getStroke();if(o||s){const r=t.getBuilder(i.getZIndex(),"Polygon");r.setFillStrokeStyle(s,o),r.drawMultiPolygon(e,n)}const a=i.getText();if(a&&a.getText()){const s=(r||t).getBuilder(i.getZIndex(),"Text");s.setTextStyle(a),s.drawText(e,n)}},GeometryCollection:function(t,e,i,n,r){const s=e.getGeometriesArray();let o,a;for(o=0,a=s.length;o<a;++o)(0,xe[s[o].getType()])(t,s[o],i,n,r)},Circle:function(t,e,i,n,r){const s=i.getFill(),o=i.getStroke();if(s||o){const r=t.getBuilder(i.getZIndex(),"Circle");r.setFillStrokeStyle(s,o),r.drawCircle(e,n)}const a=i.getText();if(a&&a.getText()){const s=(r||t).getBuilder(i.getZIndex(),"Text");s.setTextStyle(a),s.drawText(e,n)}}};function ye(t,e){const i=function(t,e){return.5*t/e}(t,e);return i*i}function Se(t,e,i,n,r,s,o){let a=!1;const l=i.getImage();if(l){const t=l.getImageState();t==h.Z.LOADED||t==h.Z.ERROR?l.unlistenImageChange(r):(t==h.Z.IDLE&&l.load(),l.listenImageChange(r),a=!0)}return function(t,e,i,n,r,s){const o=i.getGeometryFunction()(e);if(!o)return;const a=o.simplifyTransformed(n,r);i.getRenderer()?we(t,a,i,e):(0,xe[a.getType()])(t,a,i,e,s)}(t,e,i,n,s,o),a}function we(t,e,i,n){if("GeometryCollection"!=e.getType())t.getBuilder(i.getZIndex(),"Default").drawCustom(e,n,i.getRenderer(),i.getHitDetectionRenderer());else{const r=e.getGeometries();for(let e=0,s=r.length;e<s;++e)we(t,r[e],i,n)}}var ve=i(1900);const Te={image:["Polygon","Circle","LineString","Image","Text"],hybrid:["Polygon","LineString"],vector:[]},Ie={hybrid:["Image","Text","Default"],vector:["Polygon","Circle","LineString","Image","Text","Default"]};class Ee extends ge.Z{constructor(t){super(t),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.renderedLayerRevision_,this.renderedPixelToCoordinateTransform_=null,this.renderedRotation_,this.tmpTransform_=(0,Ht.Ue)()}prepareTile(t,e,i){let n;const r=t.getState();return r!==de.Z.LOADED&&r!==de.Z.ERROR||(this.updateExecutorGroup_(t,e,i),this.tileImageNeedsRender_(t)&&(n=!0)),n}getTile(t,e,i,n){const r=n.pixelRatio,s=n.viewState,o=s.resolution,a=s.projection,l=this.getLayer(),h=l.getSource().getTile(t,e,i,r,a),c=n.viewHints,u=!(c[fe.Z.ANIMATING]||c[fe.Z.INTERACTING]);return!u&&h.wantedResolution||(h.wantedResolution=o),this.prepareTile(h,r,a)&&(u||Date.now()-n.time<8)&&"vector"!==l.getRenderMode()&&this.renderTileImage_(h,n),super.getTile(t,e,i,n)}isDrawableTile(t){const e=this.getLayer();return super.isDrawableTile(t)&&("vector"===e.getRenderMode()?(0,y.sq)(e)in t.executorGroups:t.hasContext(e))}getTileImage(t){return t.getImage(this.getLayer())}prepareFrame(t){const e=this.getLayer().getRevision();return this.renderedLayerRevision_!==e&&(this.renderedLayerRevision_=e,this.renderedTiles.length=0),super.prepareFrame(t)}updateExecutorGroup_(t,e,i){const n=this.getLayer(),r=n.getRevision(),s=n.getRenderOrder()||null,o=t.wantedResolution,a=t.getReplayState(n);if(!a.dirty&&a.renderedResolution===o&&a.renderedRevision==r&&a.renderedRenderOrder==s)return;const l=n.getSource(),h=n.getDeclutter(),c=l.getTileGrid(),u=l.getTileGridForProjection(i).getTileCoordExtent(t.wrappedTileCoord),g=l.getSourceTiles(e,i,t),d=(0,y.sq)(n);delete t.hitDetectionImageData[d],t.executorGroups[d]=[],h&&(t.declutterExecutorGroups[d]=[]),a.dirty=!1;for(let i=0,r=g.length;i<r;++i){const r=g[i];if(r.getState()!=de.Z.LOADED)continue;const f=r.tileCoord,_=c.getTileCoordExtent(f),p=(0,Wt.Ed)(u,_),m=(0,Wt.f3)(p,n.getRenderBuffer()*o,this.tmpExtent),x=(0,Wt.fS)(_,p)?null:m,y=new $t(0,m,o,e),S=h?new $t(0,p,o,e):void 0,w=ye(o,e),v=function(t){let e;const i=t.getStyleFunction()||n.getStyleFunction();if(i&&(e=i(t,o)),e){const i=this.renderFeature(t,w,e,y,S);a.dirty=a.dirty||i}},T=r.getFeatures();s&&s!==a.renderedRenderOrder&&T.sort(s);for(let t=0,e=T.length;t<e;++t){const e=T[t];x&&!(0,Wt.kK)(x,e.getGeometry().getExtent())||v.call(this,e)}const I=y.finish(),E="vector"!==n.getRenderMode()&&h&&1===g.length?null:p,k=new ue(E,o,e,l.getOverlaps(),I,n.getRenderBuffer());if(t.executorGroups[d].push(k),S){const i=new ue(null,o,e,l.getOverlaps(),S.finish(),n.getRenderBuffer());t.declutterExecutorGroups[d].push(i)}}a.renderedRevision=r,a.renderedRenderOrder=s,a.renderedResolution=o}forEachFeatureAtCoordinate(t,e,i,n,r){const s=e.viewState.resolution,o=e.viewState.rotation;i=null==i?0:i;const a=this.getLayer(),l=a.getSource().getTileGridForProjection(e.viewState.projection),h=(0,Wt.hI)([t]);(0,Wt.f3)(h,s*i,h);const c={},u=function(t,e,i){let s=t.getId();void 0===s&&(s=(0,y.sq)(t));const o=c[s];if(o){if(!0!==o&&i<o.distanceSq){if(0===i)return c[s]=!0,r.splice(r.lastIndexOf(o),1),n(t,a,e);o.geometry=e,o.distanceSq=i}}else{if(0===i)return c[s]=!0,n(t,a,e);r.push(c[s]={feature:t,layer:a,geometry:e,distanceSq:i,callback:n})}},g=this.renderedTiles;let d;for(let n=0,r=g.length;!d&&n<r;++n){const r=g[n],c=l.getTileCoordExtent(r.wrappedTileCoord);if(!(0,Wt.kK)(c,h))continue;const f=(0,y.sq)(a),_=[r.executorGroups[f]],p=r.declutterExecutorGroups[f];p&&_.push(p),_.some((n=>{const r=n===p?e.declutterTree.all().map((t=>t.value)):null;for(let e=0,a=n.length;e<a;++e){const a=n[e];if(d=a.forEachFeatureAtCoordinate(t,s,o,i,u,r),d)return!0}}))}return d}getFeatures(t){return new Promise(((e,i)=>{const n=this.getLayer(),r=(0,y.sq)(n),s=n.getSource(),o=this.renderedProjection,a=o.getExtent(),l=this.renderedResolution,h=s.getTileGridForProjection(o),c=(0,Ht.nn)(this.renderedPixelToCoordinateTransform_,t.slice()),u=h.getTileCoordForCoordAndResolution(c,l);let g;for(let t=0,e=this.renderedTiles.length;t<e;++t)if(u.toString()===this.renderedTiles[t].tileCoord.toString()){if(g=this.renderedTiles[t],g.getState()===de.Z.LOADED){const t=h.getTileCoordExtent(g.tileCoord);s.getWrapX()&&o.canWrapX()&&!(0,Wt.r4)(a,t)&&(0,ve.Cf)(c,o);break}g=void 0}if(!g||g.loadingSourceTiles>0)return void e([]);const d=h.getTileCoordExtent(g.wrappedTileCoord),_=(0,Wt.rL)(d),p=[(c[0]-_[0])/l,(_[1]-c[1])/l],m=g.getSourceTiles().reduce((function(t,e){return t.concat(e.getFeatures())}),[]);let x=g.hitDetectionImageData[r];if(!x){const t=(0,nt.Pq)(h.getTileSize(h.getZForResolution(l,s.zDirection))),e=this.renderedRotation_;x=function(t,e,i,n,r,s,o){const a=t[0]*me,l=t[1]*me,h=(0,f.E4)(a,l);h.imageSmoothingEnabled=!1;const c=h.canvas,u=new pe(h,me,r,null,o),g=i.length,d=Math.floor(16777215/g),_={};for(let t=1;t<=g;++t){const e=i[t-1],o=e.getStyleFunction()||n;if(!o)continue;let a=o(e,s);if(!a)continue;Array.isArray(a)||(a=[a]);const l=(t*d).toString(16).padStart(7,"#00000");for(let t=0,i=a.length;t<i;++t){const i=a[t],n=i.getGeometryFunction()(e);if(!n||!(0,Wt.kK)(r,n.getExtent()))continue;const s=i.clone(),o=s.getFill();o&&o.setColor(l);const h=s.getStroke();h&&(h.setColor(l),h.setLineDash(null)),s.setText(void 0);const c=i.getImage();if(c){const t=c.getImageSize();if(!t)continue;const e=(0,f.E4)(t[0],t[1],void 0,{alpha:!1}),i=e.canvas;e.fillStyle=l,e.fillRect(0,0,i.width,i.height),s.setImage(new v({img:i,anchor:c.getAnchor(),anchorXUnits:"pixels",anchorYUnits:"pixels",offset:c.getOrigin(),opacity:1,size:c.getSize(),scale:c.getScale(),rotation:c.getRotation(),rotateWithView:c.getRotateWithView()}))}const u=s.getZIndex()||0;let g=_[u];g||(g={},_[u]=g,g.Polygon=[],g.Circle=[],g.LineString=[],g.Point=[]);const d=n.getType();if("GeometryCollection"===d){const t=n.getGeometriesArrayRecursive();for(let e=0,i=t.length;e<i;++e){const i=t[e];g[i.getType().replace("Multi","")].push(i,s)}}else g[d.replace("Multi","")].push(n,s)}}const p=Object.keys(_).map(Number).sort(k.j2);for(let t=0,i=p.length;t<i;++t){const i=_[p[t]];for(const t in i){const n=i[t];for(let t=0,i=n.length;t<i;t+=2){u.setStyle(n[t+1]);for(let i=0,r=e.length;i<r;++i)u.setTransform(e[i]),u.drawGeometry(n[t])}}}return h.getImageData(0,0,c.width,c.height)}(t,[this.getRenderTransform(h.getTileCoordCenter(g.wrappedTileCoord),l,0,me,t[0]*me,t[1]*me,0)],m,n.getStyleFunction(),h.getTileCoordExtent(g.wrappedTileCoord),g.getReplayState(n).renderedResolution,e),g.hitDetectionImageData[r]=x}e(function(t,e,i){const n=[];if(i){const r=Math.floor(Math.round(t[0])*me),s=Math.floor(Math.round(t[1])*me),o=4*((0,Nt.uZ)(r,0,i.width-1)+(0,Nt.uZ)(s,0,i.height-1)*i.width),a=i.data[o],l=i.data[o+1],h=i.data[o+2]+256*(l+256*a),c=Math.floor(16777215/e.length);h&&h%c==0&&n.push(e[h/c-1])}return n}(p,m,x))}))}handleFontsChanged(){const t=this.getLayer();t.getVisible()&&void 0!==this.renderedLayerRevision_&&t.changed()}handleStyleImageChange_(t){this.renderIfReadyAndVisible()}renderDeclutter(t){const e=this.context,i=e.globalAlpha;e.globalAlpha=this.getLayer().getOpacity();const n=t.viewHints,r=!(n[fe.Z.ANIMATING]||n[fe.Z.INTERACTING]),s=this.renderedTiles;for(let e=0,i=s.length;e<i;++e){const i=s[e],n=i.declutterExecutorGroups[(0,y.sq)(this.getLayer())];if(n)for(let e=n.length-1;e>=0;--e)n[e].execute(this.context,1,this.getTileRenderTransform(i,t),t.viewState.rotation,r,void 0,t.declutterTree)}e.globalAlpha=i}getTileRenderTransform(t,e){const i=e.pixelRatio,n=e.viewState,r=n.center,s=n.resolution,o=n.rotation,a=e.size,l=Math.round(a[0]*i),h=Math.round(a[1]*i),c=this.getLayer().getSource().getTileGridForProjection(e.viewState.projection),u=t.tileCoord,g=c.getTileCoordExtent(t.wrappedTileCoord),d=c.getTileCoordExtent(u,this.tmpExtent)[0]-g[0];return(0,Ht.Jp)((0,Ht.bA)(this.inversePixelTransform.slice(),1/i,1/i),this.getRenderTransform(r,s,o,i,l,h,d))}postRender(t,e){const i=e.viewHints,n=!(i[fe.Z.ANIMATING]||i[fe.Z.INTERACTING]);this.renderedPixelToCoordinateTransform_=e.pixelToCoordinateTransform.slice(),this.renderedRotation_=e.viewState.rotation;const r=this.getLayer(),s=r.getRenderMode(),o=t.globalAlpha;t.globalAlpha=r.getOpacity();const a=Ie[s],l=e.viewState,h=l.rotation,c=r.getSource(),u=c.getTileGridForProjection(l.projection).getZForResolution(l.resolution,c.zDirection),g=this.renderedTiles,d=[],f=[];let _=!0;for(let i=g.length-1;i>=0;--i){const s=g[i];_=_&&!s.getReplayState(r).dirty;const o=s.executorGroups[(0,y.sq)(r)].filter((t=>t.hasExecutors(a)));if(0===o.length)continue;const l=this.getTileRenderTransform(s,e),c=s.tileCoord[0];let p=!1;const m=o[0].getClipCoords(l);if(m){for(let e=0,i=d.length;e<i;++e)if(u!==c&&c<f[e]){const i=d[e];(0,Wt.kK)([m[0],m[3],m[4],m[7]],[i[0],i[3],i[4],i[7]])&&(p||(t.save(),p=!0),t.beginPath(),t.moveTo(m[0],m[1]),t.lineTo(m[2],m[3]),t.lineTo(m[4],m[5]),t.lineTo(m[6],m[7]),t.moveTo(i[6],i[7]),t.lineTo(i[4],i[5]),t.lineTo(i[2],i[3]),t.lineTo(i[0],i[1]),t.clip())}d.push(m),f.push(c)}for(let e=0,i=o.length;e<i;++e)o[e].execute(t,1,l,h,n,a);p&&t.restore()}t.globalAlpha=o,this.ready=_,super.postRender(t,e)}renderFeature(t,e,i,n,r){if(!i)return!1;let s=!1;if(Array.isArray(i))for(let o=0,a=i.length;o<a;++o)s=Se(n,t,i[o],e,this.boundHandleStyleImageChange_,void 0,r)||s;else s=Se(n,t,i,e,this.boundHandleStyleImageChange_,void 0,r);return s}tileImageNeedsRender_(t){const e=this.getLayer();if("vector"===e.getRenderMode())return!1;const i=t.getReplayState(e),n=e.getRevision(),r=t.wantedResolution;return i.renderedTileResolution!==r||i.renderedTileRevision!==n}renderTileImage_(t,e){const i=this.getLayer(),n=t.getReplayState(i),r=i.getRevision(),s=t.executorGroups[(0,y.sq)(i)];n.renderedTileRevision=r;const o=t.wrappedTileCoord,a=o[0],l=i.getSource();let h=e.pixelRatio;const c=e.viewState.projection,u=l.getTileGridForProjection(c),g=u.getResolution(t.tileCoord[0]),d=e.pixelRatio/t.wantedResolution*g,f=u.getResolution(a),_=t.getContext(i);h=Math.round(Math.max(h,d/h));const p=l.getTilePixelSize(a,h,c);_.canvas.width=p[0],_.canvas.height=p[1];const m=h/d;if(1!==m){const t=(0,Ht.mc)(this.tmpTransform_);(0,Ht.bA)(t,m,m),_.setTransform.apply(_,t)}const x=u.getTileCoordExtent(o,this.tmpExtent),S=d/f,w=(0,Ht.mc)(this.tmpTransform_);(0,Ht.bA)(w,S,-S),(0,Ht.Iu)(w,-x[0],-x[3]);for(let t=0,e=s.length;t<e;++t)s[t].execute(_,m,w,0,!0,Te[i.getRenderMode()]);n.renderedTileResolution=t.wantedResolution}}const ke=Ee;var Ce=i(8280);const Re=class extends Ct{constructor(t){t=t||{};const e=Object.assign({},t);delete e.preload,delete e.useInterimTilesOnError,super(e),this.on,this.once,this.un;const i=t.renderMode||"hybrid";(0,g.h)("hybrid"==i||"vector"==i,"`renderMode` must be `'hybrid'` or `'vector'`"),this.renderMode_=i,this.setPreload(t.preload?t.preload:0),this.setUseInterimTilesOnError(void 0===t.useInterimTilesOnError||t.useInterimTilesOnError),this.getBackground,this.setBackground}createRenderer(){return new ke(this)}getFeatures(t){return super.getFeatures(t)}getRenderMode(){return this.renderMode_}getPreload(){return this.get(Ce.Z.PRELOAD)}getUseInterimTilesOnError(){return this.get(Ce.Z.USE_INTERIM_TILES_ON_ERROR)}setPreload(t){this.set(Ce.Z.PRELOAD,t)}setUseInterimTilesOnError(t){this.set(Ce.Z.USE_INTERIM_TILES_ON_ERROR,t)}}},283:(t,e,i)=>{"use strict";i.d(e,{Z:()=>s});var n=i(5393);class r extends n.Z{constructor(t){super({points:1/0,fill:(t=t||{radius:5}).fill,radius:t.radius,stroke:t.stroke,scale:void 0!==t.scale?t.scale:1,rotation:void 0!==t.rotation?t.rotation:0,rotateWithView:void 0!==t.rotateWithView&&t.rotateWithView,displacement:void 0!==t.displacement?t.displacement:[0,0],declutterMode:t.declutterMode})}clone(){const t=this.getScale(),e=new r({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),scale:Array.isArray(t)?t.slice():t,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return e.setOpacity(this.getOpacity()),e}setRadius(t){this.radius_=t,this.render()}}const s=r},1345:(t,e,i)=>{"use strict";i.d(e,{Z:()=>r});class n{constructor(t){t=t||{},this.color_=void 0!==t.color?t.color:null}clone(){const t=this.getColor();return new n({color:Array.isArray(t)?t.slice():t||void 0})}getColor(){return this.color_}setColor(t){this.color_=t}}const r=n},8443:(t,e,i)=>{"use strict";i.d(e,{Z:()=>o});var n=i(4187),r=i(4307);class s{constructor(t){this.opacity_=t.opacity,this.rotateWithView_=t.rotateWithView,this.rotation_=t.rotation,this.scale_=t.scale,this.scaleArray_=(0,r.Pq)(t.scale),this.displacement_=t.displacement,this.declutterMode_=t.declutterMode}clone(){const t=this.getScale();return new s({opacity:this.getOpacity(),scale:Array.isArray(t)?t.slice():t,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getOpacity(){return this.opacity_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getDisplacement(){return this.displacement_}getDeclutterMode(){return this.declutterMode_}getAnchor(){return(0,n.O3)()}getImage(t){return(0,n.O3)()}getHitDetectionImage(){return(0,n.O3)()}getPixelRatio(t){return 1}getImageState(){return(0,n.O3)()}getImageSize(){return(0,n.O3)()}getOrigin(){return(0,n.O3)()}getSize(){return(0,n.O3)()}setDisplacement(t){this.displacement_=t}setOpacity(t){this.opacity_=t}setRotateWithView(t){this.rotateWithView_=t}setRotation(t){this.rotation_=t}setScale(t){this.scale_=t,this.scaleArray_=(0,r.Pq)(t)}listenImageChange(t){(0,n.O3)()}load(){(0,n.O3)()}unlistenImageChange(t){(0,n.O3)()}}const o=s},5393:(t,e,i)=>{"use strict";i.d(e,{Z:()=>c});var n=i(553),r=i(8443),s=i(8532),o=i(6620),a=i(8326),l=i(147);class h extends r.Z{constructor(t){super({opacity:1,rotateWithView:void 0!==t.rotateWithView&&t.rotateWithView,rotation:void 0!==t.rotation?t.rotation:0,scale:void 0!==t.scale?t.scale:1,displacement:void 0!==t.displacement?t.displacement:[0,0],declutterMode:t.declutterMode}),this.canvases_,this.hitDetectionCanvas_=null,this.fill_=void 0!==t.fill?t.fill:null,this.origin_=[0,0],this.points_=t.points,this.radius_=void 0!==t.radius?t.radius:t.radius1,this.radius2_=t.radius2,this.angle_=void 0!==t.angle?t.angle:0,this.stroke_=void 0!==t.stroke?t.stroke:null,this.size_,this.renderOptions_,this.render()}clone(){const t=this.getScale(),e=new h({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(t)?t.slice():t,displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return e.setOpacity(this.getOpacity()),e}getAnchor(){const t=this.size_,e=this.getDisplacement(),i=this.getScaleArray();return[t[0]/2-e[0]/i[0],t[1]/2+e[1]/i[1]]}getAngle(){return this.angle_}getFill(){return this.fill_}setFill(t){this.fill_=t,this.render()}getHitDetectionImage(){return this.hitDetectionCanvas_||(this.hitDetectionCanvas_=this.createHitDetectionCanvas_(this.renderOptions_)),this.hitDetectionCanvas_}getImage(t){let e=this.canvases_[t];if(!e){const i=this.renderOptions_,n=(0,a.E4)(i.size*t,i.size*t);this.draw_(i,n,t),e=n.canvas,this.canvases_[t]=e}return e}getPixelRatio(t){return t}getImageSize(){return this.size_}getImageState(){return n.Z.LOADED}getOrigin(){return this.origin_}getPoints(){return this.points_}getRadius(){return this.radius_}getRadius2(){return this.radius2_}getSize(){return this.size_}getStroke(){return this.stroke_}setStroke(t){this.stroke_=t,this.render()}listenImageChange(t){}load(){}unlistenImageChange(t){}calculateLineJoinSize_(t,e,i){if(0===e||this.points_===1/0||"bevel"!==t&&"miter"!==t)return e;let n=this.radius_,r=void 0===this.radius2_?n:this.radius2_;if(n<r){const t=n;n=r,r=t}const s=void 0===this.radius2_?this.points_:2*this.points_,o=2*Math.PI/s,a=r*Math.sin(o),l=n-Math.sqrt(r*r-a*a),h=Math.sqrt(a*a+l*l),c=h/a;if("miter"===t&&c<=i)return c*e;const u=e/2/c,g=e/2*(l/h),d=Math.sqrt((n+u)*(n+u)+g*g)-n;if(void 0===this.radius2_||"bevel"===t)return 2*d;const f=n*Math.sin(o),_=r-Math.sqrt(n*n-f*f),p=Math.sqrt(f*f+_*_)/f;if(p<=i){const t=p*e/2-r-n;return 2*Math.max(d,t)}return 2*d}createRenderOptions(){let t,e=l.mb,i=l.rc,n=0,r=null,s=0,a=0;this.stroke_&&(t=(0,o.y)(this.stroke_.getColor()??l.Tx),a=this.stroke_.getWidth()??l.yC,r=this.stroke_.getLineDash(),s=this.stroke_.getLineDashOffset()??0,i=this.stroke_.getLineJoin()??l.rc,e=this.stroke_.getLineCap()??l.mb,n=this.stroke_.getMiterLimit()??l.V4);const h=this.calculateLineJoinSize_(i,a,n),c=Math.max(this.radius_,this.radius2_||0);return{strokeStyle:t,strokeWidth:a,size:Math.ceil(2*c+h),lineCap:e,lineDash:r,lineDashOffset:s,lineJoin:i,miterLimit:n}}render(){this.renderOptions_=this.createRenderOptions();const t=this.renderOptions_.size;this.canvases_={},this.hitDetectionCanvas_=null,this.size_=[t,t]}draw_(t,e,i){if(e.scale(i,i),e.translate(t.size/2,t.size/2),this.createPath_(e),this.fill_){let t=this.fill_.getColor();null===t&&(t=l.bL),e.fillStyle=(0,o.y)(t),e.fill()}t.strokeStyle&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineCap=t.lineCap,e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit,e.stroke())}createHitDetectionCanvas_(t){let e;if(this.fill_){let i=this.fill_.getColor(),n=0;"string"==typeof i&&(i=(0,s._2)(i)),null===i?n=1:Array.isArray(i)&&(n=4===i.length?i[3]:1),0===n&&(e=(0,a.E4)(t.size,t.size),this.drawHitDetectionCanvas_(t,e))}return e?e.canvas:this.getImage(1)}createPath_(t){let e=this.points_;const i=this.radius_;if(e===1/0)t.arc(0,0,i,0,2*Math.PI);else{const n=void 0===this.radius2_?i:this.radius2_;void 0!==this.radius2_&&(e*=2);const r=this.angle_-Math.PI/2,s=2*Math.PI/e;for(let o=0;o<e;o++){const e=r+o*s,a=o%2==0?i:n;t.lineTo(a*Math.cos(e),a*Math.sin(e))}t.closePath()}}drawHitDetectionCanvas_(t,e){e.translate(t.size/2,t.size/2),this.createPath_(e),e.fillStyle=l.bL,e.fill(),t.strokeStyle&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit,e.stroke())}}const c=h},8958:(t,e,i)=>{"use strict";i.d(e,{Z:()=>r});class n{constructor(t){t=t||{},this.color_=void 0!==t.color?t.color:null,this.lineCap_=t.lineCap,this.lineDash_=void 0!==t.lineDash?t.lineDash:null,this.lineDashOffset_=t.lineDashOffset,this.lineJoin_=t.lineJoin,this.miterLimit_=t.miterLimit,this.width_=t.width}clone(){const t=this.getColor();return new n({color:Array.isArray(t)?t.slice():t||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})}getColor(){return this.color_}getLineCap(){return this.lineCap_}getLineDash(){return this.lineDash_}getLineDashOffset(){return this.lineDashOffset_}getLineJoin(){return this.lineJoin_}getMiterLimit(){return this.miterLimit_}getWidth(){return this.width_}setColor(t){this.color_=t}setLineCap(t){this.lineCap_=t}setLineDash(t){this.lineDash_=t}setLineDashOffset(t){this.lineDashOffset_=t}setLineJoin(t){this.lineJoin_=t}setMiterLimit(t){this.miterLimit_=t}setWidth(t){this.width_=t}}const r=n},7539:(t,e,i)=>{"use strict";i.d(e,{J$:()=>l,ZP:()=>g,yF:()=>c});var n=i(283),r=i(1345),s=i(8958),o=i(9515);class a{constructor(t){t=t||{},this.geometry_=null,this.geometryFunction_=u,void 0!==t.geometry&&this.setGeometry(t.geometry),this.fill_=void 0!==t.fill?t.fill:null,this.image_=void 0!==t.image?t.image:null,this.renderer_=void 0!==t.renderer?t.renderer:null,this.hitDetectionRenderer_=void 0!==t.hitDetectionRenderer?t.hitDetectionRenderer:null,this.stroke_=void 0!==t.stroke?t.stroke:null,this.text_=void 0!==t.text?t.text:null,this.zIndex_=t.zIndex}clone(){let t=this.getGeometry();return t&&"object"==typeof t&&(t=t.clone()),new a({geometry:t??void 0,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,renderer:this.getRenderer()??void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})}getRenderer(){return this.renderer_}setRenderer(t){this.renderer_=t}setHitDetectionRenderer(t){this.hitDetectionRenderer_=t}getHitDetectionRenderer(){return this.hitDetectionRenderer_}getGeometry(){return this.geometry_}getGeometryFunction(){return this.geometryFunction_}getFill(){return this.fill_}setFill(t){this.fill_=t}getImage(){return this.image_}setImage(t){this.image_=t}getStroke(){return this.stroke_}setStroke(t){this.stroke_=t}getText(){return this.text_}setText(t){this.text_=t}getZIndex(){return this.zIndex_}setGeometry(t){"function"==typeof t?this.geometryFunction_=t:"string"==typeof t?this.geometryFunction_=function(e){return e.get(t)}:t?void 0!==t&&(this.geometryFunction_=function(){return t}):this.geometryFunction_=u,this.geometry_=t}setZIndex(t){this.zIndex_=t}}function l(t){let e;if("function"==typeof t)e=t;else{let i;Array.isArray(t)?i=t:((0,o.h)("function"==typeof t.getZIndex,"Expected an `Style` or an array of `Style`"),i=[t]),e=function(){return i}}return e}let h=null;function c(t,e){if(!h){const t=new r.Z({color:"rgba(255,255,255,0.4)"}),e=new s.Z({color:"#3399CC",width:1.25});h=[new a({image:new n.Z({fill:t,stroke:e,radius:5}),fill:t,stroke:e})]}return h}function u(t){return t.getGeometry()}const g=a},1280:(t,e,i)=>{"use strict";i.d(e,{Z:()=>o});var n=i(1345),r=i(4307);class s{constructor(t){t=t||{},this.font_=t.font,this.rotation_=t.rotation,this.rotateWithView_=t.rotateWithView,this.scale_=t.scale,this.scaleArray_=(0,r.Pq)(void 0!==t.scale?t.scale:1),this.text_=t.text,this.textAlign_=t.textAlign,this.justify_=t.justify,this.repeat_=t.repeat,this.textBaseline_=t.textBaseline,this.fill_=void 0!==t.fill?t.fill:new n.Z({color:"#333"}),this.maxAngle_=void 0!==t.maxAngle?t.maxAngle:Math.PI/4,this.placement_=void 0!==t.placement?t.placement:"point",this.overflow_=!!t.overflow,this.stroke_=void 0!==t.stroke?t.stroke:null,this.offsetX_=void 0!==t.offsetX?t.offsetX:0,this.offsetY_=void 0!==t.offsetY?t.offsetY:0,this.backgroundFill_=t.backgroundFill?t.backgroundFill:null,this.backgroundStroke_=t.backgroundStroke?t.backgroundStroke:null,this.padding_=void 0===t.padding?null:t.padding}clone(){const t=this.getScale();return new s({font:this.getFont(),placement:this.getPlacement(),repeat:this.getRepeat(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(t)?t.slice():t,text:this.getText(),textAlign:this.getTextAlign(),justify:this.getJustify(),textBaseline:this.getTextBaseline(),fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()||void 0})}getOverflow(){return this.overflow_}getFont(){return this.font_}getMaxAngle(){return this.maxAngle_}getPlacement(){return this.placement_}getRepeat(){return this.repeat_}getOffsetX(){return this.offsetX_}getOffsetY(){return this.offsetY_}getFill(){return this.fill_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getStroke(){return this.stroke_}getText(){return this.text_}getTextAlign(){return this.textAlign_}getJustify(){return this.justify_}getTextBaseline(){return this.textBaseline_}getBackgroundFill(){return this.backgroundFill_}getBackgroundStroke(){return this.backgroundStroke_}getPadding(){return this.padding_}setOverflow(t){this.overflow_=t}setFont(t){this.font_=t}setMaxAngle(t){this.maxAngle_=t}setOffsetX(t){this.offsetX_=t}setOffsetY(t){this.offsetY_=t}setPlacement(t){this.placement_=t}setRepeat(t){this.repeat_=t}setRotateWithView(t){this.rotateWithView_=t}setFill(t){this.fill_=t}setRotation(t){this.rotation_=t}setScale(t){this.scale_=t,this.scaleArray_=(0,r.Pq)(void 0!==t?t:1)}setStroke(t){this.stroke_=t}setText(t){this.text_=t}setTextAlign(t){this.textAlign_=t}setJustify(t){this.justify_=t}setTextBaseline(t){this.textBaseline_=t}setBackgroundFill(t){this.backgroundFill_=t}setBackgroundStroke(t){this.backgroundStroke_=t}setPadding(t){this.padding_=t}}const o=s}}]);
//# sourceMappingURL=717.bundle.js.map
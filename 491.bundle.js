"use strict";(self.webpackChunkol_mbtiles=self.webpackChunkol_mbtiles||[]).push([[491],{9491:(e,t,o)=>{o.r(t),o.d(t,{default:()=>d});var r=o(8854),n=o(2479),a=o(9090),s=o(9731),l=o(6263),i=o(8661),c=o(5901),u=o(5917);function d(){return new r.Z({target:"map",layers:[new n.Z({source:new l.Z}),new s.Z({source:new c.B({url:"https://velivole.b-cdn.net/maptiler-osm-2017-07-03-v3.6.1-europe.mbtiles",layers:["transportation","water","waterway","landuse","place","boundary"],attributions:["MapTiler","OSM","https://data.maptiler.com/downloads/dataset/osm/europe/"],maxZoom:14,minZoom:0}),style:function(e){switch(e.get("layer")){case"water":case"waterway":return u.d_;case"transportation":return(0,u.xl)(e);case"landuse":return u.Xu;case"boundary":return u.oj;case"place":return(0,u.Hh)(e);default:return null}}})],view:new a.ZP({center:(0,i.mi)([12,50]),zoom:6})})}},5917:(e,t,o)=>{o.d(t,{Hh:()=>g,Xu:()=>w,d_:()=>m,kY:()=>c,oj:()=>h,xl:()=>f,y8:()=>i});var r=o(7539),n=o(283),a=o(1345),s=o(8958),l=o(1280);function i(e,t){let o,i;switch(e){case 0:o=6,i="2em";break;case 1:o=5,i="1.2em";break;case 2:o=3,i="0.8em";break;default:o=1,i="0.5em"}i+=" helvetica, sans-serif";const c="#00007f";return new r.ZP({image:new n.Z({fill:new a.Z({color:c}),radius:o,stroke:new s.Z({color:c,width:o})}),text:new l.Z({font:i,text:t.get("n"),fill:new a.Z({color:"#ffffff"}),stroke:new s.Z({color:c,width:2})})})}const c=new r.ZP({stroke:new s.Z({color:"blue",width:2})}),u={},d={motorway:"#776",trunk:"#ccb",highway:"#f39"},w=new r.ZP({fill:new a.Z({color:"#666"}),stroke:new s.Z({color:"#444",width:1})}),m=new r.ZP({fill:new a.Z({color:"#9db9e8"})}),h=new r.ZP({stroke:new s.Z({color:"#8B008B",width:2})}),f=function(e){const t=e.get("class"),o=e.get("railway"),n=e.get("sort_key"),a=t+"/"+o+"/"+n;let l=u[a];if(!l){let e,i;o?(e="#7de",i=1):(e=d[t],i="highway"==t?1.5:1),l=new r.ZP({stroke:new s.Z({color:e,width:i}),zIndex:n}),u[a]=l}return l},y=new r.ZP({image:new n.Z({radius:5,fill:new a.Z({color:"#000080"})})}),p=new s.Z({color:"white",width:2}),g=function(e){if("country"==e.get("class"))return null;if(e.get("name")){const t=y.clone();return t.setText(new l.Z({text:e.get("name"),offsetY:-5,font:"bold 16px sans-serif",stroke:p})),t}}},5901:(e,t,o)=>{o.d(t,{B:()=>y});var r=o(2891),n=o.n(r),a=o(7205),s=o(3614),l=o.n(s),i=o(8929),c=o(7885),u=o(9646),d=o(9619),w=o(3433),m=o(8661);class h extends u.ZP{constructor(e){var t,o,r;super(),e=e||{},this.dataProjection=new d.Z({code:"",units:"tile-pixels"}),this.featureClass_=e.featureClass?e.featureClass:w.ZP,this.geometryName_=null!==(t=e.geometryName)&&void 0!==t?t:"Geometry",this.layers_=null!==(o=e.layers)&&void 0!==o?o:null,this.idProperty_=e.idProperty,this.extent=null!==(r=e.extent)&&void 0!==r?r:4096,this.supportedMediaTypes=["application/vnd-mbtiles"]}readFeature(e,t){const o=e.properties;let r;this.idProperty_?(r=o[this.idProperty_],delete o[this.idProperty_]):r=e.id;const n=e.loadGeometry(),a=[],s=[],l=h.MBTypes[n.length>1?"multi":"mono"][e.type];if("Unknown"===l)return null;for(let e=0;e<n.length;e++)if(0!=n[e].length){for(let t=0;t<n[e].length;t++)a.push(n[e][t].x,n[e][t].y);s.push(a.length)}const i=new this.featureClass_(l,a,s,o,r);return i.transform(t.dataProjection),i}readFeatures(e,t){const o=this.layers_,r=[],n=new i.VectorTile(new(l())(c.ec(e)));t=this.adaptOptions(t);const a=(0,m.U2)(t.dataProjection);a.setWorldExtent(t.extent),a.setExtent([0,0,this.extent,this.extent]),t.dataProjection=a;for(const e of Object.keys(n.layers)){if(o&&!o.includes(e))continue;const a=n.layers[e];for(let o=0;o<a.length;o++){const n=a.feature(o),s=this.readFeature(n,t);s.getProperties().layer=e,r.push(s)}}return r}readProjection(){return this.dataProjection}}h.MBTypes={mono:["Unknown","Point","LineString","Polygon"],multi:["Unknown","MultiPoint","MultiLineString","Polygon"]};const f=null!==n()&&void 0!==n()?n():r;class y extends a.Z{constructor(e){var t,o;super(Object.assign(Object.assign({},e),{url:void 0,format:new h({layers:e.layers}),tileUrlFunction:e=>`${e[0]}:${e[1]}:${e[2]}`})),this.setTileLoadFunction(this.tileLoader.bind(this));const r={from:"inline",config:{serverMode:"full",requestChunkSize:1024,url:e.url}};this.worker=[];for(let n=0;n<(null!==(t=e.sqlWorkers)&&void 0!==t?t:4);n++)this.worker[n]=f.createDbWorker([r],y.workerUrl.toString(),y.wasmUrl.toString(),null!==(o=e.maxSingleTransfer)&&void 0!==o?o:10485760);this.currentWorker=0,this.metadata=this.worker[this.currentWorker++%this.worker.length].then((e=>e.db.query('SELECT name,value FROM metadata WHERE name="maxzoom" or name="minzoom"'))).then((t=>{if(t&&2==t.length){const o=t.reduce(((e,t)=>(e[t.name]=t.value,e)),{});return console.debug("Loaded metadata",o),e.maxZoom==o.maxzoom&&e.minZoom==o.minzoom||console.warn(`minZoom/maxZoom ${o.minzoom}/${o.maxzoom} of retrieved MBTiles do not match Openlayers configuration ${e.minZoom}/${e.maxZoom}`),o}throw new Error("Could not load metadata")})).catch((e=>(console.warn(e),null)))}tileLoader(e,t){console.debug("loading tile",[e.tileCoord[0],e.tileCoord[1],e.tileCoord[2]]),e.setLoader(((t,o,r)=>{this.worker[this.currentWorker++%this.worker.length].then((t=>t.db.query("SELECT tile_data FROM tiles WHERE zoom_level = ? AND tile_column = ? AND tile_row = ?",[e.tileCoord[0],e.tileCoord[1],(1<<e.tileCoord[0])-1-e.tileCoord[2]]))).then((o=>{if(o&&o[0]&&o[0].tile_data){const n=e.getFormat().readFeatures(o[0].tile_data,{extent:t,featureProjection:r});return e.setFeatures(n),void e.onLoad(n,r)}throw new Error(`No data for ${e.tileCoord}`)})).catch((t=>{console.warn(t),e.onError()}))}))}destroy(){for(const e of this.worker)e.then((e=>{e.release()}))}}y.workerUrl=new URL(o(421),o.b),y.wasmUrl=new URL(o(3611),o.b)}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LE1BQU0sSUFBSVAsTUFBTSxlQUFlcEQsRUFBS3dELFlBQVksSUFFakRILE9BQU9DLElBQ05QLFFBQVFJLEtBQUtHLEdBQ2J0RCxFQUFLZ0UsU0FBUyxHQUNkLEdBRVIsQ0FFQUMsVUFDRSxJQUFLLE1BQU1uQyxLQUFVOUQsS0FBSzhELE9BQ3hCQSxFQUFPUyxNQUFNQyxJQUNYQSxFQUFFMEIsU0FBUyxHQUdqQixFQXJHTyxFQUFBakMsVUFBWSxJQUFJa0MsSUFDckIsWUFHSyxFQUFBaEMsUUFBVSxJQUFJZ0MsSUFDbkIsWSIsInNvdXJjZXMiOlsid2VicGFjazovL29sLW1idGlsZXMvLi9leGFtcGxlcy9jb2RlL29zbS12ZWN0b3ItdGlsZXMudHMiLCJ3ZWJwYWNrOi8vb2wtbWJ0aWxlcy8uL2V4YW1wbGVzL3N0eWxlLnRzIiwid2VicGFjazovL29sLW1idGlsZXMvLi9zcmMvbWJ0aWxlcy1mb3JtYXQudHMiLCJ3ZWJwYWNrOi8vb2wtbWJ0aWxlcy8uL3NyYy9tYnRpbGVzLXNvdXJjZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgTWFwIGZyb20gJ29sL01hcC5qcyc7XG5pbXBvcnQgVGlsZUxheWVyIGZyb20gJ29sL2xheWVyL1RpbGUuanMnO1xuaW1wb3J0IFZpZXcgZnJvbSAnb2wvVmlldy5qcyc7XG5pbXBvcnQgVmVjdG9yVGlsZUxheWVyIGZyb20gJ29sL2xheWVyL1ZlY3RvclRpbGUnO1xuaW1wb3J0IFRpbGVEZWJ1ZyBmcm9tICdvbC9zb3VyY2UvVGlsZURlYnVnJztcbmltcG9ydCB7IGZyb21Mb25MYXQgfSBmcm9tICdvbC9wcm9qJztcblxuaW1wb3J0IHsgTUJUaWxlc1NvdXJjZSB9IGZyb20gJ29sLW1idGlsZXMnO1xuaW1wb3J0IHsgd2F0ZXJTdHlsZSwgcm9hZFN0eWxlLCBidWlsZGluZ1N0eWxlLCBib3VuZGFyeVN0eWxlLCBwbGFjZVN0eWxlIH0gZnJvbSAnLi4vc3R5bGUnO1xuXG4vLyBNQlRpbGVzIGZyb21cbi8vIGh0dHBzOi8vZGF0YS5tYXB0aWxlci5jb20vZG93bmxvYWRzL2RhdGFzZXQvb3NtL2V1cm9wZS9cbi8vIDM0LjQgR0Igb3JpZ2luYWwgZmlsZVxuLy8gZG93biB0byAxOS4yR0IgYWZ0ZXIgdmFjdXVtIChNYXBUaWxlciwgd3RmPylcblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gKCkge1xuICByZXR1cm4gbmV3IE1hcCh7XG4gICAgdGFyZ2V0OiAnbWFwJyxcbiAgICBsYXllcnM6IFtcbiAgICAgIG5ldyBUaWxlTGF5ZXIoe1xuICAgICAgICBzb3VyY2U6IG5ldyBUaWxlRGVidWcoKVxuICAgICAgfSksXG4gICAgICBuZXcgVmVjdG9yVGlsZUxheWVyKHtcbiAgICAgICAgc291cmNlOiBuZXcgTUJUaWxlc1NvdXJjZSh7XG4gICAgICAgICAgdXJsOiAnaHR0cHM6Ly92ZWxpdm9sZS5iLWNkbi5uZXQvbWFwdGlsZXItb3NtLTIwMTctMDctMDMtdjMuNi4xLWV1cm9wZS5tYnRpbGVzJyxcbiAgICAgICAgICBsYXllcnM6IFsndHJhbnNwb3J0YXRpb24nLCAnd2F0ZXInLCAnd2F0ZXJ3YXknLCAnbGFuZHVzZScsICdwbGFjZScsICdib3VuZGFyeSddLFxuICAgICAgICAgIGF0dHJpYnV0aW9uczogWydNYXBUaWxlcicsICdPU00nLCAnaHR0cHM6Ly9kYXRhLm1hcHRpbGVyLmNvbS9kb3dubG9hZHMvZGF0YXNldC9vc20vZXVyb3BlLyddLFxuICAgICAgICAgIG1heFpvb206IDE0LFxuICAgICAgICAgIG1pblpvb206IDBcbiAgICAgICAgfSksXG4gICAgICAgIHN0eWxlOiBmdW5jdGlvbiAoZmVhdHVyZSkge1xuICAgICAgICAgIHN3aXRjaCAoZmVhdHVyZS5nZXQoJ2xheWVyJykpIHtcbiAgICAgICAgICAgIGNhc2UgJ3dhdGVyJzpcbiAgICAgICAgICAgIGNhc2UgJ3dhdGVyd2F5JzpcbiAgICAgICAgICAgICAgcmV0dXJuIHdhdGVyU3R5bGU7XG4gICAgICAgICAgICBjYXNlICd0cmFuc3BvcnRhdGlvbic6XG4gICAgICAgICAgICAgIHJldHVybiByb2FkU3R5bGUoZmVhdHVyZSk7XG4gICAgICAgICAgICBjYXNlICdsYW5kdXNlJzpcbiAgICAgICAgICAgICAgcmV0dXJuIGJ1aWxkaW5nU3R5bGU7XG4gICAgICAgICAgICBjYXNlICdib3VuZGFyeSc6XG4gICAgICAgICAgICAgIHJldHVybiBib3VuZGFyeVN0eWxlO1xuICAgICAgICAgICAgY2FzZSAncGxhY2UnOlxuICAgICAgICAgICAgICByZXR1cm4gcGxhY2VTdHlsZShmZWF0dXJlKTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSlcbiAgICBdLFxuICAgIHZpZXc6IG5ldyBWaWV3KHtcbiAgICAgIGNlbnRlcjogZnJvbUxvbkxhdChbMTIsIDUwXSksXG4gICAgICB6b29tOiA2XG4gICAgfSksXG4gIH0pO1xufSIsImltcG9ydCBGZWF0dXJlIGZyb20gJ29sL0ZlYXR1cmUnO1xuaW1wb3J0IHsgU3R5bGUsIFRleHQsIEZpbGwsIFN0cm9rZSwgQ2lyY2xlIH0gZnJvbSAnb2wvc3R5bGUnO1xuXG5leHBvcnQgZnVuY3Rpb24gc3R5bGVUb3duKHNpemU6IG51bWJlciwgZmVhdHVyZTogRmVhdHVyZSk6IFN0eWxlIHtcbiAgbGV0IHdpZHRoOiBudW1iZXI7XG4gIGxldCBmb250OiBzdHJpbmc7XG4gIHN3aXRjaCAoc2l6ZSkge1xuICAgIGNhc2UgMDpcbiAgICAgIHdpZHRoID0gNjtcbiAgICAgIGZvbnQgPSAnMmVtJztcbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgMTpcbiAgICAgIHdpZHRoID0gNTtcbiAgICAgIGZvbnQgPSAnMS4yZW0nO1xuICAgICAgYnJlYWs7XG4gICAgY2FzZSAyOlxuICAgICAgd2lkdGggPSAzO1xuICAgICAgZm9udCA9ICcwLjhlbSc7XG4gICAgICBicmVhaztcbiAgICBkZWZhdWx0OlxuICAgICAgd2lkdGggPSAxO1xuICAgICAgZm9udCA9ICcwLjVlbSc7XG4gICAgICBicmVhaztcbiAgfVxuICBmb250ICs9ICcgaGVsdmV0aWNhLCBzYW5zLXNlcmlmJztcbiAgY29uc3QgY29sb3IxID0gJyMwMDAwN2YnO1xuICBjb25zdCBjb2xvcjIgPSAnI2ZmZmZmZic7XG5cbiAgY29uc3Qgc3R5bGUgPSBuZXcgU3R5bGUoe1xuICAgIGltYWdlOiBuZXcgQ2lyY2xlKHtcbiAgICAgIGZpbGw6IG5ldyBGaWxsKHtcbiAgICAgICAgY29sb3I6IGNvbG9yMSxcbiAgICAgIH0pLFxuICAgICAgcmFkaXVzOiB3aWR0aCxcbiAgICAgIHN0cm9rZTogbmV3IFN0cm9rZSh7XG4gICAgICAgIGNvbG9yOiBjb2xvcjEsXG4gICAgICAgIHdpZHRoOiB3aWR0aCxcbiAgICAgIH0pLFxuICAgIH0pLFxuICAgIHRleHQ6IG5ldyBUZXh0KHtcbiAgICAgIGZvbnQ6IGZvbnQsXG4gICAgICB0ZXh0OiBmZWF0dXJlLmdldCgnbicpLFxuICAgICAgZmlsbDogbmV3IEZpbGwoe1xuICAgICAgICBjb2xvcjogY29sb3IyXG4gICAgICB9KSxcbiAgICAgIHN0cm9rZTogbmV3IFN0cm9rZSh7XG4gICAgICAgIGNvbG9yOiBjb2xvcjEsXG4gICAgICAgIHdpZHRoOiAyXG4gICAgICB9KVxuICAgIH0pXG4gIH0pO1xuICByZXR1cm4gc3R5bGU7XG59XG5cbmV4cG9ydCBjb25zdCBzdHlsZUJvcmRlciA9IG5ldyBTdHlsZSh7XG4gIHN0cm9rZTogbmV3IFN0cm9rZSh7XG4gICAgY29sb3I6ICdibHVlJyxcbiAgICB3aWR0aDogMlxuICB9KVxufSk7XG5cblxuLy8gU3R5bGVzIGluc3BpcmVkIGZyb20gaHR0cHM6Ly9vcGVubGF5ZXJzLm9yZy9lbi9sYXRlc3QvZXhhbXBsZXMvb3NtLXZlY3Rvci10aWxlcy5odG1sXG5jb25zdCByb2FkU3R5bGVDYWNoZSA9IHt9O1xuY29uc3Qgcm9hZENvbG9yID0ge1xuICAnbW90b3J3YXknOiAnIzc3NicsXG4gICd0cnVuayc6ICcjY2NiJyxcbiAgJ2hpZ2h3YXknOiAnI2YzOScsXG59O1xuZXhwb3J0IGNvbnN0IGJ1aWxkaW5nU3R5bGUgPSBuZXcgU3R5bGUoe1xuICBmaWxsOiBuZXcgRmlsbCh7XG4gICAgY29sb3I6ICcjNjY2J1xuICB9KSxcbiAgc3Ryb2tlOiBuZXcgU3Ryb2tlKHtcbiAgICBjb2xvcjogJyM0NDQnLFxuICAgIHdpZHRoOiAxLFxuICB9KSxcbn0pO1xuZXhwb3J0IGNvbnN0IHdhdGVyU3R5bGUgPSBuZXcgU3R5bGUoe1xuICBmaWxsOiBuZXcgRmlsbCh7XG4gICAgY29sb3I6ICcjOWRiOWU4JyxcbiAgfSksXG59KTtcbmV4cG9ydCBjb25zdCBib3VuZGFyeVN0eWxlID0gbmV3IFN0eWxlKHtcbiAgc3Ryb2tlOiBuZXcgU3Ryb2tlKHtcbiAgICBjb2xvcjogJyM4QjAwOEInLFxuICAgIHdpZHRoOiAyLFxuICB9KSxcbn0pO1xuZXhwb3J0IGNvbnN0IHJvYWRTdHlsZSA9IGZ1bmN0aW9uIChmZWF0dXJlKSB7XG4gIGNvbnN0IGtpbmQgPSBmZWF0dXJlLmdldCgnY2xhc3MnKTtcbiAgY29uc3QgcmFpbHdheSA9IGZlYXR1cmUuZ2V0KCdyYWlsd2F5Jyk7XG4gIGNvbnN0IHNvcnRfa2V5ID0gZmVhdHVyZS5nZXQoJ3NvcnRfa2V5Jyk7XG4gIGNvbnN0IHN0eWxlS2V5ID0ga2luZCArICcvJyArIHJhaWx3YXkgKyAnLycgKyBzb3J0X2tleTtcbiAgbGV0IHN0eWxlID0gcm9hZFN0eWxlQ2FjaGVbc3R5bGVLZXldO1xuICBpZiAoIXN0eWxlKSB7XG4gICAgbGV0IGNvbG9yLCB3aWR0aDtcbiAgICBpZiAocmFpbHdheSkge1xuICAgICAgY29sb3IgPSAnIzdkZSc7XG4gICAgICB3aWR0aCA9IDE7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbG9yID0gcm9hZENvbG9yW2tpbmRdO1xuICAgICAgd2lkdGggPSBraW5kID09ICdoaWdod2F5JyA/IDEuNSA6IDE7XG4gICAgfVxuICAgIHN0eWxlID0gbmV3IFN0eWxlKHtcbiAgICAgIHN0cm9rZTogbmV3IFN0cm9rZSh7XG4gICAgICAgIGNvbG9yOiBjb2xvcixcbiAgICAgICAgd2lkdGg6IHdpZHRoLFxuICAgICAgfSksXG4gICAgICB6SW5kZXg6IHNvcnRfa2V5LFxuICAgIH0pO1xuICAgIHJvYWRTdHlsZUNhY2hlW3N0eWxlS2V5XSA9IHN0eWxlO1xuICB9XG4gIHJldHVybiBzdHlsZTtcbn07XG5jb25zdCBwbGFjZUJhc2UgPSBuZXcgU3R5bGUoe1xuICBpbWFnZTogbmV3IENpcmNsZSh7XG4gICAgcmFkaXVzOiA1LFxuICAgIGZpbGw6IG5ldyBGaWxsKHtcbiAgICAgIGNvbG9yOiAnIzAwMDA4MCdcbiAgICB9KVxuICB9KVxufSk7XG5jb25zdCB0ZXh0U3Ryb2tlID0gbmV3IFN0cm9rZSh7XG4gIGNvbG9yOiAnd2hpdGUnLFxuICB3aWR0aDogMlxufSk7XG5leHBvcnQgY29uc3QgcGxhY2VTdHlsZSA9IGZ1bmN0aW9uIChmZWF0dXJlKSB7XG4gIGlmIChmZWF0dXJlLmdldCgnY2xhc3MnKSA9PSAnY291bnRyeScpXG4gICAgcmV0dXJuIG51bGw7XG4gIGlmIChmZWF0dXJlLmdldCgnbmFtZScpKSB7XG4gICAgY29uc3Qgc3R5bGUgPSBwbGFjZUJhc2UuY2xvbmUoKTtcbiAgICBzdHlsZS5zZXRUZXh0KG5ldyBUZXh0KHtcbiAgICAgIHRleHQ6IGZlYXR1cmUuZ2V0KCduYW1lJyksXG4gICAgICBvZmZzZXRZOiAtNSxcbiAgICAgIGZvbnQ6ICdib2xkIDE2cHggc2Fucy1zZXJpZicsXG4gICAgICBzdHJva2U6IHRleHRTdHJva2VcbiAgICB9KSk7XG4gICAgcmV0dXJuIHN0eWxlO1xuICB9XG59OyIsImltcG9ydCBQcm90b2J1ZiBmcm9tICdwYmYnO1xuaW1wb3J0IHsgVmVjdG9yVGlsZSwgVmVjdG9yVGlsZUZlYXR1cmUgfSBmcm9tICdAbWFwYm94L3ZlY3Rvci10aWxlJztcbmltcG9ydCAqIGFzIHBha28gZnJvbSAncGFrbyc7XG5cbmltcG9ydCBGZWF0dXJlRm9ybWF0LCB7IFJlYWRPcHRpb25zIH0gZnJvbSAnb2wvZm9ybWF0L0ZlYXR1cmUuanMnO1xuaW1wb3J0IFByb2plY3Rpb24gZnJvbSAnb2wvcHJvai9Qcm9qZWN0aW9uLmpzJztcbmltcG9ydCBSZW5kZXJGZWF0dXJlIGZyb20gJ29sL3JlbmRlci9GZWF0dXJlLmpzJztcbmltcG9ydCB7IEZlYXR1cmVMaWtlIH0gZnJvbSAnb2wvRmVhdHVyZS5qcyc7XG5pbXBvcnQgeyBnZXQgYXMgZ2V0UHJvamVjdGlvbiB9IGZyb20gJ29sL3Byb2ouanMnO1xuaW1wb3J0IHsgVHlwZSB9IGZyb20gJ29sL2dlb20vR2VvbWV0cnknO1xuXG5kZWNsYXJlIG1vZHVsZSAnQG1hcGJveC92ZWN0b3ItdGlsZScge1xuICBpbnRlcmZhY2UgVmVjdG9yVGlsZUZlYXR1cmUge1xuICAgIHRvR2VvSlNPTih4OiBudW1iZXIsIHk6IG51bWJlciwgejogbnVtYmVyLCBwcm9qZWN0PzogKHh5OiBbbnVtYmVyLCBudW1iZXJdKSA9PiBbbnVtYmVyLCBudW1iZXJdKTogR2VvSlNPTi5GZWF0dXJlO1xuICB9XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgT3B0aW9ucyB7XG4gIGxheWVycz86IHN0cmluZ1tdO1xuICBmZWF0dXJlQ2xhc3M/OiB0eXBlb2YgUmVuZGVyRmVhdHVyZTtcbiAgZ2VvbWV0cnlOYW1lPzogc3RyaW5nO1xuICBpZFByb3BlcnR5Pzogc3RyaW5nO1xuICBleHRlbnQ/OiBudW1iZXI7XG59XG5cbmV4cG9ydCBjbGFzcyBNQlRpbGVzRm9ybWF0IGV4dGVuZHMgRmVhdHVyZUZvcm1hdCB7XG4gIGRhdGFQcm9qZWN0aW9uOiBQcm9qZWN0aW9uO1xuICBwcml2YXRlIGZlYXR1cmVDbGFzc186IHR5cGVvZiBSZW5kZXJGZWF0dXJlO1xuICBwcml2YXRlIGdlb21ldHJ5TmFtZV86IHN0cmluZztcbiAgcHJpdmF0ZSBsYXllcnNfOiBzdHJpbmdbXSB8IG51bGw7XG4gIHByaXZhdGUgaWRQcm9wZXJ0eV86IHN0cmluZztcbiAgc3VwcG9ydGVkTWVkaWFUeXBlczogc3RyaW5nW107XG4gIGV4dGVudDogbnVtYmVyO1xuICBzdGF0aWMgTUJUeXBlcyA9IHtcbiAgICBtb25vOiBbJ1Vua25vd24nLCAnUG9pbnQnLCAnTGluZVN0cmluZycsICdQb2x5Z29uJyBdLFxuICAgIG11bHRpOiBbJ1Vua25vd24nLCAnTXVsdGlQb2ludCcsICdNdWx0aUxpbmVTdHJpbmcnLCAnUG9seWdvbiddXG4gICB9IGFzIFJlY29yZDwnbW9ubycgfCAnbXVsdGknLCAoVHlwZSB8ICdVbmtub3duJylbXT47XG5cbiAgY29uc3RydWN0b3Iob3B0aW9ucz86IE9wdGlvbnMpIHtcbiAgICBzdXBlcigpO1xuXG4gICAgb3B0aW9ucyA9IG9wdGlvbnMgPyBvcHRpb25zIDoge307XG5cbiAgICB0aGlzLmRhdGFQcm9qZWN0aW9uID0gbmV3IFByb2plY3Rpb24oe1xuICAgICAgY29kZTogJycsXG4gICAgICB1bml0czogJ3RpbGUtcGl4ZWxzJyxcbiAgICB9KTtcblxuICAgIHRoaXMuZmVhdHVyZUNsYXNzXyA9IG9wdGlvbnMuZmVhdHVyZUNsYXNzID8gb3B0aW9ucy5mZWF0dXJlQ2xhc3MgOiBSZW5kZXJGZWF0dXJlO1xuICAgIHRoaXMuZ2VvbWV0cnlOYW1lXyA9IG9wdGlvbnMuZ2VvbWV0cnlOYW1lID8/ICdHZW9tZXRyeSc7XG4gICAgdGhpcy5sYXllcnNfID0gb3B0aW9ucy5sYXllcnMgPz8gbnVsbDtcbiAgICB0aGlzLmlkUHJvcGVydHlfID0gb3B0aW9ucy5pZFByb3BlcnR5O1xuICAgIHRoaXMuZXh0ZW50ID0gb3B0aW9ucy5leHRlbnQgPz8gNDA5NjtcblxuICAgIC8qKlxuICAgICAqIEFzIHRoaXMgaXMgdGhlIHZlcnkgZmlyc3QgdGltZSBNQlRpbGVzIHdpbGwgYmUgZGlzdHJpYnV0ZWQgYnkgSFRUUFxuICAgICAqIHRoZXJlIGlzIHN0aWxsIG5vIG9mZmljaWFsIE1JTUUgdHlwZVxuICAgICAqL1xuICAgIHRoaXMuc3VwcG9ydGVkTWVkaWFUeXBlcyA9IFtcbiAgICAgICdhcHBsaWNhdGlvbi92bmQtbWJ0aWxlcydcbiAgICBdO1xuICB9XG5cbiAgcmVhZEZlYXR1cmUoc291cmNlOiBWZWN0b3JUaWxlRmVhdHVyZSwgb3B0aW9ucz86IFJlYWRPcHRpb25zKTogRmVhdHVyZUxpa2Uge1xuICAgIGNvbnN0IHByb3BlcnRpZXMgPSBzb3VyY2UucHJvcGVydGllcztcblxuICAgIGxldCBpZDogc3RyaW5nIHwgbnVtYmVyO1xuICAgIGlmICghdGhpcy5pZFByb3BlcnR5Xykge1xuICAgICAgaWQgPSBzb3VyY2UuaWQ7XG4gICAgfSBlbHNlIHtcbiAgICAgIGlkID0gcHJvcGVydGllc1t0aGlzLmlkUHJvcGVydHlfXSBhcyBzdHJpbmcgfCBudW1iZXI7XG4gICAgICBkZWxldGUgcHJvcGVydGllc1t0aGlzLmlkUHJvcGVydHlfXTtcbiAgICB9XG4gICAgY29uc3QgcG9pbnRzID0gc291cmNlLmxvYWRHZW9tZXRyeSgpO1xuICAgIGNvbnN0IGZsYXRDb29yZGluYXRlcyA9IFtdIGFzIG51bWJlcltdO1xuICAgIGNvbnN0IGVuZHMgPSBbXSBhcyBudW1iZXJbXTtcblxuICAgIGNvbnN0IHR5cGU6IFR5cGUgfCAnVW5rbm93bicgPSBNQlRpbGVzRm9ybWF0Lk1CVHlwZXNbcG9pbnRzLmxlbmd0aCA+IDEgPyAnbXVsdGknIDogJ21vbm8nXVtzb3VyY2UudHlwZV07XG4gICAgaWYgKHR5cGUgPT09ICdVbmtub3duJylcbiAgICAgIHJldHVybiBudWxsO1xuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBwb2ludHMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGlmIChwb2ludHNbaV0ubGVuZ3RoID09IDApXG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBwb2ludHNbaV0ubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgZmxhdENvb3JkaW5hdGVzLnB1c2gocG9pbnRzW2ldW2pdLngsIHBvaW50c1tpXVtqXS55KTtcbiAgICAgIH1cbiAgICAgIGVuZHMucHVzaChmbGF0Q29vcmRpbmF0ZXMubGVuZ3RoKTtcbiAgICB9XG5cbiAgICBjb25zdCBmZWF0dXJlID0gbmV3IHRoaXMuZmVhdHVyZUNsYXNzXyh0eXBlLCBmbGF0Q29vcmRpbmF0ZXMsIGVuZHMsIHByb3BlcnRpZXMsIGlkKTtcbiAgICBmZWF0dXJlLnRyYW5zZm9ybShvcHRpb25zLmRhdGFQcm9qZWN0aW9uKTtcblxuICAgIHJldHVybiBmZWF0dXJlO1xuICB9XG5cbiAgcmVhZEZlYXR1cmVzKHNvdXJjZTogQXJyYXlCdWZmZXIsIG9wdGlvbnM/OiBSZWFkT3B0aW9ucyk6IEZlYXR1cmVMaWtlW10ge1xuICAgIGNvbnN0IGxheWVycyA9IHRoaXMubGF5ZXJzXztcblxuICAgIGNvbnN0IGZlYXR1cmVzOiBGZWF0dXJlTGlrZVtdID0gW107XG4gICAgY29uc3QgdGlsZSA9IG5ldyBWZWN0b3JUaWxlKG5ldyBQcm90b2J1ZihwYWtvLnVuZ3ppcChzb3VyY2UpKSk7XG4gICAgb3B0aW9ucyA9IHRoaXMuYWRhcHRPcHRpb25zKG9wdGlvbnMpO1xuICAgIGNvbnN0IGRhdGFQcm9qZWN0aW9uID0gZ2V0UHJvamVjdGlvbihvcHRpb25zLmRhdGFQcm9qZWN0aW9uKTtcbiAgICBkYXRhUHJvamVjdGlvbi5zZXRXb3JsZEV4dGVudChvcHRpb25zLmV4dGVudCk7XG4gICAgZGF0YVByb2plY3Rpb24uc2V0RXh0ZW50KFswLCAwLCB0aGlzLmV4dGVudCwgdGhpcy5leHRlbnRdKTtcbiAgICBvcHRpb25zLmRhdGFQcm9qZWN0aW9uID0gZGF0YVByb2plY3Rpb247XG5cbiAgICBmb3IgKGNvbnN0IGxheWVyTmFtZSBvZiBPYmplY3Qua2V5cyh0aWxlLmxheWVycykpIHtcbiAgICAgIGlmIChsYXllcnMgJiYgIWxheWVycy5pbmNsdWRlcyhsYXllck5hbWUpKSB7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuICAgICAgY29uc3QgbCA9IHRpbGUubGF5ZXJzW2xheWVyTmFtZV07XG4gICAgICBmb3IgKGxldCBpZHggPSAwOyBpZHggPCBsLmxlbmd0aDsgaWR4KyspIHtcbiAgICAgICAgY29uc3QgdmVjdG9yRmVhdHVyZSA9IGwuZmVhdHVyZShpZHgpO1xuICAgICAgICBjb25zdCBmZWF0dXJlID0gdGhpcy5yZWFkRmVhdHVyZSh2ZWN0b3JGZWF0dXJlLCBvcHRpb25zKTtcbiAgICAgICAgZmVhdHVyZS5nZXRQcm9wZXJ0aWVzKCkubGF5ZXIgPSBsYXllck5hbWU7XG4gICAgICAgIGZlYXR1cmVzLnB1c2goZmVhdHVyZSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIGZlYXR1cmVzO1xuICB9XG5cbiAgcmVhZFByb2plY3Rpb24oKSB7XG4gICAgcmV0dXJuIHRoaXMuZGF0YVByb2plY3Rpb247XG4gIH1cblxufSIsIi8vIFdoeSBpcyB0aGlzIGhvcnJvciBuZWNlc3Nhcnk/XG4vLyBCZWNhdXNlIG9mIGh0dHBzOi8vZ2l0aHViLmNvbS9ub2RlanMvY2pzLW1vZHVsZS1sZXhlci9wdWxsLzI0XG5pbXBvcnQgc3FsaHR0cERlZmF1bHQgZnJvbSAnc3FsLmpzLWh0dHB2ZnMnO1xuaW1wb3J0ICogYXMgc3FsaHR0cEFsbCBmcm9tICdzcWwuanMtaHR0cHZmcyc7XG5jb25zdCBzcWxodHRwID0gc3FsaHR0cERlZmF1bHQgPz8gc3FsaHR0cEFsbDtcbmltcG9ydCB0eXBlIHsgV29ya2VySHR0cHZmcyB9IGZyb20gJ3NxbC5qcy1odHRwdmZzJztcbmltcG9ydCB7IFNwbGl0RmlsZUNvbmZpZ1B1cmUgfSBmcm9tICdzcWwuanMtaHR0cHZmcy9kaXN0L3NxbGl0ZS53b3JrZXInO1xuXG5pbXBvcnQgVmVjdG9yVGlsZVNvdXJjZSwgeyBPcHRpb25zIGFzIFZlY3RvclRpbGVPcHRpb25zIH0gZnJvbSAnb2wvc291cmNlL1ZlY3RvclRpbGUuanMnO1xuaW1wb3J0IFZlY3RvclRpbGUgZnJvbSAnb2wvVmVjdG9yVGlsZS5qcyc7XG5pbXBvcnQgeyBUaWxlQ29vcmQgfSBmcm9tICdvbC90aWxlY29vcmQuanMnO1xuaW1wb3J0IEZlYXR1cmUgZnJvbSAnb2wvRmVhdHVyZS5qcyc7XG5pbXBvcnQgeyBHZW9tZXRyeSB9IGZyb20gJ29sL2dlb20uanMnO1xuXG5pbXBvcnQgeyBNQlRpbGVzRm9ybWF0IH0gZnJvbSAnLi9tYnRpbGVzLWZvcm1hdCc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgT3B0aW9ucyBleHRlbmRzIFZlY3RvclRpbGVPcHRpb25zIHtcbiAgLyoqXG4gICAqIE51bWJlciBvZiBwYXJhbGxlbCB3b3JrZXJzIHRvIHVzZSBmb3IgcmV0cmlldmluZyB0aWxlcywgQGRlZmF1bHQgNFxuICAgKi9cbiAgc3FsV29ya2Vycz86IG51bWJlcjtcbiAgLyoqXG4gICAqIExpc3Qgb2YgbGF5ZXIgbmFtZXMgdG8gc2VsZWN0aXZlbHkgaW5jbHVkZSwgQGRlZmF1bHQgZXZlcnl0aGluZ1xuICAgKi9cbiAgbGF5ZXJzPzogc3RyaW5nW107XG4gIC8qKlxuICAgKiBNYXhpbXVtIGFtb3VudCBvZiBieXRlcyB0byB0cmFuc2ZlciBmb3IgYSBzaW5nbGUgdGlsZS5cbiAgICogVGhpcyBpcyBhIHByb3RlY3Rpb24gYWdhaW5zdCByZXF1ZXN0aW5nIGZyb20gYSBkYXRhYmFzZSB3aXRob3V0IGluZGV4LlxuICAgKiBAZGVmYXVsdCAxMDQ4NTc2MFxuICAgKi9cbiAgbWF4U2luZ2xlVHJhbnNmZXI/OiBudW1iZXI7XG5cbiAgdGlsZVVybEZ1bmN0aW9uPzogbmV2ZXI7XG4gIHRpbGVMb2FkRnVuY3Rpb24/OiBuZXZlcjtcbiAgZm9ybWF0PzogbmV2ZXI7XG59XG5cbmludGVyZmFjZSBNZXRhZGF0YSB7XG4gIG1pbnpvb206IG51bWJlcjtcbiAgbWF4em9vbTogbnVtYmVyO1xufVxuXG4vKipcbiAqIEEgdGlsZSBzb3VyY2UgaW4gYSByZW1vdGUgLm1idGlsZXMgZmlsZSBhY2Nlc3NpYmxlIGJ5IEhUVFBcbiAqL1xuZXhwb3J0IGNsYXNzIE1CVGlsZXNTb3VyY2UgZXh0ZW5kcyBWZWN0b3JUaWxlU291cmNlIHtcbiAgcHJpdmF0ZSB3b3JrZXI6IFByb21pc2U8V29ya2VySHR0cHZmcz5bXTtcbiAgcHJpdmF0ZSBjdXJyZW50V29ya2VyOiBudW1iZXI7XG4gIG1ldGFkYXRhOiBQcm9taXNlPE1ldGFkYXRhIHwgbnVsbD47XG4gIHN0YXRpYyB3b3JrZXJVcmwgPSBuZXcgVVJMKFxuICAgICdzcWwuanMtaHR0cHZmcy9kaXN0L3NxbGl0ZS53b3JrZXIuanMnLFxuICAgIGltcG9ydC5tZXRhLnVybCxcbiAgKTtcbiAgc3RhdGljIHdhc21VcmwgPSBuZXcgVVJMKFxuICAgICdzcWwuanMtaHR0cHZmcy9kaXN0L3NxbC13YXNtLndhc20nLFxuICAgIGltcG9ydC5tZXRhLnVybCxcbiAgKTsgXG5cbiAgY29uc3RydWN0b3Iob3B0aW9uczogT3B0aW9ucykge1xuICAgIHN1cGVyKHtcbiAgICAgIC4uLm9wdGlvbnMsXG4gICAgICB1cmw6IHVuZGVmaW5lZCxcbiAgICAgIGZvcm1hdDogbmV3IE1CVGlsZXNGb3JtYXQoe1xuICAgICAgICBsYXllcnM6IG9wdGlvbnMubGF5ZXJzXG4gICAgICB9KSxcbiAgICAgIC8vIFRoaXMgaXMgcmVxdWlyZWQgdG8gcHJldmVudCBPcGVubGF5ZXJzJyBjYWNoZSBmcm9tIHRoaW5raW5nIHRoYXQgYWxsIHRpbGVzIHNoYXJlIHRoZSBzYW1lIFVSTFxuICAgICAgdGlsZVVybEZ1bmN0aW9uOiAoY29vcmRzOiBUaWxlQ29vcmQpID0+IGAke2Nvb3Jkc1swXX06JHtjb29yZHNbMV19OiR7Y29vcmRzWzJdfWBcbiAgICB9KTtcblxuICAgIHRoaXMuc2V0VGlsZUxvYWRGdW5jdGlvbih0aGlzLnRpbGVMb2FkZXIuYmluZCh0aGlzKSk7XG5cbiAgICBjb25zdCBjb25maWcgPSB7XG4gICAgICBmcm9tOiAnaW5saW5lJyxcbiAgICAgIGNvbmZpZzoge1xuICAgICAgICBzZXJ2ZXJNb2RlOiAnZnVsbCcsXG4gICAgICAgIHJlcXVlc3RDaHVua1NpemU6IDEwMjQsXG4gICAgICAgIHVybDogb3B0aW9ucy51cmxcbiAgICAgIH1cbiAgICB9IGFzIFNwbGl0RmlsZUNvbmZpZ1B1cmU7XG5cbiAgICB0aGlzLndvcmtlciA9IFtdO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgKG9wdGlvbnMuc3FsV29ya2VycyA/PyA0KTsgaSsrKSB7XG4gICAgICB0aGlzLndvcmtlcltpXSA9IHNxbGh0dHAuY3JlYXRlRGJXb3JrZXIoXG4gICAgICAgIFtjb25maWddLFxuICAgICAgICBNQlRpbGVzU291cmNlLndvcmtlclVybC50b1N0cmluZygpLFxuICAgICAgICBNQlRpbGVzU291cmNlLndhc21VcmwudG9TdHJpbmcoKSxcbiAgICAgICAgb3B0aW9ucy5tYXhTaW5nbGVUcmFuc2ZlciA/PyAxMDI0ICogMTAyNCAqIDEwXG4gICAgICApO1xuICAgIH1cbiAgICB0aGlzLmN1cnJlbnRXb3JrZXIgPSAwO1xuXG4gICAgdGhpcy5tZXRhZGF0YSA9IHRoaXMud29ya2VyWyh0aGlzLmN1cnJlbnRXb3JrZXIrKykgJSB0aGlzLndvcmtlci5sZW5ndGhdXG4gICAgICAudGhlbigodykgPT4gdy5kYi5xdWVyeSgnU0VMRUNUIG5hbWUsdmFsdWUgRlJPTSBtZXRhZGF0YSBXSEVSRSBuYW1lPVwibWF4em9vbVwiIG9yIG5hbWU9XCJtaW56b29tXCInKSlcbiAgICAgIC50aGVuKChyKSA9PiB7XG4gICAgICAgIC8vIEFsYXMsIGF0IHRoZSBtb21lbnQgaXQgaXMgbm90IHBvc3NpYmxlIHRvIHJlcGxhY2UgdGhlIFRpbGVHcmlkIGFmdGVyIGNvbnN0cnVjdGluZyB0aGUgbGF5ZXJcbiAgICAgICAgaWYgKHIgJiYgci5sZW5ndGggPT0gMikge1xuICAgICAgICAgIGNvbnN0IGRhdGEgPSByLnJlZHVjZSgoYSwgeCkgPT4ge1xuICAgICAgICAgICAgYVt4WyduYW1lJ11dID0geFsndmFsdWUnXTtcbiAgICAgICAgICAgIHJldHVybiBhO1xuICAgICAgICAgIH0sIHt9KSBhcyBSZWNvcmQ8c3RyaW5nLCBudW1iZXI+O1xuICAgICAgICAgIGNvbnNvbGUuZGVidWcoJ0xvYWRlZCBtZXRhZGF0YScsIGRhdGEpO1xuICAgICAgICAgIGlmIChvcHRpb25zLm1heFpvb20gIT0gZGF0YS5tYXh6b29tIHx8IG9wdGlvbnMubWluWm9vbSAhPSBkYXRhLm1pbnpvb20pIHtcbiAgICAgICAgICAgIGNvbnNvbGUud2FybihgbWluWm9vbS9tYXhab29tICR7ZGF0YS5taW56b29tfS8ke2RhdGEubWF4em9vbX1gICtcbiAgICAgICAgICAgICAgYCBvZiByZXRyaWV2ZWQgTUJUaWxlcyBkbyBub3QgbWF0Y2ggT3BlbmxheWVycyBjb25maWd1cmF0aW9uICR7b3B0aW9ucy5taW5ab29tfS8ke29wdGlvbnMubWF4Wm9vbX1gKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIGRhdGEgYXMgdW5rbm93biBhcyBNZXRhZGF0YTtcbiAgICAgICAgfVxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0NvdWxkIG5vdCBsb2FkIG1ldGFkYXRhJyk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKGUgPT4ge1xuICAgICAgICBjb25zb2xlLndhcm4oZSk7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfSk7XG4gIH1cblxuICBwcml2YXRlIHRpbGVMb2FkZXIodGlsZTogVmVjdG9yVGlsZSwgX3VybDogc3RyaW5nKSB7XG4gICAgY29uc29sZS5kZWJ1ZygnbG9hZGluZyB0aWxlJywgW3RpbGUudGlsZUNvb3JkWzBdLCB0aWxlLnRpbGVDb29yZFsxXSwgdGlsZS50aWxlQ29vcmRbMl1dKTtcbiAgICB0aWxlLnNldExvYWRlcigoZXh0ZW50LCByZXNvbHV0aW9uLCBwcm9qZWN0aW9uKSA9PiB7XG4gICAgICB0aGlzLndvcmtlclsodGhpcy5jdXJyZW50V29ya2VyKyspICUgdGhpcy53b3JrZXIubGVuZ3RoXVxuICAgICAgICAudGhlbigodykgPT5cbiAgICAgICAgICB3LmRiLnF1ZXJ5KFxuICAgICAgICAgICAgJ1NFTEVDVCB0aWxlX2RhdGEgRlJPTSB0aWxlcyBXSEVSRSB6b29tX2xldmVsID0gPyBBTkQgdGlsZV9jb2x1bW4gPSA/IEFORCB0aWxlX3JvdyA9ID8nLFxuICAgICAgICAgICAgW3RpbGUudGlsZUNvb3JkWzBdLCB0aWxlLnRpbGVDb29yZFsxXSwgKDEgPDwgdGlsZS50aWxlQ29vcmRbMF0pIC0gMSAtIHRpbGUudGlsZUNvb3JkWzJdXVxuICAgICAgICAgICkpXG4gICAgICAgIC50aGVuKChyKSA9PiB7XG4gICAgICAgICAgaWYgKHIgJiYgclswXSAmJiByWzBdWyd0aWxlX2RhdGEnXSkge1xuICAgICAgICAgICAgY29uc3QgZm9ybWF0ID0gdGlsZS5nZXRGb3JtYXQoKTtcbiAgICAgICAgICAgIGNvbnN0IGZlYXR1cmVzID0gZm9ybWF0LnJlYWRGZWF0dXJlcyhyWzBdWyd0aWxlX2RhdGEnXSwge1xuICAgICAgICAgICAgICBleHRlbnQsXG4gICAgICAgICAgICAgIGZlYXR1cmVQcm9qZWN0aW9uOiBwcm9qZWN0aW9uXG4gICAgICAgICAgICB9KSBhcyBGZWF0dXJlPEdlb21ldHJ5PltdO1xuICAgICAgICAgICAgdGlsZS5zZXRGZWF0dXJlcyhmZWF0dXJlcyk7XG4gICAgICAgICAgICB0aWxlLm9uTG9hZChmZWF0dXJlcywgcHJvamVjdGlvbik7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgTm8gZGF0YSBmb3IgJHt0aWxlLnRpbGVDb29yZH1gKTtcbiAgICAgICAgfSlcbiAgICAgICAgLmNhdGNoKChlKSA9PiB7XG4gICAgICAgICAgY29uc29sZS53YXJuKGUpO1xuICAgICAgICAgIHRpbGUub25FcnJvcigpO1xuICAgICAgICB9KTtcbiAgICB9KTtcbiAgfVxuXG4gIGRlc3Ryb3koKSB7XG4gICAgZm9yIChjb25zdCB3b3JrZXIgb2YgdGhpcy53b3JrZXIpIHtcbiAgICAgIHdvcmtlci50aGVuKCh3KSA9PiB7XG4gICAgICAgIHcucmVsZWFzZSgpO1xuICAgICAgfSk7XG4gICAgfVxuICB9XG59XG4iXSwibmFtZXMiOlsidGFyZ2V0IiwibGF5ZXJzIiwic291cmNlIiwidXJsIiwiYXR0cmlidXRpb25zIiwibWF4Wm9vbSIsIm1pblpvb20iLCJzdHlsZSIsImZlYXR1cmUiLCJnZXQiLCJ2aWV3IiwiY2VudGVyIiwiem9vbSIsInN0eWxlVG93biIsInNpemUiLCJ3aWR0aCIsImZvbnQiLCJjb2xvcjEiLCJpbWFnZSIsImZpbGwiLCJjb2xvciIsInJhZGl1cyIsInN0cm9rZSIsInRleHQiLCJzdHlsZUJvcmRlciIsInJvYWRTdHlsZUNhY2hlIiwicm9hZENvbG9yIiwiYnVpbGRpbmdTdHlsZSIsIndhdGVyU3R5bGUiLCJib3VuZGFyeVN0eWxlIiwicm9hZFN0eWxlIiwia2luZCIsInJhaWx3YXkiLCJzb3J0X2tleSIsInN0eWxlS2V5IiwiekluZGV4IiwicGxhY2VCYXNlIiwidGV4dFN0cm9rZSIsInBsYWNlU3R5bGUiLCJjbG9uZSIsInNldFRleHQiLCJvZmZzZXRZIiwiTUJUaWxlc0Zvcm1hdCIsIkZlYXR1cmUiLCJjb25zdHJ1Y3RvciIsIm9wdGlvbnMiLCJzdXBlciIsInRoaXMiLCJkYXRhUHJvamVjdGlvbiIsIlByb2plY3Rpb24iLCJjb2RlIiwidW5pdHMiLCJmZWF0dXJlQ2xhc3NfIiwiZmVhdHVyZUNsYXNzIiwiZ2VvbWV0cnlOYW1lXyIsImdlb21ldHJ5TmFtZSIsImxheWVyc18iLCJpZFByb3BlcnR5XyIsImlkUHJvcGVydHkiLCJleHRlbnQiLCJzdXBwb3J0ZWRNZWRpYVR5cGVzIiwicmVhZEZlYXR1cmUiLCJwcm9wZXJ0aWVzIiwiaWQiLCJwb2ludHMiLCJsb2FkR2VvbWV0cnkiLCJmbGF0Q29vcmRpbmF0ZXMiLCJlbmRzIiwidHlwZSIsIk1CVHlwZXMiLCJsZW5ndGgiLCJpIiwiaiIsInB1c2giLCJ4IiwieSIsInRyYW5zZm9ybSIsInJlYWRGZWF0dXJlcyIsImZlYXR1cmVzIiwidGlsZSIsIlZlY3RvclRpbGUiLCJhZGFwdE9wdGlvbnMiLCJzZXRXb3JsZEV4dGVudCIsInNldEV4dGVudCIsImxheWVyTmFtZSIsIk9iamVjdCIsImtleXMiLCJpbmNsdWRlcyIsImwiLCJpZHgiLCJ2ZWN0b3JGZWF0dXJlIiwiZ2V0UHJvcGVydGllcyIsImxheWVyIiwicmVhZFByb2plY3Rpb24iLCJtb25vIiwibXVsdGkiLCJzcWxodHRwIiwiTUJUaWxlc1NvdXJjZSIsInVuZGVmaW5lZCIsImZvcm1hdCIsInRpbGVVcmxGdW5jdGlvbiIsImNvb3JkcyIsInNldFRpbGVMb2FkRnVuY3Rpb24iLCJ0aWxlTG9hZGVyIiwiYmluZCIsImNvbmZpZyIsImZyb20iLCJzZXJ2ZXJNb2RlIiwicmVxdWVzdENodW5rU2l6ZSIsIndvcmtlciIsInNxbFdvcmtlcnMiLCJjcmVhdGVEYldvcmtlciIsIndvcmtlclVybCIsInRvU3RyaW5nIiwid2FzbVVybCIsIm1heFNpbmdsZVRyYW5zZmVyIiwiY3VycmVudFdvcmtlciIsIm1ldGFkYXRhIiwidGhlbiIsInciLCJkYiIsInF1ZXJ5IiwiciIsImRhdGEiLCJyZWR1Y2UiLCJhIiwiY29uc29sZSIsImRlYnVnIiwibWF4em9vbSIsIm1pbnpvb20iLCJ3YXJuIiwiRXJyb3IiLCJjYXRjaCIsImUiLCJfdXJsIiwidGlsZUNvb3JkIiwic2V0TG9hZGVyIiwicmVzb2x1dGlvbiIsInByb2plY3Rpb24iLCJnZXRGb3JtYXQiLCJmZWF0dXJlUHJvamVjdGlvbiIsInNldEZlYXR1cmVzIiwib25Mb2FkIiwib25FcnJvciIsImRlc3Ryb3kiLCJyZWxlYXNlIiwiVVJMIl0sInNvdXJjZVJvb3QiOiIifQ==
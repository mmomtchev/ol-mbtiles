"use strict";(self.webpackChunkol_mbtiles=self.webpackChunkol_mbtiles||[]).push([[491],{9491:(e,t,o)=>{o.r(t),o.d(t,{default:()=>h});var n=o(8854),r=o(2479),i=o(9090),l=o(9731),s=o(6263),a=o(8661),d=o(5686),c=o(5917),u=function(e,t,o,n){return new(o||(o=Promise))((function(r,i){function l(e){try{a(n.next(e))}catch(e){i(e)}}function s(e){try{a(n.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(l,s)}a((n=n.apply(e,t||[])).next())}))};function h(){return u(this,void 0,void 0,(function*(){return new n.Z({target:"map",layers:[new r.Z({source:new s.Z}),new l.Z({source:new d.H5(yield(0,d.ri)({url:"https://velivole.b-cdn.net/maptiler-osm-2017-07-03-v3.6.1-europe.mbtiles",layers:["transportation","water","waterway","landuse","place","boundary"],attributions:["MapTiler","OSM","https://data.maptiler.com/downloads/dataset/osm/europe/"]})),style:function(e){switch(e.get("layer")){case"water":case"waterway":return c.d_;case"transportation":return(0,c.xl)(e);case"landuse":return c.Xu;case"boundary":return c.oj;case"place":return(0,c.Hh)(e);default:return null}}})],view:new i.ZP({center:(0,a.mi)([12,50]),zoom:6})})}))}},5917:(e,t,o)=>{o.d(t,{Hh:()=>y,Xu:()=>h,d_:()=>w,kY:()=>d,oj:()=>p,xl:()=>m,y8:()=>a});var n=o(7539),r=o(283),i=o(1345),l=o(8958),s=o(1280);function a(e,t){let o,a;switch(e){case 0:o=6,a="2em";break;case 1:o=5,a="1.2em";break;case 2:o=3,a="0.8em";break;default:o=1,a="0.5em"}a+=" helvetica, sans-serif";const d="#00007f";return new n.ZP({image:new r.Z({fill:new i.Z({color:d}),radius:o,stroke:new l.Z({color:d,width:o})}),text:new s.Z({font:a,text:t.get("n"),fill:new i.Z({color:"#ffffff"}),stroke:new l.Z({color:d,width:2})})})}const d=new n.ZP({stroke:new l.Z({color:"blue",width:2})}),c={},u={motorway:"#776",trunk:"#ccb",highway:"#f39"},h=new n.ZP({fill:new i.Z({color:"#666"}),stroke:new l.Z({color:"#444",width:1})}),w=new n.ZP({fill:new i.Z({color:"#9db9e8"})}),p=new n.ZP({stroke:new l.Z({color:"#8B008B",width:2})}),m=function(e){const t=e.get("class"),o=e.get("railway"),r=e.get("sort_key"),i=t+"/"+o+"/"+r;let s=c[i];if(!s){let e,a;o?(e="#7de",a=1):(e=u[t],a="highway"==t?1.5:1),s=new n.ZP({stroke:new l.Z({color:e,width:a}),zIndex:r}),c[i]=s}return s},f=new n.ZP({image:new r.Z({radius:5,fill:new i.Z({color:"#000080"})})}),v=new l.Z({color:"white",width:2}),y=function(e){if("country"==e.get("class"))return null;if(e.get("name")){const t=f.clone();return t.setText(new s.Z({text:e.get("name"),offsetY:-5,font:"bold 16px sans-serif",stroke:v})),t}return null}},5686:(e,t,o)=>{o.d(t,{Yr:()=>E,H5:()=>x,ri:()=>u});var n,r=o(9759),i=o(8661),l=o(8641),s=o(8738);const a="undefined"!=typeof OL_MBTILES_DEBUG&&OL_MBTILES_DEBUG||"undefined"!=typeof process&&void 0!==(null===(n=null===process||void 0===process?void 0:process.env)||void 0===n?void 0:n.OL_MBTILES_DEBUG)&&process.env.OL_MBTILES_DEBUG?console.debug.bind(console):()=>{},d={jpg:"raster",png:"raster",webp:"raster",pbf:"vector",mvt:"vector"};function c(e){var t,o,n;return{workers:null!==(t=null==e?void 0:e.sqlWorkers)&&void 0!==t?t:4,httpOptions:{maxPageSize:null!==(o=null==e?void 0:e.maxSqlPageSize)&&void 0!==o?o:4096,cacheSize:null!==(n=null==e?void 0:e.sqlCacheSize)&&void 0!==n?n:4096}}}function u(e){const t=(0,r.he)(c(e)).then((t=>t.open(e.url).then((()=>t))));return t.then((e=>e.exec("SELECT name,value FROM metadata"))).then((e=>{if(e&&e.length){const t=e.reduce(((e,t)=>(e[t.row[0]]=t.row[1],e)),{});return a("Loaded metadata",t),t}throw new Error("Could not load metadata")})).then((o=>{var n,r,a,c,u,h,w,p;const m=Object.assign({},e),f=null===(r=null===(n=o.format)||void 0===n?void 0:n.toLowerCase)||void 0===r?void 0:r.call(n);d[f]||console.warn("Unknown tile format",f),m.projection=null!==(a=e.projection)&&void 0!==a?a:"EPSG:3857",m.attributions=null!==(c=o.attribution)&&void 0!==c?c:o.description,m.maxZoom=null!==(u=e.maxZoom)&&void 0!==u?u:+o.maxzoom,m.minZoom=null!==(h=e.minZoom)&&void 0!==h?h:+o.minzoom;const v=null===(p=null===(w=(0,i.U2)(m.projection))||void 0===w?void 0:w.getExtent)||void 0===p?void 0:p.call(w),y=o.bounds,g=y?(0,i.$A)(y.split(",").map((e=>+e)),"EPSG:4326",m.projection):v;if("raster"===d[f]){if(void 0===m.maxZoom||void 0===m.minZoom||void 0===v)throw new Error("Cannot determine tilegrid, need minZoom, maxZoom");const e=[(0,l.dz)(v)/256];for(let t=1;t<=m.maxZoom;t++)e.push(e[e.length-1]/2);m.tileGrid=new s.Z({origin:[v[0],v[2]],extent:g,minZoom:m.minZoom,resolutions:e})}else m.extent=v;return m.pool=t,m.url=e.url,m}))}var h=o(7205),w=o(3614),p=o.n(w),m=o(8929),f=o(7885),v=o(9646),y=o(9619),g=o(3433);class Z extends v.ZP{constructor(e){var t,o,n;super(),e=e||{},this.dataProjection=new y.Z({code:"",units:"tile-pixels"}),this.featureClass_=e.featureClass?e.featureClass:g.ZP,this.geometryName_=null!==(t=e.geometryName)&&void 0!==t?t:"Geometry",this.layers_=null!==(o=e.layers)&&void 0!==o?o:null,this.idProperty_=e.idProperty,this.extent=null!==(n=e.extent)&&void 0!==n?n:4096,this.supportedMediaTypes=["application/vnd-mbtiles"]}readFeature(e,t){const o=e.properties;let n;this.idProperty_?(n=o[this.idProperty_],delete o[this.idProperty_]):n=e.id;const r=e.loadGeometry(),i=[],l=[],s=Z.MBTypes[r.length>1?"multi":"mono"][e.type];if("Unknown"===s)return null;for(let e=0;e<r.length;e++)if(0!=r[e].length){for(let t=0;t<r[e].length;t++)i.push(r[e][t].x,r[e][t].y);l.push(i.length)}const a=new this.featureClass_(s,i,l,o,n);return a.transform(null==t?void 0:t.dataProjection),a}readFeatures(e,t){const o=this.layers_,n=[],r=new m.VectorTile(new(p())(f.ZP.ungzip(e)));t=this.adaptOptions(t);const l=(0,i.U2)(null==t?void 0:t.dataProjection),s=null==t?void 0:t.extent;if(!l||!t||!s)throw new Error("Cannot determine the projection/extent");l.setWorldExtent(s),l.setExtent([0,0,this.extent,this.extent]),t.dataProjection=l;for(const e of Object.keys(r.layers)){if(o&&!o.includes(e))continue;const i=r.layers[e];for(let o=0;o<i.length;o++){const r=i.feature(o),l=this.readFeature(r,t);l.getProperties().layer=e,n.push(l)}}return n}readProjection(){return this.dataProjection}}Z.MBTypes={mono:["Unknown","Point","LineString","Polygon"],multi:["Unknown","MultiPoint","MultiLineString","Polygon"]};class x extends h.Z{constructor(e){var t;if(void 0===e.url&&void 0===e.pool)throw new Error("Must specify url");super(Object.assign(Object.assign({},e),{url:void 0,format:new Z({layers:e.layers}),tileUrlFunction:t=>`${e.url}#${t[0]}:${t[1]}:${t[2]}`})),this.setTileLoadFunction(this.tileLoader.bind(this)),this.pool=null!==(t=e.pool)&&void 0!==t?t:(0,r.he)(c(e)).then((t=>t.open(e.url).then((()=>t))))}tileLoader(e,t){const o=e;a("loading tile",[o.tileCoord[0],o.tileCoord[1],o.tileCoord[2]]),o.setLoader(((e,t,n)=>{this.pool.then((e=>e.exec("SELECT tile_data FROM tiles WHERE zoom_level = $zoom AND tile_column = $col AND tile_row = $row",{$zoom:o.tileCoord[0],$col:o.tileCoord[1],$row:(1<<o.tileCoord[0])-1-o.tileCoord[2]}))).then((t=>{if(t&&t[0]&&t[0].row[0]){const r=o.getFormat().readFeatures(t[0].row[0],{extent:e,featureProjection:n});return o.setFeatures(r),void o.onLoad(r,n)}throw new Error(`No data for ${o.tileCoord}`)})).catch((e=>{a(e),o.onError()}))}))}disposeInternal(){return this.pool.then((e=>e.close()))}}var b=o(928),P=o(7195);class E extends b.Z{constructor(e){var t;if(void 0===e.url&&void 0===e.pool)throw new Error("Must specify url");super(Object.assign(Object.assign({},e),{url:void 0,tileUrlFunction:t=>`${e.url}#${t[0]}:${t[1]}:${t[2]}`})),this.setTileLoadFunction(this.tileLoader.bind(this)),this.pool=null!==(t=e.pool)&&void 0!==t?t:(0,r.he)(c(e)).then((t=>t.open(e.url).then((()=>t))))}tileLoader(e,t){a("loading tile",[e.tileCoord[0],e.tileCoord[1],e.tileCoord[2]]);const o=e.getImage();this.pool.then((t=>t.exec("SELECT tile_data FROM tiles WHERE zoom_level = $zoom AND tile_column = $col AND tile_row = $row",{$zoom:e.tileCoord[0],$col:e.tileCoord[1],$row:(1<<e.tileCoord[0])-1-e.tileCoord[2]}))).then((t=>{if(!(t&&t[0]&&t[0].row[0]instanceof Uint8Array))throw new Error(`No data for ${e.tileCoord}`);{const e=new Blob([t[0].row[0]]),n=URL.createObjectURL(e);o.src=n}})).catch((t=>{a(t),e.setState(P.Z.ERROR)}))}disposeInternal(){return this.pool.then((e=>e.close()))}}}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFZdUIsR0FDN0I3RyxFQUFNLGVBQWdCLENBQUNzRixFQUFLd0IsVUFBVSxHQUFJeEIsRUFBS3dCLFVBQVUsR0FBSXhCLEVBQUt3QixVQUFVLEtBQzVFLE1BQU10SSxFQUFTOEcsRUFBbUJ3QyxXQUNsQ3BFLEtBQUt4QyxLQUNGQyxNQUFNRSxHQUNMQSxFQUFFQyxLQUNBLGtHQUNBLENBQ0UyRixNQUFPM0IsRUFBS3dCLFVBQVUsR0FDdEJJLEtBQU01QixFQUFLd0IsVUFBVSxHQUNyQkssTUFBTyxHQUFLN0IsRUFBS3dCLFVBQVUsSUFBTSxFQUFJeEIsRUFBS3dCLFVBQVUsT0FHekQzRixNQUFNSSxJQUNMLEtBQUlBLEdBQUtBLEVBQUUsSUFDTEEsRUFBRSxHQUFHTSxJQUFJLGFBQWNrRyxZQU83QixNQUFNLElBQUlqRyxNQUFNLGVBQWV3RCxFQUFLd0IsYUFScEMsQ0FFSSxNQUFNa0IsRUFBTyxJQUFJQyxLQUFLLENBQUMxRyxFQUFFLEdBQUdNLElBQUksS0FDMUJxRyxFQUFXQyxJQUFJQyxnQkFBZ0JKLEdBQ3JDeEosRUFBTTZKLElBQU1ILEMsQ0FJZ0MsSUFFakRWLE9BQU9DLElBQ056SCxFQUFNeUgsR0FDTm5DLEVBQUtnRCxTQUFTQyxFQUFBLFFBQWdCLEdBRXBDLENBRUFaLGtCQUNFLE9BQU9qRSxLQUFLeEMsS0FBS0MsTUFBTUUsR0FBTUEsRUFBRXVHLFNBQ2pDLEUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9vbC1tYnRpbGVzLy4vZXhhbXBsZXMvY29kZS9vc20tdmVjdG9yLXRpbGVzLnRzIiwid2VicGFjazovL29sLW1idGlsZXMvLi9leGFtcGxlcy9zdHlsZS50cyIsIndlYnBhY2s6Ly9vbC1tYnRpbGVzLy4vc3JjL2RlYnVnLnRzIiwid2VicGFjazovL29sLW1idGlsZXMvLi9zcmMvbWJ0aWxlcy50cyIsIndlYnBhY2s6Ly9vbC1tYnRpbGVzLy4vc3JjL21idGlsZXMtZm9ybWF0LnRzIiwid2VicGFjazovL29sLW1idGlsZXMvLi9zcmMvbWJ0aWxlcy12ZWN0b3Itc291cmNlLnRzIiwid2VicGFjazovL29sLW1idGlsZXMvLi9zcmMvbWJ0aWxlcy1yYXN0ZXItc291cmNlLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBNYXAgZnJvbSAnb2wvTWFwLmpzJztcbmltcG9ydCBUaWxlTGF5ZXIgZnJvbSAnb2wvbGF5ZXIvVGlsZS5qcyc7XG5pbXBvcnQgVmlldyBmcm9tICdvbC9WaWV3LmpzJztcbmltcG9ydCBWZWN0b3JUaWxlTGF5ZXIgZnJvbSAnb2wvbGF5ZXIvVmVjdG9yVGlsZSc7XG5pbXBvcnQgVGlsZURlYnVnIGZyb20gJ29sL3NvdXJjZS9UaWxlRGVidWcnO1xuaW1wb3J0IHsgZnJvbUxvbkxhdCB9IGZyb20gJ29sL3Byb2onO1xuaW1wb3J0IFN0eWxlIGZyb20gJ29sL3N0eWxlL1N0eWxlJztcbmltcG9ydCB7IEZlYXR1cmVMaWtlIH0gZnJvbSAnb2wvRmVhdHVyZSc7XG5cbmltcG9ydCB7IGltcG9ydE1CVGlsZXMsIE1CVGlsZXNWZWN0b3JTb3VyY2UgfSBmcm9tICdvbC1tYnRpbGVzJztcbmltcG9ydCB7IHdhdGVyU3R5bGUsIHJvYWRTdHlsZSwgYnVpbGRpbmdTdHlsZSwgYm91bmRhcnlTdHlsZSwgcGxhY2VTdHlsZSB9IGZyb20gJy4uL3N0eWxlJztcblxuLy8gTUJUaWxlcyBmcm9tXG4vLyBodHRwczovL2RhdGEubWFwdGlsZXIuY29tL2Rvd25sb2Fkcy9kYXRhc2V0L29zbS9ldXJvcGUvXG4vLyAzNC40IEdCIG9yaWdpbmFsIGZpbGVcbi8vIGRvd24gdG8gMTkuMkdCIGFmdGVyIHZhY3V1bSAoTWFwVGlsZXIsIHd0Zj8pXG5cbmV4cG9ydCBkZWZhdWx0IGFzeW5jIGZ1bmN0aW9uICgpIHtcbiAgcmV0dXJuIG5ldyBNYXAoe1xuICAgIHRhcmdldDogJ21hcCcsXG4gICAgbGF5ZXJzOiBbXG4gICAgICBuZXcgVGlsZUxheWVyKHtcbiAgICAgICAgc291cmNlOiBuZXcgVGlsZURlYnVnKClcbiAgICAgIH0pLFxuICAgICAgbmV3IFZlY3RvclRpbGVMYXllcih7XG4gICAgICAgIHNvdXJjZTogbmV3IE1CVGlsZXNWZWN0b3JTb3VyY2UoYXdhaXQgaW1wb3J0TUJUaWxlcyh7XG4gICAgICAgICAgdXJsOiAnaHR0cHM6Ly92ZWxpdm9sZS5iLWNkbi5uZXQvbWFwdGlsZXItb3NtLTIwMTctMDctMDMtdjMuNi4xLWV1cm9wZS5tYnRpbGVzJyxcbiAgICAgICAgICBsYXllcnM6IFsndHJhbnNwb3J0YXRpb24nLCAnd2F0ZXInLCAnd2F0ZXJ3YXknLCAnbGFuZHVzZScsICdwbGFjZScsICdib3VuZGFyeSddLFxuICAgICAgICAgIC8vIEFsbCBwcm9wZXJ0aWVzIGZyb20gdGhlIE1CVGlsZXMgZGF0YSBjYW4gYmUgb3ZlcnJpZGRlblxuICAgICAgICAgIGF0dHJpYnV0aW9uczogWydNYXBUaWxlcicsICdPU00nLCAnaHR0cHM6Ly9kYXRhLm1hcHRpbGVyLmNvbS9kb3dubG9hZHMvZGF0YXNldC9vc20vZXVyb3BlLyddLFxuICAgICAgICB9KSksXG4gICAgICAgIHN0eWxlOiBmdW5jdGlvbiAoZmVhdHVyZTogRmVhdHVyZUxpa2UpOiBTdHlsZSB7XG4gICAgICAgICAgc3dpdGNoIChmZWF0dXJlLmdldCgnbGF5ZXInKSkge1xuICAgICAgICAgICAgY2FzZSAnd2F0ZXInOlxuICAgICAgICAgICAgY2FzZSAnd2F0ZXJ3YXknOlxuICAgICAgICAgICAgICByZXR1cm4gd2F0ZXJTdHlsZTtcbiAgICAgICAgICAgIGNhc2UgJ3RyYW5zcG9ydGF0aW9uJzpcbiAgICAgICAgICAgICAgcmV0dXJuIHJvYWRTdHlsZShmZWF0dXJlKTtcbiAgICAgICAgICAgIGNhc2UgJ2xhbmR1c2UnOlxuICAgICAgICAgICAgICByZXR1cm4gYnVpbGRpbmdTdHlsZTtcbiAgICAgICAgICAgIGNhc2UgJ2JvdW5kYXJ5JzpcbiAgICAgICAgICAgICAgcmV0dXJuIGJvdW5kYXJ5U3R5bGU7XG4gICAgICAgICAgICBjYXNlICdwbGFjZSc6XG4gICAgICAgICAgICAgIHJldHVybiBwbGFjZVN0eWxlKGZlYXR1cmUpO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgcmV0dXJuIG51bGwgYXMgdW5rbm93biBhcyBTdHlsZTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pXG4gICAgXSxcbiAgICB2aWV3OiBuZXcgVmlldyh7XG4gICAgICBjZW50ZXI6IGZyb21Mb25MYXQoWzEyLCA1MF0pLFxuICAgICAgem9vbTogNlxuICAgIH0pLFxuICB9KTtcbn0iLCJpbXBvcnQgeyBGZWF0dXJlTGlrZSB9IGZyb20gJ29sL0ZlYXR1cmUnO1xuaW1wb3J0IHsgU3R5bGUsIFRleHQsIEZpbGwsIFN0cm9rZSwgQ2lyY2xlIH0gZnJvbSAnb2wvc3R5bGUnO1xuXG5leHBvcnQgZnVuY3Rpb24gc3R5bGVUb3duKHNpemU6IG51bWJlciwgZmVhdHVyZTogRmVhdHVyZUxpa2UpOiBTdHlsZSB7XG4gIGxldCB3aWR0aDogbnVtYmVyO1xuICBsZXQgZm9udDogc3RyaW5nO1xuICBzd2l0Y2ggKHNpemUpIHtcbiAgICBjYXNlIDA6XG4gICAgICB3aWR0aCA9IDY7XG4gICAgICBmb250ID0gJzJlbSc7XG4gICAgICBicmVhaztcbiAgICBjYXNlIDE6XG4gICAgICB3aWR0aCA9IDU7XG4gICAgICBmb250ID0gJzEuMmVtJztcbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgMjpcbiAgICAgIHdpZHRoID0gMztcbiAgICAgIGZvbnQgPSAnMC44ZW0nO1xuICAgICAgYnJlYWs7XG4gICAgZGVmYXVsdDpcbiAgICAgIHdpZHRoID0gMTtcbiAgICAgIGZvbnQgPSAnMC41ZW0nO1xuICAgICAgYnJlYWs7XG4gIH1cbiAgZm9udCArPSAnIGhlbHZldGljYSwgc2Fucy1zZXJpZic7XG4gIGNvbnN0IGNvbG9yMSA9ICcjMDAwMDdmJztcbiAgY29uc3QgY29sb3IyID0gJyNmZmZmZmYnO1xuXG4gIGNvbnN0IHN0eWxlID0gbmV3IFN0eWxlKHtcbiAgICBpbWFnZTogbmV3IENpcmNsZSh7XG4gICAgICBmaWxsOiBuZXcgRmlsbCh7XG4gICAgICAgIGNvbG9yOiBjb2xvcjEsXG4gICAgICB9KSxcbiAgICAgIHJhZGl1czogd2lkdGgsXG4gICAgICBzdHJva2U6IG5ldyBTdHJva2Uoe1xuICAgICAgICBjb2xvcjogY29sb3IxLFxuICAgICAgICB3aWR0aDogd2lkdGgsXG4gICAgICB9KSxcbiAgICB9KSxcbiAgICB0ZXh0OiBuZXcgVGV4dCh7XG4gICAgICBmb250OiBmb250LFxuICAgICAgdGV4dDogZmVhdHVyZS5nZXQoJ24nKSxcbiAgICAgIGZpbGw6IG5ldyBGaWxsKHtcbiAgICAgICAgY29sb3I6IGNvbG9yMlxuICAgICAgfSksXG4gICAgICBzdHJva2U6IG5ldyBTdHJva2Uoe1xuICAgICAgICBjb2xvcjogY29sb3IxLFxuICAgICAgICB3aWR0aDogMlxuICAgICAgfSlcbiAgICB9KVxuICB9KTtcbiAgcmV0dXJuIHN0eWxlO1xufVxuXG5leHBvcnQgY29uc3Qgc3R5bGVCb3JkZXIgPSBuZXcgU3R5bGUoe1xuICBzdHJva2U6IG5ldyBTdHJva2Uoe1xuICAgIGNvbG9yOiAnYmx1ZScsXG4gICAgd2lkdGg6IDJcbiAgfSlcbn0pO1xuXG5cbi8vIFN0eWxlcyBpbnNwaXJlZCBmcm9tIGh0dHBzOi8vb3BlbmxheWVycy5vcmcvZW4vbGF0ZXN0L2V4YW1wbGVzL29zbS12ZWN0b3ItdGlsZXMuaHRtbFxuY29uc3Qgcm9hZFN0eWxlQ2FjaGU6IFJlY29yZDxzdHJpbmcsIFN0eWxlPiA9IHt9O1xuY29uc3Qgcm9hZENvbG9yOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge1xuICAnbW90b3J3YXknOiAnIzc3NicsXG4gICd0cnVuayc6ICcjY2NiJyxcbiAgJ2hpZ2h3YXknOiAnI2YzOScsXG59O1xuZXhwb3J0IGNvbnN0IGJ1aWxkaW5nU3R5bGUgPSBuZXcgU3R5bGUoe1xuICBmaWxsOiBuZXcgRmlsbCh7XG4gICAgY29sb3I6ICcjNjY2J1xuICB9KSxcbiAgc3Ryb2tlOiBuZXcgU3Ryb2tlKHtcbiAgICBjb2xvcjogJyM0NDQnLFxuICAgIHdpZHRoOiAxLFxuICB9KSxcbn0pO1xuZXhwb3J0IGNvbnN0IHdhdGVyU3R5bGUgPSBuZXcgU3R5bGUoe1xuICBmaWxsOiBuZXcgRmlsbCh7XG4gICAgY29sb3I6ICcjOWRiOWU4JyxcbiAgfSksXG59KTtcbmV4cG9ydCBjb25zdCBib3VuZGFyeVN0eWxlID0gbmV3IFN0eWxlKHtcbiAgc3Ryb2tlOiBuZXcgU3Ryb2tlKHtcbiAgICBjb2xvcjogJyM4QjAwOEInLFxuICAgIHdpZHRoOiAyLFxuICB9KSxcbn0pO1xuZXhwb3J0IGNvbnN0IHJvYWRTdHlsZSA9IGZ1bmN0aW9uIChmZWF0dXJlOiBGZWF0dXJlTGlrZSkge1xuICBjb25zdCBraW5kID0gZmVhdHVyZS5nZXQoJ2NsYXNzJyk7XG4gIGNvbnN0IHJhaWx3YXkgPSBmZWF0dXJlLmdldCgncmFpbHdheScpO1xuICBjb25zdCBzb3J0X2tleSA9IGZlYXR1cmUuZ2V0KCdzb3J0X2tleScpO1xuICBjb25zdCBzdHlsZUtleSA9IGtpbmQgKyAnLycgKyByYWlsd2F5ICsgJy8nICsgc29ydF9rZXk7XG4gIGxldCBzdHlsZSA9IHJvYWRTdHlsZUNhY2hlW3N0eWxlS2V5XTtcbiAgaWYgKCFzdHlsZSkge1xuICAgIGxldCBjb2xvciwgd2lkdGg7XG4gICAgaWYgKHJhaWx3YXkpIHtcbiAgICAgIGNvbG9yID0gJyM3ZGUnO1xuICAgICAgd2lkdGggPSAxO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb2xvciA9IHJvYWRDb2xvcltraW5kXTtcbiAgICAgIHdpZHRoID0ga2luZCA9PSAnaGlnaHdheScgPyAxLjUgOiAxO1xuICAgIH1cbiAgICBzdHlsZSA9IG5ldyBTdHlsZSh7XG4gICAgICBzdHJva2U6IG5ldyBTdHJva2Uoe1xuICAgICAgICBjb2xvcjogY29sb3IsXG4gICAgICAgIHdpZHRoOiB3aWR0aCxcbiAgICAgIH0pLFxuICAgICAgekluZGV4OiBzb3J0X2tleSxcbiAgICB9KTtcbiAgICByb2FkU3R5bGVDYWNoZVtzdHlsZUtleV0gPSBzdHlsZTtcbiAgfVxuICByZXR1cm4gc3R5bGU7XG59O1xuY29uc3QgcGxhY2VCYXNlID0gbmV3IFN0eWxlKHtcbiAgaW1hZ2U6IG5ldyBDaXJjbGUoe1xuICAgIHJhZGl1czogNSxcbiAgICBmaWxsOiBuZXcgRmlsbCh7XG4gICAgICBjb2xvcjogJyMwMDAwODAnXG4gICAgfSlcbiAgfSlcbn0pO1xuY29uc3QgdGV4dFN0cm9rZSA9IG5ldyBTdHJva2Uoe1xuICBjb2xvcjogJ3doaXRlJyxcbiAgd2lkdGg6IDJcbn0pO1xuZXhwb3J0IGNvbnN0IHBsYWNlU3R5bGUgPSBmdW5jdGlvbiAoZmVhdHVyZTogRmVhdHVyZUxpa2UpOiBTdHlsZSB7XG4gIGlmIChmZWF0dXJlLmdldCgnY2xhc3MnKSA9PSAnY291bnRyeScpXG4gICAgcmV0dXJuIG51bGwgYXMgdW5rbm93biBhcyBTdHlsZTtcbiAgaWYgKGZlYXR1cmUuZ2V0KCduYW1lJykpIHtcbiAgICBjb25zdCBzdHlsZSA9IHBsYWNlQmFzZS5jbG9uZSgpO1xuICAgIHN0eWxlLnNldFRleHQobmV3IFRleHQoe1xuICAgICAgdGV4dDogZmVhdHVyZS5nZXQoJ25hbWUnKSxcbiAgICAgIG9mZnNldFk6IC01LFxuICAgICAgZm9udDogJ2JvbGQgMTZweCBzYW5zLXNlcmlmJyxcbiAgICAgIHN0cm9rZTogdGV4dFN0cm9rZVxuICAgIH0pKTtcbiAgICByZXR1cm4gc3R5bGU7XG4gIH1cbiAgcmV0dXJuIG51bGwgYXMgdW5rbm93biBhcyBTdHlsZTtcbn07IiwiZGVjbGFyZSBjb25zdCBPTF9NQlRJTEVTX0RFQlVHOiBzdHJpbmc7XG5jb25zdCBkZWJ1Z0VuYWJsZWQgPSAodHlwZW9mIE9MX01CVElMRVNfREVCVUcgIT09ICd1bmRlZmluZWQnICYmIE9MX01CVElMRVNfREVCVUcpIHx8XG4gICh0eXBlb2YgcHJvY2VzcyAhPT0gJ3VuZGVmaW5lZCcgJiYgdHlwZW9mIHByb2Nlc3M/LmVudj8uT0xfTUJUSUxFU19ERUJVRyAhPT0gJ3VuZGVmaW5lZCcgJiYgcHJvY2Vzcy5lbnYuT0xfTUJUSUxFU19ERUJVRyk7XG5cbmV4cG9ydCBjb25zdCBkZWJ1ZyA9IGRlYnVnRW5hYmxlZCA/IGNvbnNvbGUuZGVidWcuYmluZChjb25zb2xlKSA6ICgpID0+IHVuZGVmaW5lZDtcbiIsImltcG9ydCB7IGNyZWF0ZVNRTGl0ZUhUVFBQb29sLCBTUUxpdGVIVFRQUG9vbCwgVkZTSFRUUCB9IGZyb20gJ3NxbGl0ZS13YXNtLWh0dHAnO1xuXG5pbXBvcnQgeyBPcHRpb25zIGFzIEltYWdlVGlsZU9wdGlvbnMgfSBmcm9tICdvbC9zb3VyY2UvVGlsZUltYWdlLmpzJztcbmltcG9ydCB7IE9wdGlvbnMgYXMgVmVjdG9yVGlsZU9wdGlvbnMgfSBmcm9tICdvbC9zb3VyY2UvVmVjdG9yVGlsZS5qcyc7XG5pbXBvcnQgeyBnZXQgYXMgZ2V0UHJvamVjdGlvbiwgdHJhbnNmb3JtRXh0ZW50IH0gZnJvbSAnb2wvcHJvai5qcyc7XG5pbXBvcnQgeyBnZXRXaWR0aCB9IGZyb20gJ29sL2V4dGVudC5qcyc7XG5pbXBvcnQgVGlsZUdyaWQgZnJvbSAnb2wvdGlsZWdyaWQvVGlsZUdyaWQuanMnO1xuaW1wb3J0IHsgZGVidWcgfSBmcm9tICcuL2RlYnVnJztcblxuLyoqXG4gKiBPcHRpb25zIGZvciBjcmVhdGluZyBhIE1CVGlsZXNSYXN0ZXJTb3VyY2VcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBNQlRpbGVzUmFzdGVyT3B0aW9ucyBleHRlbmRzIEltYWdlVGlsZU9wdGlvbnMge1xuICAvKipcbiAgICogTnVtYmVyIG9mIHBhcmFsbGVsIHdvcmtlcnMgdG8gdXNlIGZvciByZXRyaWV2aW5nIHRpbGVzLCBAZGVmYXVsdCA0XG4gICAqL1xuICBzcWxXb3JrZXJzPzogbnVtYmVyO1xuICAvKipcbiAgICogTGlzdCBvZiBsYXllciBuYW1lcyB0byBzZWxlY3RpdmVseSBpbmNsdWRlLCBAZGVmYXVsdCBldmVyeXRoaW5nXG4gICAqL1xuICBsYXllcnM/OiBzdHJpbmdbXTtcblxuICB0aWxlVXJsRnVuY3Rpb24/OiBuZXZlcjtcbiAgdGlsZUxvYWRGdW5jdGlvbj86IG5ldmVyO1xuXG4gIC8qKlxuICAgKiBBbHRlcm5hdGl2ZSBtZXRob2Qgb2Ygc3BlY2lmeWluZyBtaW5ab29tLCBtdXR1YWxseSBleGNsdXNpdmUgd2l0aCB0aWxlR3JpZCwgcmVxdWlyZXMgZXhwbGljaXQgcHJvamVjdGlvblxuICAgKi9cbiAgbWluWm9vbT86IG51bWJlcjtcblxuICAvKipcbiAgICogQWx0ZXJuYXRpdmUgbWV0aG9kIG9mIHNwZWNpZnlpbmcgbWluWm9vbSwgbXV0dWFsbHkgZXhjbHVzaXZlIHdpdGggdGlsZUdyaWQsIHJlcXVpcmVzIGV4cGxpY2l0IHByb2plY3Rpb25cbiAgICovXG4gIG1heFpvb20/OiBudW1iZXI7XG5cbiAgLyoqXG4gICAqIE9wdGlvbmFsIHRpbGUgZ3JpZCwgcmVmZXIgdG8gdGhlIE9wZW5sYXllcnMgbWFudWFsXG4gICAqL1xuICB0aWxlR3JpZD86IFRpbGVHcmlkO1xuXG4gIC8qKlxuICAgKiBPcHRpb25hbCBhbHJlYWR5IG9wZW4gU1FMaXRlSFRUUCBwb29sIChtdXR1YWxseSBleGNsdXNpdmUgd2l0aCB1cmwpXG4gICAqL1xuICBwb29sPzogUHJvbWlzZTxTUUxpdGVIVFRQUG9vbD47XG59XG5cbi8qKlxuICogT3B0aW9ucyBmb3IgY3JlYXRpbmcgYSBNQlRpbGVzVmVjdG9yU291cmNlXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgTUJUaWxlc1ZlY3Rvck9wdGlvbnMgZXh0ZW5kcyBWZWN0b3JUaWxlT3B0aW9ucyB7XG4gIC8qKlxuICAgKiBOdW1iZXIgb2YgcGFyYWxsZWwgd29ya2VycyB0byB1c2UgZm9yIHJldHJpZXZpbmcgdGlsZXMsIEBkZWZhdWx0IDRcbiAgICovXG4gIHNxbFdvcmtlcnM/OiBudW1iZXI7XG4gIC8qKlxuICAgKiBMaXN0IG9mIGxheWVyIG5hbWVzIHRvIHNlbGVjdGl2ZWx5IGluY2x1ZGUsIEBkZWZhdWx0IGV2ZXJ5dGhpbmdcbiAgICovXG4gIGxheWVycz86IHN0cmluZ1tdO1xuXG4gIC8qKlxuICAgKiBPcHRpb25hbCBhbHJlYWR5IG9wZW4gU1FMaXRlSFRUUCBwb29sIChtdXR1YWxseSBleGNsdXNpdmUgd2l0aCB1cmwpXG4gICAqL1xuICBwb29sPzogUHJvbWlzZTxTUUxpdGVIVFRQUG9vbD47XG5cbiAgdGlsZVVybEZ1bmN0aW9uPzogbmV2ZXI7XG4gIHRpbGVMb2FkRnVuY3Rpb24/OiBuZXZlcjtcbiAgZm9ybWF0PzogbmV2ZXI7XG59XG5cbi8qKlxuICogU2hhcmVkIG9wdGlvbnMgZm9yIGFsbCBNQlRpbGVzXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgU1FMT3B0aW9ucyB7XG4gIC8qKlxuICAgKiBVUkwgb2YgdGhlIHJlbW90ZSBNQlRpbGVzIHNvdXJjZVxuICAgKi9cbiAgdXJsOiBzdHJpbmc7XG4gIC8qKlxuICAgKiBOdW1iZXIgb2YgcGFyYWxsZWwgd29ya2VycyB0byB1c2UgZm9yIHJldHJpZXZpbmcgdGlsZXMsIEBkZWZhdWx0IDRcbiAgICovXG4gIHNxbFdvcmtlcnM/OiBudW1iZXI7XG5cbiAgLyoqXG4gICAqIE1heGltdW0gZXhwZWN0ZWQgcGFnZSBzaXplIGluIGJ5dGVzIGZvciBTUUxpdGUzIGZpbGVzLCBAZGVmYXVsdCA0MDk2XG4gICAqL1xuICBtYXhTcWxQYWdlU2l6ZT86IG51bWJlcjtcblxuICAvKipcbiAgICogTWVtb3J5IHRvIHVzZSBmb3IgU1FMaXRlIGNhY2hlIGluIEtCLCBAZGVmYXVsdCA0MDk2XG4gICAqL1xuICBzcWxDYWNoZVNpemU/OiBudW1iZXI7XG59XG5cbmV4cG9ydCB0eXBlIE1CVGlsZXNPcHRpb25zID0gTUJUaWxlc1ZlY3Rvck9wdGlvbnMgfCBNQlRpbGVzUmFzdGVyT3B0aW9ucztcblxuY29uc3QgZm9ybWF0czogUmVjb3JkPHN0cmluZywgJ3Jhc3RlcicgfCAndmVjdG9yJz4gPSB7XG4gICdqcGcnOiAncmFzdGVyJyxcbiAgJ3BuZyc6ICdyYXN0ZXInLFxuICAnd2VicCc6ICdyYXN0ZXInLFxuICAncGJmJzogJ3ZlY3RvcicsXG4gICdtdnQnOiAndmVjdG9yJ1xufTtcblxuZXhwb3J0IGZ1bmN0aW9uIGh0dHBQb29sT3B0aW9ucyhvcHRpb25zPzogU1FMT3B0aW9ucykge1xuICByZXR1cm4ge1xuICAgIHdvcmtlcnM6IG9wdGlvbnM/LnNxbFdvcmtlcnMgPz8gNCxcbiAgICBodHRwT3B0aW9uczoge1xuICAgICAgbWF4UGFnZVNpemU6IG9wdGlvbnM/Lm1heFNxbFBhZ2VTaXplID8/IDQwOTYsXG4gICAgICBjYWNoZVNpemU6IG9wdGlvbnM/LnNxbENhY2hlU2l6ZSA/PyA0MDk2XG4gICAgfSBhcyBWRlNIVFRQLk9wdGlvbnMsXG4gIH07XG59XG5cbi8qKlxuICogQXV0b21hdGljYWxseSBpbXBvcnQgTUJUaWxlcyBtZXRhZGF0YSBhbmQgcmV0dXJuIGFuIG9wdGlvbnMgb2JqZWN0XG4gKiBjb21wYXRpYmxlIHdpdGggdGhlIHNvdXJjZSBjb25zdHJ1Y3RvcnMuXG4gKiBcbiAqIEBwYXJhbSB7KE1CVGlsZXNSYXN0ZXJPcHRpb25zIHwgTUJUaWxlc1ZlY3Rvck9wdGlvbnMpICYgU1FMT3B0aW9uc30gb3B0IEFueSBNQlRpbGVze1Jhc3RlcnxWZWN0b3J9U291cmNlIG9wdGlvbnMgdG8gYmUgb3ZlcnJpZGRlblxuICogQHBhcmFtIHtzdHJpbmd9IG9wdC51cmwgVVJMIG9mIHRoZSByZW1vdGUgdGlsZXNldFxuICogQHJldHVybnMgeyhNQlRpbGVzUmFzdGVyT3B0aW9ucyB8IE1CVGlsZXNWZWN0b3JPcHRpb25zKX1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGltcG9ydE1CVGlsZXM8VCBleHRlbmRzIE1CVGlsZXNPcHRpb25zPihvcHQ6IFNRTE9wdGlvbnMgJiBUKTogUHJvbWlzZTxUPiB7XG4gIGNvbnN0IHBvb2w6IFByb21pc2U8U1FMaXRlSFRUUFBvb2w+ID0gY3JlYXRlU1FMaXRlSFRUUFBvb2woaHR0cFBvb2xPcHRpb25zKG9wdCkpXG4gICAgLnRoZW4oKHBvb2wpID0+IHBvb2wub3BlbihvcHQudXJsKS50aGVuKCgpID0+IHBvb2wpKTtcblxuICByZXR1cm4gcG9vbFxuICAgIC50aGVuKChwKSA9PiBwLmV4ZWMoJ1NFTEVDVCBuYW1lLHZhbHVlIEZST00gbWV0YWRhdGEnKSlcbiAgICAudGhlbigocikgPT4ge1xuICAgICAgaWYgKHIgJiYgci5sZW5ndGgpIHtcbiAgICAgICAgLy8gVHJhbnNmb3JtIGFuIGFycmF5IG9mIGZvcm0gWyBbJ25hbWUnLCAndmFsdWUnIF0sIC4uLiBdIHRvIG9iamVjdFxuICAgICAgICBjb25zdCBkYXRhID0gci5yZWR1Y2UoKGEsIHgpID0+IHtcbiAgICAgICAgICBhW3gucm93WzBdIGFzIHN0cmluZ10gPSB4LnJvd1sxXSBhcyBzdHJpbmc7XG4gICAgICAgICAgcmV0dXJuIGE7XG4gICAgICAgIH0sIHt9IGFzIFJlY29yZDxzdHJpbmcsIHN0cmluZz4pO1xuICAgICAgICBkZWJ1ZygnTG9hZGVkIG1ldGFkYXRhJywgZGF0YSk7XG4gICAgICAgIHJldHVybiBkYXRhO1xuICAgICAgfVxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdDb3VsZCBub3QgbG9hZCBtZXRhZGF0YScpO1xuICAgIH0pXG4gICAgLnRoZW4oKG1kKSA9PiB7XG4gICAgICBjb25zdCBvcHRzOiBUID0gey4uLm9wdH0gYXMgVDtcblxuICAgICAgY29uc3QgZm9ybWF0ID0gKG1kWydmb3JtYXQnXSBhcyBzdHJpbmcpPy50b0xvd2VyQ2FzZT8uKCk7XG4gICAgICBpZiAoIWZvcm1hdHNbZm9ybWF0XSlcbiAgICAgICAgY29uc29sZS53YXJuKCdVbmtub3duIHRpbGUgZm9ybWF0JywgZm9ybWF0KTtcblxuICAgICAgLy8gU29tZXRpbWVzLCBJIHdvbmRlciBpZiBNYXBib3ggZG9lc24ndCBob2xkIGEgcGF0ZW50IG9yIHNvbWVcbiAgICAgIC8vIG90aGVyIGtpbmQgb2YgaW52ZXN0bWVudCByZWxhdGVkIHRvIGV2ZXJ5b25lIHVzaW5nIDM4NTdcbiAgICAgIG9wdHMucHJvamVjdGlvbiA9IG9wdC5wcm9qZWN0aW9uID8/ICdFUFNHOjM4NTcnO1xuICAgICAgb3B0cy5hdHRyaWJ1dGlvbnMgPSAobWQuYXR0cmlidXRpb24gPz8gbWQuZGVzY3JpcHRpb24pIGFzIHN0cmluZztcbiAgICAgIG9wdHMubWF4Wm9vbSA9IG9wdC5tYXhab29tID8/ICttZFsnbWF4em9vbSddO1xuICAgICAgb3B0cy5taW5ab29tID0gb3B0Lm1pblpvb20gPz8gK21kWydtaW56b29tJ107XG5cbiAgICAgIGNvbnN0IHByb2pFeHRlbnQgPSBnZXRQcm9qZWN0aW9uKG9wdHMucHJvamVjdGlvbik/LmdldEV4dGVudD8uKCk7XG4gICAgICBjb25zdCBib3VuZHMgPSBtZFsnYm91bmRzJ107XG4gICAgICBjb25zdCBleHRlbnQgPSBib3VuZHMgP1xuICAgICAgICB0cmFuc2Zvcm1FeHRlbnQoYm91bmRzLnNwbGl0KCcsJykubWFwKChyKSA9PiArciksICdFUFNHOjQzMjYnLCBvcHRzLnByb2plY3Rpb24pIDpcbiAgICAgICAgcHJvakV4dGVudDtcblxuICAgICAgaWYgKGZvcm1hdHNbZm9ybWF0XSA9PT0gJ3Jhc3RlcicpIHtcbiAgICAgICAgaWYgKG9wdHMubWF4Wm9vbSA9PT0gdW5kZWZpbmVkIHx8IG9wdHMubWluWm9vbSA9PT0gdW5kZWZpbmVkIHx8IHByb2pFeHRlbnQgPT09IHVuZGVmaW5lZClcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0Nhbm5vdCBkZXRlcm1pbmUgdGlsZWdyaWQsIG5lZWQgbWluWm9vbSwgbWF4Wm9vbScpO1xuICAgICAgICBjb25zdCBiYXNlUmVzb2x1dGlvbiA9IGdldFdpZHRoKHByb2pFeHRlbnQpIC8gMjU2O1xuICAgICAgICBjb25zdCByZXNvbHV0aW9ucyA9IFtiYXNlUmVzb2x1dGlvbl07XG4gICAgICAgIGZvciAobGV0IHogPSAxOyB6IDw9IG9wdHMubWF4Wm9vbTsgeisrKVxuICAgICAgICAgIHJlc29sdXRpb25zLnB1c2gocmVzb2x1dGlvbnNbcmVzb2x1dGlvbnMubGVuZ3RoIC0gMV0gLyAyKTtcblxuICAgICAgICBvcHRzLnRpbGVHcmlkID0gbmV3IFRpbGVHcmlkKHtcbiAgICAgICAgICBvcmlnaW46IFtwcm9qRXh0ZW50WzBdLCBwcm9qRXh0ZW50WzJdXSxcbiAgICAgICAgICBleHRlbnQsXG4gICAgICAgICAgbWluWm9vbTogb3B0cy5taW5ab29tLFxuICAgICAgICAgIHJlc29sdXRpb25zXG4gICAgICAgIH0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29uc3QgdmVjdG9yT3B0cyA9IG9wdHMgYXMgTUJUaWxlc1ZlY3Rvck9wdGlvbnM7XG4gICAgICAgIC8vIEFsYXMgVmVjdG9yVGlsZVNvdXJjZSBpbiBPcGVubGF5ZXJzIGRvZXMgbm90IHN1cHBvcnRcbiAgICAgICAgLy8gY29uc3RyYWluaW5nIHRoZSBleHRlbnQgd2hpbGUga2VlcGluZyB0aGUgb3JpZ2luXG4gICAgICAgIHZlY3Rvck9wdHMuZXh0ZW50ID0gcHJvakV4dGVudDtcbiAgICAgIH1cbiAgICAgIG9wdHMucG9vbCA9IHBvb2w7XG4gICAgICBvcHRzLnVybCA9IG9wdC51cmw7XG5cbiAgICAgIHJldHVybiBvcHRzO1xuICAgIH0pO1xufVxuIiwiaW1wb3J0IFByb3RvYnVmIGZyb20gJ3BiZic7XG5pbXBvcnQgeyBWZWN0b3JUaWxlLCBWZWN0b3JUaWxlRmVhdHVyZSB9IGZyb20gJ0BtYXBib3gvdmVjdG9yLXRpbGUnO1xuaW1wb3J0IHBha28gZnJvbSAncGFrbyc7XG5cbmltcG9ydCBGZWF0dXJlRm9ybWF0LCB7IFJlYWRPcHRpb25zIH0gZnJvbSAnb2wvZm9ybWF0L0ZlYXR1cmUuanMnO1xuaW1wb3J0IFByb2plY3Rpb24gZnJvbSAnb2wvcHJvai9Qcm9qZWN0aW9uLmpzJztcbmltcG9ydCBSZW5kZXJGZWF0dXJlIGZyb20gJ29sL3JlbmRlci9GZWF0dXJlLmpzJztcbmltcG9ydCB7IEZlYXR1cmVMaWtlIH0gZnJvbSAnb2wvRmVhdHVyZS5qcyc7XG5pbXBvcnQgeyBnZXQgYXMgZ2V0UHJvamVjdGlvbiB9IGZyb20gJ29sL3Byb2ouanMnO1xuaW1wb3J0IHsgVHlwZSB9IGZyb20gJ29sL2dlb20vR2VvbWV0cnkuanMnO1xuXG5kZWNsYXJlIG1vZHVsZSAnQG1hcGJveC92ZWN0b3ItdGlsZScge1xuICBpbnRlcmZhY2UgVmVjdG9yVGlsZUZlYXR1cmUge1xuICAgIHRvR2VvSlNPTih4OiBudW1iZXIsIHk6IG51bWJlciwgejogbnVtYmVyLCBwcm9qZWN0PzogKHh5OiBbbnVtYmVyLCBudW1iZXJdKSA9PiBbbnVtYmVyLCBudW1iZXJdKTogR2VvSlNPTi5GZWF0dXJlO1xuICB9XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgT3B0aW9ucyB7XG4gIGxheWVycz86IHN0cmluZ1tdO1xuICBmZWF0dXJlQ2xhc3M/OiB0eXBlb2YgUmVuZGVyRmVhdHVyZTtcbiAgZ2VvbWV0cnlOYW1lPzogc3RyaW5nO1xuICBpZFByb3BlcnR5Pzogc3RyaW5nO1xuICBleHRlbnQ/OiBudW1iZXI7XG59XG5cbmV4cG9ydCBjbGFzcyBNQlRpbGVzRm9ybWF0IGV4dGVuZHMgRmVhdHVyZUZvcm1hdCB7XG4gIGRhdGFQcm9qZWN0aW9uOiBQcm9qZWN0aW9uO1xuICBwcml2YXRlIGZlYXR1cmVDbGFzc186IHR5cGVvZiBSZW5kZXJGZWF0dXJlO1xuICBwcml2YXRlIGdlb21ldHJ5TmFtZV86IHN0cmluZztcbiAgcHJpdmF0ZSBsYXllcnNfOiBzdHJpbmdbXSB8IG51bGw7XG4gIHByaXZhdGUgaWRQcm9wZXJ0eV86IHN0cmluZyB8IHVuZGVmaW5lZDtcbiAgc3VwcG9ydGVkTWVkaWFUeXBlczogc3RyaW5nW107XG4gIGV4dGVudDogbnVtYmVyO1xuICBzdGF0aWMgTUJUeXBlcyA9IHtcbiAgICBtb25vOiBbJ1Vua25vd24nLCAnUG9pbnQnLCAnTGluZVN0cmluZycsICdQb2x5Z29uJyBdLFxuICAgIG11bHRpOiBbJ1Vua25vd24nLCAnTXVsdGlQb2ludCcsICdNdWx0aUxpbmVTdHJpbmcnLCAnUG9seWdvbiddXG4gICB9IGFzIFJlY29yZDwnbW9ubycgfCAnbXVsdGknLCAoVHlwZSB8ICdVbmtub3duJylbXT47XG5cbiAgY29uc3RydWN0b3Iob3B0aW9ucz86IE9wdGlvbnMpIHtcbiAgICBzdXBlcigpO1xuXG4gICAgb3B0aW9ucyA9IG9wdGlvbnMgPyBvcHRpb25zIDoge307XG5cbiAgICB0aGlzLmRhdGFQcm9qZWN0aW9uID0gbmV3IFByb2plY3Rpb24oe1xuICAgICAgY29kZTogJycsXG4gICAgICB1bml0czogJ3RpbGUtcGl4ZWxzJyxcbiAgICB9KTtcblxuICAgIHRoaXMuZmVhdHVyZUNsYXNzXyA9IG9wdGlvbnMuZmVhdHVyZUNsYXNzID8gb3B0aW9ucy5mZWF0dXJlQ2xhc3MgOiBSZW5kZXJGZWF0dXJlO1xuICAgIHRoaXMuZ2VvbWV0cnlOYW1lXyA9IG9wdGlvbnMuZ2VvbWV0cnlOYW1lID8/ICdHZW9tZXRyeSc7XG4gICAgdGhpcy5sYXllcnNfID0gb3B0aW9ucy5sYXllcnMgPz8gbnVsbDtcbiAgICB0aGlzLmlkUHJvcGVydHlfID0gb3B0aW9ucy5pZFByb3BlcnR5O1xuICAgIHRoaXMuZXh0ZW50ID0gb3B0aW9ucy5leHRlbnQgPz8gNDA5NjtcblxuICAgIC8qXG4gICAgICogQXMgdGhpcyBpcyB0aGUgdmVyeSBmaXJzdCB0aW1lIE1CVGlsZXMgd2lsbCBiZSBkaXN0cmlidXRlZCBieSBIVFRQXG4gICAgICogdGhlcmUgaXMgc3RpbGwgbm8gb2ZmaWNpYWwgTUlNRSB0eXBlXG4gICAgICovXG4gICAgdGhpcy5zdXBwb3J0ZWRNZWRpYVR5cGVzID0gW1xuICAgICAgJ2FwcGxpY2F0aW9uL3ZuZC1tYnRpbGVzJ1xuICAgIF07XG4gIH1cblxuICByZWFkRmVhdHVyZShzb3VyY2U6IFZlY3RvclRpbGVGZWF0dXJlLCBvcHRpb25zPzogUmVhZE9wdGlvbnMpOiBGZWF0dXJlTGlrZSB7XG4gICAgY29uc3QgcHJvcGVydGllcyA9IHNvdXJjZS5wcm9wZXJ0aWVzO1xuXG4gICAgbGV0IGlkOiBzdHJpbmcgfCBudW1iZXI7XG4gICAgaWYgKCF0aGlzLmlkUHJvcGVydHlfKSB7XG4gICAgICBpZCA9IHNvdXJjZS5pZDtcbiAgICB9IGVsc2Uge1xuICAgICAgaWQgPSBwcm9wZXJ0aWVzW3RoaXMuaWRQcm9wZXJ0eV9dIGFzIHN0cmluZyB8IG51bWJlcjtcbiAgICAgIGRlbGV0ZSBwcm9wZXJ0aWVzW3RoaXMuaWRQcm9wZXJ0eV9dO1xuICAgIH1cbiAgICBjb25zdCBwb2ludHMgPSBzb3VyY2UubG9hZEdlb21ldHJ5KCk7XG4gICAgY29uc3QgZmxhdENvb3JkaW5hdGVzID0gW10gYXMgbnVtYmVyW107XG4gICAgY29uc3QgZW5kcyA9IFtdIGFzIG51bWJlcltdO1xuXG4gICAgY29uc3QgdHlwZTogVHlwZSB8ICdVbmtub3duJyA9IE1CVGlsZXNGb3JtYXQuTUJUeXBlc1twb2ludHMubGVuZ3RoID4gMSA/ICdtdWx0aScgOiAnbW9ubyddW3NvdXJjZS50eXBlXTtcbiAgICBpZiAodHlwZSA9PT0gJ1Vua25vd24nKVxuICAgIC8vIFRPRE86IGZpeCBpbiBPcGVubGF5ZXJzXG4gICAgICByZXR1cm4gbnVsbCBhcyB1bmtub3duIGFzIEZlYXR1cmVMaWtlO1xuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBwb2ludHMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGlmIChwb2ludHNbaV0ubGVuZ3RoID09IDApXG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBwb2ludHNbaV0ubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgZmxhdENvb3JkaW5hdGVzLnB1c2gocG9pbnRzW2ldW2pdLngsIHBvaW50c1tpXVtqXS55KTtcbiAgICAgIH1cbiAgICAgIGVuZHMucHVzaChmbGF0Q29vcmRpbmF0ZXMubGVuZ3RoKTtcbiAgICB9XG5cbiAgICBjb25zdCBmZWF0dXJlID0gbmV3IHRoaXMuZmVhdHVyZUNsYXNzXyh0eXBlLCBmbGF0Q29vcmRpbmF0ZXMsIGVuZHMsIHByb3BlcnRpZXMsIGlkKTtcbiAgICBmZWF0dXJlLnRyYW5zZm9ybShvcHRpb25zPy5kYXRhUHJvamVjdGlvbik7XG5cbiAgICByZXR1cm4gZmVhdHVyZTtcbiAgfVxuXG4gIHJlYWRGZWF0dXJlcyhzb3VyY2U6IEFycmF5QnVmZmVyLCBvcHRpb25zPzogUmVhZE9wdGlvbnMpOiBGZWF0dXJlTGlrZVtdIHtcbiAgICBjb25zdCBsYXllcnMgPSB0aGlzLmxheWVyc187XG5cbiAgICBjb25zdCBmZWF0dXJlczogRmVhdHVyZUxpa2VbXSA9IFtdO1xuICAgIGNvbnN0IHRpbGUgPSBuZXcgVmVjdG9yVGlsZShuZXcgUHJvdG9idWYocGFrby51bmd6aXAoc291cmNlKSkpO1xuICAgIG9wdGlvbnMgPSB0aGlzLmFkYXB0T3B0aW9ucyhvcHRpb25zKTtcbiAgICBjb25zdCBkYXRhUHJvamVjdGlvbiA9IGdldFByb2plY3Rpb24ob3B0aW9ucz8uZGF0YVByb2plY3Rpb24pO1xuICAgIGNvbnN0IGV4dGVudCA9IG9wdGlvbnM/LmV4dGVudDtcbiAgICBpZiAoIWRhdGFQcm9qZWN0aW9uIHx8ICFvcHRpb25zIHx8ICFleHRlbnQpXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0Nhbm5vdCBkZXRlcm1pbmUgdGhlIHByb2plY3Rpb24vZXh0ZW50Jyk7XG4gICAgZGF0YVByb2plY3Rpb24uc2V0V29ybGRFeHRlbnQoZXh0ZW50KTtcbiAgICBkYXRhUHJvamVjdGlvbi5zZXRFeHRlbnQoWzAsIDAsIHRoaXMuZXh0ZW50LCB0aGlzLmV4dGVudF0pO1xuICAgIG9wdGlvbnMuZGF0YVByb2plY3Rpb24gPSBkYXRhUHJvamVjdGlvbjtcblxuICAgIGZvciAoY29uc3QgbGF5ZXJOYW1lIG9mIE9iamVjdC5rZXlzKHRpbGUubGF5ZXJzKSkge1xuICAgICAgaWYgKGxheWVycyAmJiAhbGF5ZXJzLmluY2x1ZGVzKGxheWVyTmFtZSkpIHtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG4gICAgICBjb25zdCBsID0gdGlsZS5sYXllcnNbbGF5ZXJOYW1lXTtcbiAgICAgIGZvciAobGV0IGlkeCA9IDA7IGlkeCA8IGwubGVuZ3RoOyBpZHgrKykge1xuICAgICAgICBjb25zdCB2ZWN0b3JGZWF0dXJlID0gbC5mZWF0dXJlKGlkeCk7XG4gICAgICAgIGNvbnN0IGZlYXR1cmUgPSB0aGlzLnJlYWRGZWF0dXJlKHZlY3RvckZlYXR1cmUsIG9wdGlvbnMpO1xuICAgICAgICBmZWF0dXJlLmdldFByb3BlcnRpZXMoKS5sYXllciA9IGxheWVyTmFtZTtcbiAgICAgICAgZmVhdHVyZXMucHVzaChmZWF0dXJlKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gZmVhdHVyZXM7XG4gIH1cblxuICByZWFkUHJvamVjdGlvbigpIHtcbiAgICByZXR1cm4gdGhpcy5kYXRhUHJvamVjdGlvbjtcbiAgfVxufVxuIiwiaW1wb3J0IHsgY3JlYXRlU1FMaXRlSFRUUFBvb2wsIFNRTGl0ZUhUVFBQb29sIH0gZnJvbSAnc3FsaXRlLXdhc20taHR0cCc7XG5cbmltcG9ydCBWZWN0b3JUaWxlU291cmNlIGZyb20gJ29sL3NvdXJjZS9WZWN0b3JUaWxlLmpzJztcbmltcG9ydCBWZWN0b3JUaWxlIGZyb20gJ29sL1ZlY3RvclRpbGUuanMnO1xuaW1wb3J0IHsgVGlsZUNvb3JkIH0gZnJvbSAnb2wvdGlsZWNvb3JkLmpzJztcbmltcG9ydCBGZWF0dXJlIGZyb20gJ29sL0ZlYXR1cmUuanMnO1xuaW1wb3J0IHsgR2VvbWV0cnkgfSBmcm9tICdvbC9nZW9tLmpzJztcblxuaW1wb3J0IHsgaHR0cFBvb2xPcHRpb25zLCBNQlRpbGVzVmVjdG9yT3B0aW9ucywgU1FMT3B0aW9ucyB9IGZyb20gJy4vbWJ0aWxlcyc7XG5pbXBvcnQgeyBNQlRpbGVzRm9ybWF0IH0gZnJvbSAnLi9tYnRpbGVzLWZvcm1hdCc7XG5pbXBvcnQgeyBkZWJ1ZyB9IGZyb20gJy4vZGVidWcnO1xuaW1wb3J0IFRpbGUgZnJvbSAnb2wvVGlsZSc7XG5cbi8qKlxuICogQSB0aWxlIHNvdXJjZSBpbiBhIHJlbW90ZSAubWJ0aWxlcyBmaWxlIGFjY2Vzc2libGUgYnkgSFRUUFxuICogXG4gKiBXQVJOSU5HXG4gKiBJZiB5b3VyIGFwcGxpY2F0aW9uIGNvbnRpbnVvdXNseSBjcmVhdGVzIGFuZCByZW1vdmVzIE1CVGlsZXNTb3VyY2VcbiAqIG9iamVjdHMsIHNwZWNpYWwgY2FyZSBtdXN0IGJlIHRha2VuIHRvIHByb3Blcmx5IGRpc3Bvc2Ugb2YgdGhlbS5cbiAqIEFuIE1CVGlsZXNTb3VyY2UgY3JlYXRlcyBhIHRocmVhZCBwb29sIHRoYXQgdGhlIEpTIGVuZ2luZSBpcyB1bmFibGUgdG9cbiAqIGF1dG9tYXRpY2FsbHkgZ2FyYmFnZS1jb2xsZWN0IHVubGVzcyB0aGUgZGlzcG9zZSgpIG1ldGhvZFxuICogaXMgaW52b2tlZC5cbiAqIElmIHlvdSBuZWVkIHRvIGRpc3Bvc2UgYSBtYXAgdGhhdCBjYW4gcG90ZW50aWFsbHkgY29udGFpblxuICogTUJUaWxlc1NvdXJjZSBvYmplY3RzLCBjaGVjayBsb2FkRXhhbXBsZSgpIGluXG4gKiBodHRwczovL2dpdGh1Yi5jb20vbW1vbXRjaGV2L29sLW1idGlsZXMvYmxvYi9tYWluL2V4YW1wbGVzL2luZGV4LnRzI0wxNVxuICovXG5leHBvcnQgY2xhc3MgTUJUaWxlc1ZlY3RvclNvdXJjZSBleHRlbmRzIFZlY3RvclRpbGVTb3VyY2Uge1xuICBwcml2YXRlIHBvb2w6IFByb21pc2U8U1FMaXRlSFRUUFBvb2w+O1xuXG4gIC8qKlxuICAgKiBAcGFyYW0ge01CVGlsZXNWZWN0b3JPcHRpb25zfSBvcHRpb25zIG9wdGlvbnNcbiAgICovXG4gIGNvbnN0cnVjdG9yKG9wdGlvbnM6IE1CVGlsZXNWZWN0b3JPcHRpb25zICYgU1FMT3B0aW9ucykge1xuICAgIGlmIChvcHRpb25zLnVybCA9PT0gdW5kZWZpbmVkICYmIG9wdGlvbnMucG9vbCA9PT0gdW5kZWZpbmVkKVxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdNdXN0IHNwZWNpZnkgdXJsJyk7XG5cbiAgICAgIHN1cGVyKHtcbiAgICAgIC4uLm9wdGlvbnMsXG4gICAgICB1cmw6IHVuZGVmaW5lZCxcbiAgICAgIGZvcm1hdDogbmV3IE1CVGlsZXNGb3JtYXQoe1xuICAgICAgICBsYXllcnM6IG9wdGlvbnMubGF5ZXJzXG4gICAgICB9KSxcbiAgICAgIC8vIFRoaXMgaXMgcmVxdWlyZWQgdG8gcHJldmVudCBPcGVubGF5ZXJzJyBjYWNoZSBmcm9tIHRoaW5raW5nIHRoYXQgYWxsIHRpbGVzIHNoYXJlIHRoZSBzYW1lIFVSTFxuICAgICAgdGlsZVVybEZ1bmN0aW9uOiAoY29vcmRzOiBUaWxlQ29vcmQpID0+IGAke29wdGlvbnMudXJsfSMke2Nvb3Jkc1swXX06JHtjb29yZHNbMV19OiR7Y29vcmRzWzJdfWBcbiAgICB9KTtcblxuICAgIHRoaXMuc2V0VGlsZUxvYWRGdW5jdGlvbih0aGlzLnRpbGVMb2FkZXIuYmluZCh0aGlzKSk7XG5cbiAgICB0aGlzLnBvb2wgPSBvcHRpb25zLnBvb2wgPz8gY3JlYXRlU1FMaXRlSFRUUFBvb2woaHR0cFBvb2xPcHRpb25zKG9wdGlvbnMpKVxuICAgICAgLnRoZW4oKHBvb2wpID0+IHBvb2wub3BlbihvcHRpb25zLnVybCkudGhlbigoKSA9PiBwb29sKSk7XG4gIH1cblxuICBwcml2YXRlIHRpbGVMb2FkZXIoX3RpbGU6IFRpbGUsIF91cmw6IHN0cmluZykge1xuICAgIC8vIFRPRE8gZml4IHRoZSB0eXBlIGluIE9wZW5sYXllcnMgYWZ0ZXIgdGhlIHdhclxuICAgIGNvbnN0IHRpbGUgPSBfdGlsZSBhcyBWZWN0b3JUaWxlO1xuICAgIGRlYnVnKCdsb2FkaW5nIHRpbGUnLCBbdGlsZS50aWxlQ29vcmRbMF0sIHRpbGUudGlsZUNvb3JkWzFdLCB0aWxlLnRpbGVDb29yZFsyXV0pO1xuICAgIHRpbGUuc2V0TG9hZGVyKChleHRlbnQsIHJlc29sdXRpb24sIHByb2plY3Rpb24pID0+IHtcbiAgICAgIHRoaXMucG9vbFxuICAgICAgICAudGhlbigocCkgPT5cbiAgICAgICAgICBwLmV4ZWMoXG4gICAgICAgICAgICAnU0VMRUNUIHRpbGVfZGF0YSBGUk9NIHRpbGVzIFdIRVJFIHpvb21fbGV2ZWwgPSAkem9vbSBBTkQgdGlsZV9jb2x1bW4gPSAkY29sIEFORCB0aWxlX3JvdyA9ICRyb3cnLFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAkem9vbTogdGlsZS50aWxlQ29vcmRbMF0sXG4gICAgICAgICAgICAgICRjb2w6IHRpbGUudGlsZUNvb3JkWzFdLFxuICAgICAgICAgICAgICAkcm93OiAoMSA8PCB0aWxlLnRpbGVDb29yZFswXSkgLSAxIC0gdGlsZS50aWxlQ29vcmRbMl1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICApKVxuICAgICAgICAudGhlbigocikgPT4ge1xuICAgICAgICAgIGlmIChyICYmIHJbMF0gJiYgclswXS5yb3dbMF0pIHtcbiAgICAgICAgICAgIGNvbnN0IGZvcm1hdCA9IHRpbGUuZ2V0Rm9ybWF0KCk7XG4gICAgICAgICAgICBjb25zdCBmZWF0dXJlcyA9IGZvcm1hdC5yZWFkRmVhdHVyZXMoclswXS5yb3dbMF0sIHtcbiAgICAgICAgICAgICAgZXh0ZW50LFxuICAgICAgICAgICAgICBmZWF0dXJlUHJvamVjdGlvbjogcHJvamVjdGlvblxuICAgICAgICAgICAgfSkgYXMgRmVhdHVyZTxHZW9tZXRyeT5bXTtcbiAgICAgICAgICAgIHRpbGUuc2V0RmVhdHVyZXMoZmVhdHVyZXMpO1xuICAgICAgICAgICAgdGlsZS5vbkxvYWQoZmVhdHVyZXMsIHByb2plY3Rpb24pO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH1cbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYE5vIGRhdGEgZm9yICR7dGlsZS50aWxlQ29vcmR9YCk7XG4gICAgICAgIH0pXG4gICAgICAgIC5jYXRjaCgoZSkgPT4ge1xuICAgICAgICAgIGRlYnVnKGUpO1xuICAgICAgICAgIHRpbGUub25FcnJvcigpO1xuICAgICAgICB9KTtcbiAgICB9KTtcbiAgfVxuXG4gIGRpc3Bvc2VJbnRlcm5hbCgpIHtcbiAgICByZXR1cm4gdGhpcy5wb29sLnRoZW4oKHApID0+IHAuY2xvc2UoKSk7XG4gIH1cbn1cbiIsImltcG9ydCB7IGNyZWF0ZVNRTGl0ZUhUVFBQb29sLCBTUUxpdGVIVFRQUG9vbCB9IGZyb20gJ3NxbGl0ZS13YXNtLWh0dHAnO1xuXG5pbXBvcnQgSW1hZ2VUaWxlU291cmNlIGZyb20gJ29sL3NvdXJjZS9UaWxlSW1hZ2UuanMnO1xuaW1wb3J0IFRpbGUgZnJvbSAnb2wvVGlsZS5qcyc7XG5pbXBvcnQgSW1hZ2VUaWxlIGZyb20gJ29sL0ltYWdlVGlsZS5qcyc7XG5pbXBvcnQgeyBUaWxlQ29vcmQgfSBmcm9tICdvbC90aWxlY29vcmQuanMnO1xuaW1wb3J0IFRpbGVTdGF0ZSBmcm9tICdvbC9UaWxlU3RhdGUuanMnO1xuXG5pbXBvcnQgeyBodHRwUG9vbE9wdGlvbnMsIE1CVGlsZXNSYXN0ZXJPcHRpb25zLCBTUUxPcHRpb25zIH0gZnJvbSAnLi9tYnRpbGVzJztcbmltcG9ydCB7IGRlYnVnIH0gZnJvbSAnLi9kZWJ1Zyc7XG5cbi8qKlxuICogQSB0aWxlIHNvdXJjZSBpbiBhIHJlbW90ZSAubWJ0aWxlcyBmaWxlIGFjY2Vzc2libGUgYnkgSFRUUFxuICogXG4gKiBXQVJOSU5HXG4gKiBJZiB5b3VyIGFwcGxpY2F0aW9uIGNvbnRpbnVvdXNseSBjcmVhdGVzIGFuZCByZW1vdmVzIE1CVGlsZXNTb3VyY2VcbiAqIG9iamVjdHMsIHNwZWNpYWwgY2FyZSBtdXN0IGJlIHRha2VuIHRvIHByb3Blcmx5IGRpc3Bvc2Ugb2YgdGhlbS5cbiAqIEFuIE1CVGlsZXNTb3VyY2UgY3JlYXRlcyBhIHRocmVhZCBwb29sIHRoYXQgdGhlIEpTIGVuZ2luZSBpcyB1bmFibGUgdG9cbiAqIGF1dG9tYXRpY2FsbHkgZ2FyYmFnZS1jb2xsZWN0IHVubGVzcyB0aGUgZGlzcG9zZSgpIG1ldGhvZFxuICogaXMgaW52b2tlZC5cbiAqIElmIHlvdSBuZWVkIHRvIGRpc3Bvc2UgYSBtYXAgdGhhdCBjYW4gcG90ZW50aWFsbHkgY29udGFpblxuICogTUJUaWxlc1NvdXJjZSBvYmplY3RzLCBjaGVjayBsb2FkRXhhbXBsZSgpIGluXG4gKiBodHRwczovL2dpdGh1Yi5jb20vbW1vbXRjaGV2L29sLW1idGlsZXMvYmxvYi9tYWluL2V4YW1wbGVzL2luZGV4LnRzI0wxNVxuICovXG5leHBvcnQgY2xhc3MgTUJUaWxlc1Jhc3RlclNvdXJjZSBleHRlbmRzIEltYWdlVGlsZVNvdXJjZSB7XG4gIHByaXZhdGUgcG9vbDogUHJvbWlzZTxTUUxpdGVIVFRQUG9vbD47XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7TUJUaWxlc1Jhc3Rlck9wdGlvbnN9IG9wdGlvbnMgb3B0aW9uc1xuICAgKi9cbiAgY29uc3RydWN0b3Iob3B0aW9uczogTUJUaWxlc1Jhc3Rlck9wdGlvbnMgJiBTUUxPcHRpb25zKSB7XG4gICAgaWYgKG9wdGlvbnMudXJsID09PSB1bmRlZmluZWQgJiYgb3B0aW9ucy5wb29sID09PSB1bmRlZmluZWQpXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ011c3Qgc3BlY2lmeSB1cmwnKTtcblxuICAgIHN1cGVyKHtcbiAgICAgIC4uLm9wdGlvbnMsXG4gICAgICB1cmw6IHVuZGVmaW5lZCxcbiAgICAgIC8vIFRoaXMgaXMgcmVxdWlyZWQgdG8gcHJldmVudCBPcGVubGF5ZXJzJyBjYWNoZSBmcm9tIHRoaW5raW5nIHRoYXQgYWxsIHRpbGVzIHNoYXJlIHRoZSBzYW1lIFVSTFxuICAgICAgdGlsZVVybEZ1bmN0aW9uOiAoY29vcmRzOiBUaWxlQ29vcmQpID0+IGAke29wdGlvbnMudXJsfSMke2Nvb3Jkc1swXX06JHtjb29yZHNbMV19OiR7Y29vcmRzWzJdfWBcbiAgICB9KTtcblxuICAgIHRoaXMuc2V0VGlsZUxvYWRGdW5jdGlvbih0aGlzLnRpbGVMb2FkZXIuYmluZCh0aGlzKSk7XG5cbiAgICB0aGlzLnBvb2wgPSBvcHRpb25zLnBvb2wgPz8gY3JlYXRlU1FMaXRlSFRUUFBvb2woaHR0cFBvb2xPcHRpb25zKG9wdGlvbnMpKVxuICAgICAgLnRoZW4oKHBvb2wpID0+IHBvb2wub3BlbihvcHRpb25zLnVybCkudGhlbigoKSA9PiBwb29sKSk7XG4gIH1cblxuICAvLyBUT0RPIGZpeCB0aGUgdGlsZSB0eXBlIGluIE9wZW5sYXllcnNcbiAgcHJpdmF0ZSB0aWxlTG9hZGVyKHRpbGU6IFRpbGUsIF91cmw6IHN0cmluZykge1xuICAgIGRlYnVnKCdsb2FkaW5nIHRpbGUnLCBbdGlsZS50aWxlQ29vcmRbMF0sIHRpbGUudGlsZUNvb3JkWzFdLCB0aWxlLnRpbGVDb29yZFsyXV0pO1xuICAgIGNvbnN0IGltYWdlID0gKHRpbGUgYXMgSW1hZ2VUaWxlKS5nZXRJbWFnZSgpIGFzIEhUTUxJbWFnZUVsZW1lbnQ7XG4gICAgdGhpcy5wb29sXG4gICAgICAudGhlbigocCkgPT5cbiAgICAgICAgcC5leGVjKFxuICAgICAgICAgICdTRUxFQ1QgdGlsZV9kYXRhIEZST00gdGlsZXMgV0hFUkUgem9vbV9sZXZlbCA9ICR6b29tIEFORCB0aWxlX2NvbHVtbiA9ICRjb2wgQU5EIHRpbGVfcm93ID0gJHJvdycsXG4gICAgICAgICAge1xuICAgICAgICAgICAgJHpvb206IHRpbGUudGlsZUNvb3JkWzBdLFxuICAgICAgICAgICAgJGNvbDogdGlsZS50aWxlQ29vcmRbMV0sXG4gICAgICAgICAgICAkcm93OiAoMSA8PCB0aWxlLnRpbGVDb29yZFswXSkgLSAxIC0gdGlsZS50aWxlQ29vcmRbMl1cbiAgICAgICAgICB9XG4gICAgICAgICkpXG4gICAgICAudGhlbigocikgPT4ge1xuICAgICAgICBpZiAociAmJiByWzBdKSB7XG4gICAgICAgICAgaWYgKHJbMF0ucm93WzBdIGluc3RhbmNlb2YgVWludDhBcnJheSkge1xuICAgICAgICAgICAgY29uc3QgYmxvYiA9IG5ldyBCbG9iKFtyWzBdLnJvd1swXSBhcyBVaW50OEFycmF5XSk7XG4gICAgICAgICAgICBjb25zdCBpbWFnZVVybCA9IFVSTC5jcmVhdGVPYmplY3RVUkwoYmxvYik7XG4gICAgICAgICAgICBpbWFnZS5zcmMgPSBpbWFnZVVybDtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBObyBkYXRhIGZvciAke3RpbGUudGlsZUNvb3JkfWApO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaCgoZSkgPT4ge1xuICAgICAgICBkZWJ1ZyhlKTtcbiAgICAgICAgdGlsZS5zZXRTdGF0ZShUaWxlU3RhdGUuRVJST1IpO1xuICAgICAgfSk7XG4gIH1cblxuICBkaXNwb3NlSW50ZXJuYWwoKSB7XG4gICAgcmV0dXJuIHRoaXMucG9vbC50aGVuKChwKSA9PiBwLmNsb3NlKCkpO1xuICB9XG59XG4iXSwibmFtZXMiOlsidGFyZ2V0IiwibGF5ZXJzIiwic291cmNlIiwidXJsIiwiYXR0cmlidXRpb25zIiwic3R5bGUiLCJmZWF0dXJlIiwiZ2V0IiwidmlldyIsImNlbnRlciIsInpvb20iLCJzdHlsZVRvd24iLCJzaXplIiwid2lkdGgiLCJmb250IiwiY29sb3IxIiwiaW1hZ2UiLCJmaWxsIiwiY29sb3IiLCJyYWRpdXMiLCJzdHJva2UiLCJ0ZXh0Iiwic3R5bGVCb3JkZXIiLCJyb2FkU3R5bGVDYWNoZSIsInJvYWRDb2xvciIsImJ1aWxkaW5nU3R5bGUiLCJ3YXRlclN0eWxlIiwiYm91bmRhcnlTdHlsZSIsInJvYWRTdHlsZSIsImtpbmQiLCJyYWlsd2F5Iiwic29ydF9rZXkiLCJzdHlsZUtleSIsInpJbmRleCIsInBsYWNlQmFzZSIsInRleHRTdHJva2UiLCJwbGFjZVN0eWxlIiwiY2xvbmUiLCJzZXRUZXh0Iiwib2Zmc2V0WSIsImRlYnVnIiwiT0xfTUJUSUxFU19ERUJVRyIsInByb2Nlc3MiLCJlbnYiLCJjb25zb2xlIiwiYmluZCIsImZvcm1hdHMiLCJodHRwUG9vbE9wdGlvbnMiLCJvcHRpb25zIiwid29ya2VycyIsInNxbFdvcmtlcnMiLCJodHRwT3B0aW9ucyIsIm1heFBhZ2VTaXplIiwibWF4U3FsUGFnZVNpemUiLCJjYWNoZVNpemUiLCJzcWxDYWNoZVNpemUiLCJpbXBvcnRNQlRpbGVzIiwib3B0IiwicG9vbCIsInRoZW4iLCJvcGVuIiwicCIsImV4ZWMiLCJyIiwibGVuZ3RoIiwiZGF0YSIsInJlZHVjZSIsImEiLCJ4Iiwicm93IiwiRXJyb3IiLCJtZCIsIm9wdHMiLCJmb3JtYXQiLCJ0b0xvd2VyQ2FzZSIsIndhcm4iLCJwcm9qZWN0aW9uIiwiYXR0cmlidXRpb24iLCJkZXNjcmlwdGlvbiIsIm1heFpvb20iLCJtaW5ab29tIiwicHJvakV4dGVudCIsImdldEV4dGVudCIsImJvdW5kcyIsImV4dGVudCIsInNwbGl0IiwibWFwIiwidW5kZWZpbmVkIiwicmVzb2x1dGlvbnMiLCJ6IiwicHVzaCIsInRpbGVHcmlkIiwiVGlsZUdyaWQiLCJvcmlnaW4iLCJNQlRpbGVzRm9ybWF0IiwiRmVhdHVyZSIsImNvbnN0cnVjdG9yIiwic3VwZXIiLCJ0aGlzIiwiZGF0YVByb2plY3Rpb24iLCJQcm9qZWN0aW9uIiwiY29kZSIsInVuaXRzIiwiZmVhdHVyZUNsYXNzXyIsImZlYXR1cmVDbGFzcyIsImdlb21ldHJ5TmFtZV8iLCJnZW9tZXRyeU5hbWUiLCJsYXllcnNfIiwiaWRQcm9wZXJ0eV8iLCJpZFByb3BlcnR5Iiwic3VwcG9ydGVkTWVkaWFUeXBlcyIsInJlYWRGZWF0dXJlIiwicHJvcGVydGllcyIsImlkIiwicG9pbnRzIiwibG9hZEdlb21ldHJ5IiwiZmxhdENvb3JkaW5hdGVzIiwiZW5kcyIsInR5cGUiLCJNQlR5cGVzIiwiaSIsImoiLCJ5IiwidHJhbnNmb3JtIiwicmVhZEZlYXR1cmVzIiwiZmVhdHVyZXMiLCJ0aWxlIiwiVmVjdG9yVGlsZSIsImFkYXB0T3B0aW9ucyIsInNldFdvcmxkRXh0ZW50Iiwic2V0RXh0ZW50IiwibGF5ZXJOYW1lIiwiT2JqZWN0Iiwia2V5cyIsImluY2x1ZGVzIiwibCIsImlkeCIsInZlY3RvckZlYXR1cmUiLCJnZXRQcm9wZXJ0aWVzIiwibGF5ZXIiLCJyZWFkUHJvamVjdGlvbiIsIm1vbm8iLCJtdWx0aSIsIk1CVGlsZXNWZWN0b3JTb3VyY2UiLCJ0aWxlVXJsRnVuY3Rpb24iLCJjb29yZHMiLCJzZXRUaWxlTG9hZEZ1bmN0aW9uIiwidGlsZUxvYWRlciIsIl90aWxlIiwiX3VybCIsInRpbGVDb29yZCIsInNldExvYWRlciIsInJlc29sdXRpb24iLCIkem9vbSIsIiRjb2wiLCIkcm93IiwiZ2V0Rm9ybWF0IiwiZmVhdHVyZVByb2plY3Rpb24iLCJzZXRGZWF0dXJlcyIsIm9uTG9hZCIsImNhdGNoIiwiZSIsIm9uRXJyb3IiLCJkaXNwb3NlSW50ZXJuYWwiLCJjbG9zZSIsIk1CVGlsZXNSYXN0ZXJTb3VyY2UiLCJnZXRJbWFnZSIsIlVpbnQ4QXJyYXkiLCJibG9iIiwiQmxvYiIsImltYWdlVXJsIiwiVVJMIiwiY3JlYXRlT2JqZWN0VVJMIiwic3JjIiwic2V0U3RhdGUiLCJUaWxlU3RhdGUiXSwic291cmNlUm9vdCI6IiJ9
"use strict";(self.webpackChunkol_mbtiles=self.webpackChunkol_mbtiles||[]).push([[491],{9491:(e,t,o)=>{o.r(t),o.d(t,{default:()=>u});var r=o(8854),n=o(2479),a=o(9090),i=o(9731),s=o(6263),l=o(8661),d=o(5901),c=o(5917);function u(){new r.Z({target:"map",layers:[new n.Z({source:new s.Z}),new i.Z({source:new d.B({url:"https://velivole.b-cdn.net/maptiler-osm-2017-07-03-v3.6.1-europe.mbtiles",layers:["transportation","water","waterway"],attributions:["MapTiler","OSM","https://data.maptiler.com/downloads/dataset/osm/europe/"],maxZoom:14,minZoom:0,sqlWorkers:1}),style:function(e,t){switch(e.get("layer")){case"water":case"waterway":return c.d_;case"transportation":return(0,c.xl)(e);default:return null}}})],view:new a.ZP({center:(0,l.mi)([12,50]),zoom:6})})}},5917:(e,t,o)=>{o.d(t,{d_:()=>h,kY:()=>d,xl:()=>m,y8:()=>l});var r=o(7539),n=o(283),a=o(1345),i=o(8958),s=o(1280);function l(e,t){let o,l;switch(e){case 0:o=6,l="2em";break;case 1:o=5,l="1.2em";break;case 2:o=3,l="0.8em";break;default:o=1,l="0.5em"}l+=" helvetica, sans-serif";const d="#00007f";return new r.ZP({image:new n.Z({fill:new a.Z({color:d}),radius:o,stroke:new i.Z({color:d,width:o})}),text:new s.Z({font:l,text:t.get("n"),fill:new a.Z({color:"#ffffff"}),stroke:new i.Z({color:d,width:2})})})}const d=new r.ZP({stroke:new i.Z({color:"blue",width:2})}),c={},u={major_road:"#776",minor_road:"#ccb",highway:"#f39"},h=(new r.ZP({fill:new a.Z({color:"#666"}),stroke:new i.Z({color:"#444",width:1})}),new r.ZP({fill:new a.Z({color:"#9db9e8"})})),m=function(e){const t=e.get("kind"),o=e.get("railway"),n=e.get("sort_key"),a=t+"/"+o+"/"+n;let s=c[a];if(!s){let e,l;o?(e="#7de",l=1):(e=u[t],l="highway"==t?1.5:1),s=new r.ZP({stroke:new i.Z({color:e,width:l}),zIndex:n}),c[a]=s}return s}},5901:(e,t,o)=>{o.d(t,{B:()=>p});var r=o(2891),n=o(7205),a=o(3614),i=o.n(a),s=o(8929),l=o(7885),d=o(9646),c=o(9619),u=o(3433),h=o(8661);class m extends d.ZP{constructor(e){var t,o,r;super(),e=e||{},this.dataProjection=new c.Z({code:"",units:"tile-pixels"}),this.featureClass_=e.featureClass?e.featureClass:u.ZP,this.geometryName_=null!==(t=e.geometryName)&&void 0!==t?t:"Geometry",this.layers_=null!==(o=e.layers)&&void 0!==o?o:null,this.idProperty_=e.idProperty,this.extent=null!==(r=e.extent)&&void 0!==r?r:4096,this.supportedMediaTypes=["application/vnd-mbtiles"]}readFeature(e,t){const o=e.properties;let r;this.idProperty_?(r=o[this.idProperty_],delete o[this.idProperty_]):r=e.id;const n=e.loadGeometry(),a=[],i=[];let s=m.MBTypes[e.type];if("Unknown"===s)return null;for(let e=0;e<n.length;e++){for(let t=0;t<n[e].length;t++)a.push(n[e][t].x,n[e][t].y);i.push(a.length)}const l=new this.featureClass_(s,a,i,o,r);return l.transform(t.dataProjection),l}readFeatures(e,t){const o=this.layers_,r=[],n=new s.VectorTile(new(i())(l.ec(e)));t=this.adaptOptions(t);const a=(0,h.U2)(t.dataProjection);a.setWorldExtent(t.extent),a.setExtent([0,0,this.extent,this.extent]),t.dataProjection=a;for(const e of Object.keys(n.layers)){if(o&&!o.includes(e))continue;const a=n.layers[e];for(let o=0;o<a.length;o++){const n=a.feature(o),i=this.readFeature(n,t);i.getProperties().layer=e,r.push(i)}}return r}readProjection(e){return this.dataProjection}}m.MBTypes=["Unknown","Point","LineString","Polygon"];const w=new URL(o(421),o.b),f=new URL(o(3611),o.b);class p extends n.Z{constructor(e){var t;super(Object.assign(Object.assign({},e),{cacheSize:e.tileCacheSize,url:void 0,format:new m({layers:e.layers}),tileUrlFunction:e=>`${e[0]}:${e[1]}:${e[2]}`})),this.setTileLoadFunction(this.tileLoader.bind(this));const o={from:"inline",config:{serverMode:"full",requestChunkSize:1024,url:e.url}};this.worker=[];for(let n=0;n<(null!==(t=e.sqlWorkers)&&void 0!==t?t:4);n++)this.worker[n]=(0,r.createDbWorker)([o],w.toString(),f.toString(),10485760);this.currentWorker=0,this.metadata=this.worker[this.currentWorker++%this.worker.length].then((e=>e.db.query('SELECT name,value FROM metadata WHERE name="maxzoom" or name="minzoom"'))).then((t=>{if(t&&2==t.length){const o=t.reduce(((e,t)=>(e[t.name]=t.value,e)),{});return console.debug("Loaded metadata",o),e.maxZoom==o.maxzoom&&e.minZoom==o.minzoom||console.warn(`minZoom/maxZoom ${o.minzoom}/${o.maxzoom} of retrieved MBTiles do not match Openlayers configuration ${e.minZoom}/${e.maxZoom}`),o}throw new Error("Could not load metadata")})).catch((e=>(console.warn(e),null)))}tileLoader(e,t){console.debug("loading tile",[e.tileCoord[0],e.tileCoord[1],e.tileCoord[2]]),e.setLoader(((t,o,r)=>{this.worker[this.currentWorker++%this.worker.length].then((t=>t.db.query("SELECT tile_data FROM tiles WHERE zoom_level = ? AND tile_column = ? AND tile_row = ?",[e.tileCoord[0],e.tileCoord[1],(1<<e.tileCoord[0])-1-e.tileCoord[2]]))).then((o=>{if(o&&o[0]&&o[0].tile_data){const n=e.getFormat().readFeatures(o[0].tile_data,{extent:t,featureProjection:r});return e.setFeatures(n),void e.onLoad(n,r)}throw new Error(`No data for ${e.tileCoord}`)})).catch((t=>{console.warn(t),e.onError()}))}))}}}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LE1BQ0gsd0ZBQ0EsQ0FBQ3hDLEVBQUtxRCxVQUFVLEdBQUlyRCxFQUFLcUQsVUFBVSxJQUFLLEdBQUtyRCxFQUFLcUQsVUFBVSxJQUFNLEVBQUlyRCxFQUFLcUQsVUFBVSxPQUV4RmhCLE1BQU1JLElBQ0wsR0FBSUEsR0FBS0EsRUFBRSxJQUFNQSxFQUFFLEdBQWMsVUFBRyxDQUNsQyxNQUNNMUMsRUFEU0MsRUFBS3dELFlBQ0kxRCxhQUFhMkMsRUFBRSxHQUFjLFVBQUcsQ0FDdEQ3RCxTQUNBNkUsa0JBQW1CRixJQUlyQixPQUZBdkQsRUFBSzBELFlBQVkzRCxRQUNqQkMsRUFBSzJELE9BQU81RCxFQUFVd0QsRSxDQUd4QixNQUFNLElBQUlMLE1BQU0sZUFBZWxELEVBQUtxRCxZQUFZLElBRWpERixPQUFPQyxJQUNOUCxRQUFRSSxLQUFLRyxHQUNicEQsRUFBSzRELFNBQVMsR0FDZCxHQUVSLEUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9vbC1tYnRpbGVzLy4vZXhhbXBsZXMvY29kZS9vc20tdmVjdG9yLXRpbGVzLnRzIiwid2VicGFjazovL29sLW1idGlsZXMvLi9leGFtcGxlcy9zdHlsZS50cyIsIndlYnBhY2s6Ly9vbC1tYnRpbGVzLy4vc3JjL21idGlsZXMtZm9ybWF0LnRzIiwid2VicGFjazovL29sLW1idGlsZXMvLi9zcmMvbWJ0aWxlcy1zb3VyY2UudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IE1hcCBmcm9tICdvbC9NYXAuanMnO1xuaW1wb3J0IE9TTSBmcm9tICdvbC9zb3VyY2UvT1NNLmpzJztcbmltcG9ydCBUaWxlTGF5ZXIgZnJvbSAnb2wvbGF5ZXIvVGlsZS5qcyc7XG5pbXBvcnQgVmlldyBmcm9tICdvbC9WaWV3LmpzJztcbmltcG9ydCBWZWN0b3JUaWxlTGF5ZXIgZnJvbSAnb2wvbGF5ZXIvVmVjdG9yVGlsZSc7XG5pbXBvcnQgVGlsZURlYnVnIGZyb20gJ29sL3NvdXJjZS9UaWxlRGVidWcnO1xuaW1wb3J0IHsgZnJvbUxvbkxhdCB9IGZyb20gJ29sL3Byb2onO1xuXG5pbXBvcnQgeyBNQlRpbGVzU291cmNlIH0gZnJvbSAnb2wtbWJ0aWxlcyc7XG5pbXBvcnQgeyB3YXRlclN0eWxlLCByb2FkU3R5bGUsIGJ1aWxkaW5nU3R5bGUgfSBmcm9tICcuLi9zdHlsZSc7XG5cbi8vIE1CVGlsZXMgZnJvbVxuLy8gaHR0cHM6Ly9kYXRhLm1hcHRpbGVyLmNvbS9kb3dubG9hZHMvZGF0YXNldC9vc20vZXVyb3BlL1xuLy8gMzQuNCBHQiBvcmlnaW5hbCBmaWxlXG4vLyBkb3duIHRvIDE5LjJHQiBhZnRlciB2YWN1dW0gKE1hcFRpbGVyLCB3dGY/KVxuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiAoKSB7XG4gIGNvbnN0IG1hcCA9IG5ldyBNYXAoe1xuICAgIHRhcmdldDogJ21hcCcsXG4gICAgbGF5ZXJzOiBbXG4gICAgICBuZXcgVGlsZUxheWVyKHtcbiAgICAgICAgc291cmNlOiBuZXcgVGlsZURlYnVnKClcbiAgICAgIH0pLFxuICAgICAgbmV3IFZlY3RvclRpbGVMYXllcih7XG4gICAgICAgIHNvdXJjZTogbmV3IE1CVGlsZXNTb3VyY2Uoe1xuICAgICAgICAgIHVybDogJ2h0dHBzOi8vdmVsaXZvbGUuYi1jZG4ubmV0L21hcHRpbGVyLW9zbS0yMDE3LTA3LTAzLXYzLjYuMS1ldXJvcGUubWJ0aWxlcycsXG4gICAgICAgICAgbGF5ZXJzOiBbJ3RyYW5zcG9ydGF0aW9uJywgJ3dhdGVyJywgJ3dhdGVyd2F5J10sXG4gICAgICAgICAgYXR0cmlidXRpb25zOiBbJ01hcFRpbGVyJywgJ09TTScsICdodHRwczovL2RhdGEubWFwdGlsZXIuY29tL2Rvd25sb2Fkcy9kYXRhc2V0L29zbS9ldXJvcGUvJ10sXG4gICAgICAgICAgbWF4Wm9vbTogMTQsXG4gICAgICAgICAgbWluWm9vbTogMCxcbiAgICAgICAgICBzcWxXb3JrZXJzOiAxXG4gICAgICAgIH0pLFxuICAgICAgICBzdHlsZTogZnVuY3Rpb24gKGZlYXR1cmUsIHJlc29sdXRpb24pIHtcbiAgICAgICAgICBzd2l0Y2ggKGZlYXR1cmUuZ2V0KCdsYXllcicpKSB7XG4gICAgICAgICAgICBjYXNlICd3YXRlcic6XG4gICAgICAgICAgICBjYXNlICd3YXRlcndheSc6XG4gICAgICAgICAgICAgIHJldHVybiB3YXRlclN0eWxlO1xuICAgICAgICAgICAgY2FzZSAndHJhbnNwb3J0YXRpb24nOlxuICAgICAgICAgICAgICByZXR1cm4gcm9hZFN0eWxlKGZlYXR1cmUpO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KVxuICAgIF0sXG4gICAgdmlldzogbmV3IFZpZXcoe1xuICAgICAgY2VudGVyOiBmcm9tTG9uTGF0KFsxMiwgNTBdKSxcbiAgICAgIHpvb206IDZcbiAgICB9KSxcbiAgfSk7XG59IiwiaW1wb3J0IEZlYXR1cmUgZnJvbSAnb2wvRmVhdHVyZSc7XG5pbXBvcnQgeyBTdHlsZSwgVGV4dCwgRmlsbCwgU3Ryb2tlLCBDaXJjbGUgfSBmcm9tICdvbC9zdHlsZSc7XG5cbmV4cG9ydCBmdW5jdGlvbiBzdHlsZVRvd24oc2l6ZTogbnVtYmVyLCBmZWF0dXJlOiBGZWF0dXJlKTogU3R5bGUge1xuICBsZXQgd2lkdGg6IG51bWJlcjtcbiAgbGV0IGZvbnQ6IHN0cmluZztcbiAgc3dpdGNoIChzaXplKSB7XG4gICAgY2FzZSAwOlxuICAgICAgd2lkdGggPSA2O1xuICAgICAgZm9udCA9ICcyZW0nO1xuICAgICAgYnJlYWs7XG4gICAgY2FzZSAxOlxuICAgICAgd2lkdGggPSA1O1xuICAgICAgZm9udCA9ICcxLjJlbSc7XG4gICAgICBicmVhaztcbiAgICBjYXNlIDI6XG4gICAgICB3aWR0aCA9IDM7XG4gICAgICBmb250ID0gJzAuOGVtJztcbiAgICAgIGJyZWFrO1xuICAgIGRlZmF1bHQ6XG4gICAgICB3aWR0aCA9IDE7XG4gICAgICBmb250ID0gJzAuNWVtJztcbiAgICAgIGJyZWFrO1xuICB9XG4gIGZvbnQgKz0gJyBoZWx2ZXRpY2EsIHNhbnMtc2VyaWYnO1xuICBjb25zdCBjb2xvcjEgPSAnIzAwMDA3Zic7XG4gIGNvbnN0IGNvbG9yMiA9ICcjZmZmZmZmJztcblxuICBjb25zdCBzdHlsZSA9IG5ldyBTdHlsZSh7XG4gICAgaW1hZ2U6IG5ldyBDaXJjbGUoe1xuICAgICAgZmlsbDogbmV3IEZpbGwoe1xuICAgICAgICBjb2xvcjogY29sb3IxLFxuICAgICAgfSksXG4gICAgICByYWRpdXM6IHdpZHRoLFxuICAgICAgc3Ryb2tlOiBuZXcgU3Ryb2tlKHtcbiAgICAgICAgY29sb3I6IGNvbG9yMSxcbiAgICAgICAgd2lkdGg6IHdpZHRoLFxuICAgICAgfSksXG4gICAgfSksXG4gICAgdGV4dDogbmV3IFRleHQoe1xuICAgICAgZm9udDogZm9udCxcbiAgICAgIHRleHQ6IGZlYXR1cmUuZ2V0KCduJyksXG4gICAgICBmaWxsOiBuZXcgRmlsbCh7XG4gICAgICAgIGNvbG9yOiBjb2xvcjJcbiAgICAgIH0pLFxuICAgICAgc3Ryb2tlOiBuZXcgU3Ryb2tlKHtcbiAgICAgICAgY29sb3I6IGNvbG9yMSxcbiAgICAgICAgd2lkdGg6IDJcbiAgICAgIH0pXG4gICAgfSlcbiAgfSk7XG4gIHJldHVybiBzdHlsZTtcbn1cblxuZXhwb3J0IGNvbnN0IHN0eWxlQm9yZGVyID0gbmV3IFN0eWxlKHtcbiAgc3Ryb2tlOiBuZXcgU3Ryb2tlKHtcbiAgICBjb2xvcjogJ2JsdWUnLFxuICAgIHdpZHRoOiAyXG4gIH0pXG59KTtcblxuXG4vLyBTdHlsZXMgZnJvbSBodHRwczovL29wZW5sYXllcnMub3JnL2VuL2xhdGVzdC9leGFtcGxlcy9vc20tdmVjdG9yLXRpbGVzLmh0bWxcbmNvbnN0IHJvYWRTdHlsZUNhY2hlID0ge307XG5jb25zdCByb2FkQ29sb3IgPSB7XG4gICdtYWpvcl9yb2FkJzogJyM3NzYnLFxuICAnbWlub3Jfcm9hZCc6ICcjY2NiJyxcbiAgJ2hpZ2h3YXknOiAnI2YzOScsXG59O1xuZXhwb3J0IGNvbnN0IGJ1aWxkaW5nU3R5bGUgPSBuZXcgU3R5bGUoe1xuICBmaWxsOiBuZXcgRmlsbCh7XG4gICAgY29sb3I6ICcjNjY2J1xuICB9KSxcbiAgc3Ryb2tlOiBuZXcgU3Ryb2tlKHtcbiAgICBjb2xvcjogJyM0NDQnLFxuICAgIHdpZHRoOiAxLFxuICB9KSxcbn0pO1xuZXhwb3J0IGNvbnN0IHdhdGVyU3R5bGUgPSBuZXcgU3R5bGUoe1xuICBmaWxsOiBuZXcgRmlsbCh7XG4gICAgY29sb3I6ICcjOWRiOWU4JyxcbiAgfSksXG59KTtcbmV4cG9ydCBjb25zdCByb2FkU3R5bGUgPSBmdW5jdGlvbiAoZmVhdHVyZSkge1xuICBjb25zdCBraW5kID0gZmVhdHVyZS5nZXQoJ2tpbmQnKTtcbiAgY29uc3QgcmFpbHdheSA9IGZlYXR1cmUuZ2V0KCdyYWlsd2F5Jyk7XG4gIGNvbnN0IHNvcnRfa2V5ID0gZmVhdHVyZS5nZXQoJ3NvcnRfa2V5Jyk7XG4gIGNvbnN0IHN0eWxlS2V5ID0ga2luZCArICcvJyArIHJhaWx3YXkgKyAnLycgKyBzb3J0X2tleTtcbiAgbGV0IHN0eWxlID0gcm9hZFN0eWxlQ2FjaGVbc3R5bGVLZXldO1xuICBpZiAoIXN0eWxlKSB7XG4gICAgbGV0IGNvbG9yLCB3aWR0aDtcbiAgICBpZiAocmFpbHdheSkge1xuICAgICAgY29sb3IgPSAnIzdkZSc7XG4gICAgICB3aWR0aCA9IDE7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbG9yID0gcm9hZENvbG9yW2tpbmRdO1xuICAgICAgd2lkdGggPSBraW5kID09ICdoaWdod2F5JyA/IDEuNSA6IDE7XG4gICAgfVxuICAgIHN0eWxlID0gbmV3IFN0eWxlKHtcbiAgICAgIHN0cm9rZTogbmV3IFN0cm9rZSh7XG4gICAgICAgIGNvbG9yOiBjb2xvcixcbiAgICAgICAgd2lkdGg6IHdpZHRoLFxuICAgICAgfSksXG4gICAgICB6SW5kZXg6IHNvcnRfa2V5LFxuICAgIH0pO1xuICAgIHJvYWRTdHlsZUNhY2hlW3N0eWxlS2V5XSA9IHN0eWxlO1xuICB9XG4gIHJldHVybiBzdHlsZTtcbn07XG4iLCJpbXBvcnQgUHJvdG9idWYgZnJvbSAncGJmJztcbmltcG9ydCB7IFZlY3RvclRpbGUsIFZlY3RvclRpbGVGZWF0dXJlIH0gZnJvbSAnQG1hcGJveC92ZWN0b3ItdGlsZSc7XG5pbXBvcnQgKiBhcyBwYWtvIGZyb20gJ3Bha28nO1xuXG5pbXBvcnQgRmVhdHVyZUZvcm1hdCwgeyBSZWFkT3B0aW9ucyB9IGZyb20gJ29sL2Zvcm1hdC9GZWF0dXJlJztcbmltcG9ydCBQcm9qZWN0aW9uIGZyb20gJ29sL3Byb2ovUHJvamVjdGlvbic7XG5pbXBvcnQgUmVuZGVyRmVhdHVyZSBmcm9tICdvbC9yZW5kZXIvRmVhdHVyZSc7XG5pbXBvcnQgeyBFeHRlbnQgfSBmcm9tICdvbC9leHRlbnQnO1xuaW1wb3J0IHsgRmVhdHVyZUxpa2UgfSBmcm9tICdvbC9GZWF0dXJlJztcbmltcG9ydCB7IEdlb21ldHJ5IH0gZnJvbSAnb2wvZ2VvbSc7XG5pbXBvcnQgeyBQcm9qZWN0aW9uTGlrZSwgZ2V0IGFzIGdldFByb2plY3Rpb24gfSBmcm9tICdvbC9wcm9qJztcblxuZGVjbGFyZSBtb2R1bGUgJ0BtYXBib3gvdmVjdG9yLXRpbGUnIHtcbiAgaW50ZXJmYWNlIFZlY3RvclRpbGVGZWF0dXJlIHtcbiAgICB0b0dlb0pTT04oeDogbnVtYmVyLCB5OiBudW1iZXIsIHo6IG51bWJlciwgcHJvamVjdD86ICh4eTogW251bWJlciwgbnVtYmVyXSkgPT4gW251bWJlciwgbnVtYmVyXSk6IEdlb0pTT04uRmVhdHVyZTtcbiAgfVxufVxuXG5leHBvcnQgaW50ZXJmYWNlIE9wdGlvbnMge1xuICBsYXllcnM/OiBzdHJpbmdbXTtcbiAgZmVhdHVyZUNsYXNzPzogdHlwZW9mIFJlbmRlckZlYXR1cmU7XG4gIGdlb21ldHJ5TmFtZT86IHN0cmluZztcbiAgaWRQcm9wZXJ0eT86IHN0cmluZztcbiAgZXh0ZW50PzogbnVtYmVyO1xufTtcblxuZXhwb3J0IGNsYXNzIE1CVGlsZXNGb3JtYXQgZXh0ZW5kcyBGZWF0dXJlRm9ybWF0IHtcbiAgZGF0YVByb2plY3Rpb246IFByb2plY3Rpb247XG4gIHByaXZhdGUgZmVhdHVyZUNsYXNzXzogdHlwZW9mIFJlbmRlckZlYXR1cmU7XG4gIHByaXZhdGUgZ2VvbWV0cnlOYW1lXzogc3RyaW5nO1xuICBwcml2YXRlIGxheWVyc186IHN0cmluZ1tdIHwgbnVsbDtcbiAgcHJpdmF0ZSBpZFByb3BlcnR5Xzogc3RyaW5nO1xuICBwcml2YXRlIGxheWVyTmFtZV86IHN0cmluZztcbiAgc3VwcG9ydGVkTWVkaWFUeXBlczogc3RyaW5nW107XG4gIGV4dGVudDogbnVtYmVyO1xuICBzdGF0aWMgTUJUeXBlcyA9IFtcbiAgICAnVW5rbm93bicsICdQb2ludCcsICdMaW5lU3RyaW5nJywgJ1BvbHlnb24nXG4gIF0gYXMgKCdVbmtub3duJyB8ICdQb2ludCcgfCAnTGluZVN0cmluZycgfCAnUG9seWdvbicpW107XG5cbiAgY29uc3RydWN0b3Iob3B0aW9ucz86IE9wdGlvbnMpIHtcbiAgICBzdXBlcigpO1xuXG4gICAgb3B0aW9ucyA9IG9wdGlvbnMgPyBvcHRpb25zIDoge307XG5cbiAgICB0aGlzLmRhdGFQcm9qZWN0aW9uID0gbmV3IFByb2plY3Rpb24oe1xuICAgICAgY29kZTogJycsXG4gICAgICB1bml0czogJ3RpbGUtcGl4ZWxzJyxcbiAgICB9KTtcblxuICAgIHRoaXMuZmVhdHVyZUNsYXNzXyA9IG9wdGlvbnMuZmVhdHVyZUNsYXNzID8gb3B0aW9ucy5mZWF0dXJlQ2xhc3MgOiBSZW5kZXJGZWF0dXJlO1xuICAgIHRoaXMuZ2VvbWV0cnlOYW1lXyA9IG9wdGlvbnMuZ2VvbWV0cnlOYW1lID8/ICdHZW9tZXRyeSc7XG4gICAgdGhpcy5sYXllcnNfID0gb3B0aW9ucy5sYXllcnMgPz8gbnVsbDtcbiAgICB0aGlzLmlkUHJvcGVydHlfID0gb3B0aW9ucy5pZFByb3BlcnR5O1xuICAgIHRoaXMuZXh0ZW50ID0gb3B0aW9ucy5leHRlbnQgPz8gNDA5NjtcblxuICAgIC8qKlxuICAgICAqIEFzIHRoaXMgaXMgdGhlIHZlcnkgZmlyc3QgdGltZSBNQlRpbGVzIHdpbGwgYmUgZGlzdHJpYnV0ZWQgYnkgSFRUUFxuICAgICAqIHRoZXJlIGlzIHN0aWxsIG5vIG9mZmljaWFsIE1JTUUgdHlwZVxuICAgICAqL1xuICAgIHRoaXMuc3VwcG9ydGVkTWVkaWFUeXBlcyA9IFtcbiAgICAgICdhcHBsaWNhdGlvbi92bmQtbWJ0aWxlcydcbiAgICBdO1xuICB9XG5cbiAgcmVhZEZlYXR1cmUoc291cmNlOiBWZWN0b3JUaWxlRmVhdHVyZSwgb3B0aW9ucz86IFJlYWRPcHRpb25zKTogRmVhdHVyZUxpa2Uge1xuICAgIGNvbnN0IHByb3BlcnRpZXMgPSBzb3VyY2UucHJvcGVydGllcztcblxuICAgIGxldCBpZDogc3RyaW5nIHwgbnVtYmVyO1xuICAgIGlmICghdGhpcy5pZFByb3BlcnR5Xykge1xuICAgICAgaWQgPSBzb3VyY2UuaWQ7XG4gICAgfSBlbHNlIHtcbiAgICAgIGlkID0gcHJvcGVydGllc1t0aGlzLmlkUHJvcGVydHlfXSBhcyBzdHJpbmcgfCBudW1iZXI7XG4gICAgICBkZWxldGUgcHJvcGVydGllc1t0aGlzLmlkUHJvcGVydHlfXTtcbiAgICB9XG4gICAgY29uc3QgcG9pbnRzID0gc291cmNlLmxvYWRHZW9tZXRyeSgpO1xuICAgIGNvbnN0IGZsYXRDb29yZGluYXRlcyA9IFtdIGFzIG51bWJlcltdO1xuICAgIGNvbnN0IGVuZHMgPSBbXSBhcyBudW1iZXJbXTtcblxuICAgIGxldCB0eXBlID0gTUJUaWxlc0Zvcm1hdC5NQlR5cGVzW3NvdXJjZS50eXBlXTtcbiAgICBpZiAodHlwZSA9PT0gJ1Vua25vd24nKVxuICAgICAgcmV0dXJuIG51bGw7XG5cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHBvaW50cy5sZW5ndGg7IGkrKykge1xuICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBwb2ludHNbaV0ubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgZmxhdENvb3JkaW5hdGVzLnB1c2gocG9pbnRzW2ldW2pdLngsIHBvaW50c1tpXVtqXS55KTtcbiAgICAgIH1cbiAgICAgIGVuZHMucHVzaChmbGF0Q29vcmRpbmF0ZXMubGVuZ3RoKTtcbiAgICB9XG5cbiAgICBjb25zdCBmZWF0dXJlID0gbmV3IHRoaXMuZmVhdHVyZUNsYXNzXyh0eXBlLCBmbGF0Q29vcmRpbmF0ZXMsIGVuZHMsIHByb3BlcnRpZXMsIGlkKTtcbiAgICBmZWF0dXJlLnRyYW5zZm9ybShvcHRpb25zLmRhdGFQcm9qZWN0aW9uKTtcblxuICAgIHJldHVybiBmZWF0dXJlO1xuICB9XG5cbiAgcmVhZEZlYXR1cmVzKHNvdXJjZTogQXJyYXlCdWZmZXIsIG9wdGlvbnM/OiBSZWFkT3B0aW9ucyk6IEZlYXR1cmVMaWtlW10ge1xuICAgIGNvbnN0IGxheWVycyA9IHRoaXMubGF5ZXJzXztcblxuICAgIGNvbnN0IGZlYXR1cmVzOiBGZWF0dXJlTGlrZVtdID0gW107XG4gICAgY29uc3QgdGlsZSA9IG5ldyBWZWN0b3JUaWxlKG5ldyBQcm90b2J1ZihwYWtvLnVuZ3ppcChzb3VyY2UpKSk7XG4gICAgb3B0aW9ucyA9IHRoaXMuYWRhcHRPcHRpb25zKG9wdGlvbnMpO1xuICAgIGNvbnN0IGRhdGFQcm9qZWN0aW9uID0gZ2V0UHJvamVjdGlvbihvcHRpb25zLmRhdGFQcm9qZWN0aW9uKTtcbiAgICBkYXRhUHJvamVjdGlvbi5zZXRXb3JsZEV4dGVudChvcHRpb25zLmV4dGVudCk7XG4gICAgZGF0YVByb2plY3Rpb24uc2V0RXh0ZW50KFswLCAwLCB0aGlzLmV4dGVudCwgdGhpcy5leHRlbnRdKTtcbiAgICBvcHRpb25zLmRhdGFQcm9qZWN0aW9uID0gZGF0YVByb2plY3Rpb247XG5cbiAgICBmb3IgKGNvbnN0IGxheWVyTmFtZSBvZiBPYmplY3Qua2V5cyh0aWxlLmxheWVycykpIHtcbiAgICAgIGlmIChsYXllcnMgJiYgIWxheWVycy5pbmNsdWRlcyhsYXllck5hbWUpKSB7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuICAgICAgY29uc3QgbCA9IHRpbGUubGF5ZXJzW2xheWVyTmFtZV07XG4gICAgICBmb3IgKGxldCBpZHggPSAwOyBpZHggPCBsLmxlbmd0aDsgaWR4KyspIHtcbiAgICAgICAgY29uc3QgdmVjdG9yRmVhdHVyZSA9IGwuZmVhdHVyZShpZHgpO1xuICAgICAgICBjb25zdCBmZWF0dXJlID0gdGhpcy5yZWFkRmVhdHVyZSh2ZWN0b3JGZWF0dXJlLCBvcHRpb25zKTtcbiAgICAgICAgZmVhdHVyZS5nZXRQcm9wZXJ0aWVzKCkubGF5ZXIgPSBsYXllck5hbWU7XG4gICAgICAgIGZlYXR1cmVzLnB1c2goZmVhdHVyZSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIGZlYXR1cmVzO1xuICB9XG5cbiAgcmVhZFByb2plY3Rpb24oc291cmNlKSB7XG4gICAgcmV0dXJuIHRoaXMuZGF0YVByb2plY3Rpb247XG4gIH1cblxufSIsImltcG9ydCB7IGNyZWF0ZURiV29ya2VyLCBXb3JrZXJIdHRwdmZzIH0gZnJvbSAnc3FsLmpzLWh0dHB2ZnMnO1xuaW1wb3J0IHsgU3BsaXRGaWxlQ29uZmlnUHVyZSB9IGZyb20gJ3NxbC5qcy1odHRwdmZzL2Rpc3Qvc3FsaXRlLndvcmtlcic7XG5cbmltcG9ydCB7IEV4dGVudCB9IGZyb20gJ29sL2V4dGVudCc7XG5pbXBvcnQgeyBQcm9qZWN0aW9uTGlrZSB9IGZyb20gJ29sL3Byb2onO1xuaW1wb3J0IFZlY3RvclRpbGVTb3VyY2UsIHsgT3B0aW9ucyBhcyBWZWN0b3JUaWxlT3B0aW9ucyB9IGZyb20gJ29sL3NvdXJjZS9WZWN0b3JUaWxlLmpzJztcbmltcG9ydCBWZWN0b3JUaWxlIGZyb20gJ29sL1ZlY3RvclRpbGUnO1xuaW1wb3J0IHsgVGlsZUNvb3JkIH0gZnJvbSAnb2wvdGlsZWNvb3JkJztcbmltcG9ydCBUaWxlR3JpZCBmcm9tICdvbC90aWxlZ3JpZC9UaWxlR3JpZCc7XG5pbXBvcnQgRmVhdHVyZSBmcm9tICdvbC9GZWF0dXJlJztcbmltcG9ydCB7IEdlb21ldHJ5IH0gZnJvbSAnb2wvZ2VvbSc7XG5cbmltcG9ydCB7IE1CVGlsZXNGb3JtYXQgfSBmcm9tICcuL21idGlsZXMtZm9ybWF0JztcblxuZXhwb3J0IGludGVyZmFjZSBPcHRpb25zIGV4dGVuZHMgVmVjdG9yVGlsZU9wdGlvbnMge1xuICB0aWxlQ2FjaGVTaXplPzogbnVtYmVyO1xuICBzcWxDYWNoZVNpemU/OiBudW1iZXI7XG4gIHNxbFdvcmtlcnM/OiBudW1iZXI7XG4gIGxheWVycz86IHN0cmluZ1tdO1xufVxuXG5jb25zdCB3b3JrZXJVcmwgPSBuZXcgVVJMKFxuICAnc3FsLmpzLWh0dHB2ZnMvZGlzdC9zcWxpdGUud29ya2VyLmpzJyxcbiAgaW1wb3J0Lm1ldGEudXJsLFxuKTtcbmNvbnN0IHdhc21VcmwgPSBuZXcgVVJMKFxuICAnc3FsLmpzLWh0dHB2ZnMvZGlzdC9zcWwtd2FzbS53YXNtJyxcbiAgaW1wb3J0Lm1ldGEudXJsLFxuKTtcblxuY29uc3QgbWF4Qnl0ZXNUb1JlYWQgPSAxMCAqIDEwMjQgKiAxMDI0O1xuXG5pbnRlcmZhY2UgTWV0YWRhdGEge1xuICBtaW56b29tOiBudW1iZXI7XG4gIG1heHpvb206IG51bWJlcjtcbn07XG5cbmV4cG9ydCBjbGFzcyBNQlRpbGVzU291cmNlIGV4dGVuZHMgVmVjdG9yVGlsZVNvdXJjZSB7XG4gIHdvcmtlcjogUHJvbWlzZTxXb3JrZXJIdHRwdmZzPltdO1xuICBtZXRhZGF0YTogUHJvbWlzZTxNZXRhZGF0YSB8IG51bGw+O1xuICBjdXJyZW50V29ya2VyOiBudW1iZXI7XG5cbiAgY29uc3RydWN0b3Iob3B0aW9uczogT3B0aW9ucykge1xuICAgIHN1cGVyKHtcbiAgICAgIC4uLm9wdGlvbnMsXG4gICAgICBjYWNoZVNpemU6IG9wdGlvbnMudGlsZUNhY2hlU2l6ZSxcbiAgICAgIHVybDogdW5kZWZpbmVkLFxuICAgICAgZm9ybWF0OiBuZXcgTUJUaWxlc0Zvcm1hdCh7XG4gICAgICAgIGxheWVyczogb3B0aW9ucy5sYXllcnNcbiAgICAgIH0pLFxuICAgICAgLy8gVGhpcyBpcyByZXF1aXJlZCB0byBwcmV2ZW50IE9wZW5sYXllcnMnIGNhY2hlIGZyb20gdGhpbmtpbmcgdGhhdCBhbGwgdGlsZXMgc2hhcmUgdGhlIHNhbWUgVVJMXG4gICAgICB0aWxlVXJsRnVuY3Rpb246IChjb29yZHM6IFRpbGVDb29yZCkgPT4gYCR7Y29vcmRzWzBdfToke2Nvb3Jkc1sxXX06JHtjb29yZHNbMl19YFxuICAgIH0pO1xuXG4gICAgdGhpcy5zZXRUaWxlTG9hZEZ1bmN0aW9uKHRoaXMudGlsZUxvYWRlci5iaW5kKHRoaXMpKTtcblxuICAgIGNvbnN0IGNvbmZpZyA9IHtcbiAgICAgIGZyb206ICdpbmxpbmUnLFxuICAgICAgY29uZmlnOiB7XG4gICAgICAgIHNlcnZlck1vZGU6ICdmdWxsJyxcbiAgICAgICAgcmVxdWVzdENodW5rU2l6ZTogMTAyNCxcbiAgICAgICAgdXJsOiBvcHRpb25zLnVybFxuICAgICAgfVxuICAgIH0gYXMgU3BsaXRGaWxlQ29uZmlnUHVyZTtcblxuICAgIHRoaXMud29ya2VyID0gW107XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCAob3B0aW9ucy5zcWxXb3JrZXJzID8/IDQpOyBpKyspIHtcbiAgICAgIHRoaXMud29ya2VyW2ldID0gY3JlYXRlRGJXb3JrZXIoXG4gICAgICAgIFtjb25maWddLFxuICAgICAgICB3b3JrZXJVcmwudG9TdHJpbmcoKSxcbiAgICAgICAgd2FzbVVybC50b1N0cmluZygpLFxuICAgICAgICBtYXhCeXRlc1RvUmVhZFxuICAgICAgKTtcbiAgICB9XG4gICAgdGhpcy5jdXJyZW50V29ya2VyID0gMDtcblxuICAgIHRoaXMubWV0YWRhdGEgPSB0aGlzLndvcmtlclsodGhpcy5jdXJyZW50V29ya2VyKyspICUgdGhpcy53b3JrZXIubGVuZ3RoXVxuICAgICAgLnRoZW4oKHcpID0+IHcuZGIucXVlcnkoJ1NFTEVDVCBuYW1lLHZhbHVlIEZST00gbWV0YWRhdGEgV0hFUkUgbmFtZT1cIm1heHpvb21cIiBvciBuYW1lPVwibWluem9vbVwiJykpXG4gICAgICAudGhlbigocikgPT4ge1xuICAgICAgICAvLyBBbGFzLCBhdCB0aGUgbW9tZW50IGl0IGlzIG5vdCBwb3NzaWJsZSB0byByZXBsYWNlIHRoZSBUaWxlR3JpZCBhZnRlciBjb25zdHJ1Y3RpbmcgdGhlIGxheWVyXG4gICAgICAgIGlmIChyICYmIHIubGVuZ3RoID09IDIpIHtcbiAgICAgICAgICBjb25zdCBkYXRhID0gci5yZWR1Y2UoKGEsIHgpID0+IHtcbiAgICAgICAgICAgIGFbeFsnbmFtZSddXSA9IHhbJ3ZhbHVlJ107XG4gICAgICAgICAgICByZXR1cm4gYTtcbiAgICAgICAgICB9LCB7fSkgYXMgUmVjb3JkPHN0cmluZywgbnVtYmVyPjtcbiAgICAgICAgICBjb25zb2xlLmRlYnVnKCdMb2FkZWQgbWV0YWRhdGEnLCBkYXRhKTtcbiAgICAgICAgICBpZiAob3B0aW9ucy5tYXhab29tICE9IGRhdGEubWF4em9vbSB8fCBvcHRpb25zLm1pblpvb20gIT0gZGF0YS5taW56b29tKSB7XG4gICAgICAgICAgICBjb25zb2xlLndhcm4oYG1pblpvb20vbWF4Wm9vbSAke2RhdGEubWluem9vbX0vJHtkYXRhLm1heHpvb219YCArXG4gICAgICAgICAgICAgIGAgb2YgcmV0cmlldmVkIE1CVGlsZXMgZG8gbm90IG1hdGNoIE9wZW5sYXllcnMgY29uZmlndXJhdGlvbiAke29wdGlvbnMubWluWm9vbX0vJHtvcHRpb25zLm1heFpvb219YCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiBkYXRhIGFzIHVua25vd24gYXMgTWV0YWRhdGE7XG4gICAgICAgIH1cbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdDb3VsZCBub3QgbG9hZCBtZXRhZGF0YScpO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaChlID0+IHtcbiAgICAgICAgY29uc29sZS53YXJuKGUpO1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH0pO1xuICB9XG5cbiAgdGlsZUxvYWRlcih0aWxlOiBWZWN0b3JUaWxlLCB1cmw6IHN0cmluZykge1xuICAgIGNvbnNvbGUuZGVidWcoJ2xvYWRpbmcgdGlsZScsIFt0aWxlLnRpbGVDb29yZFswXSwgdGlsZS50aWxlQ29vcmRbMV0sIHRpbGUudGlsZUNvb3JkWzJdXSk7XG4gICAgdGlsZS5zZXRMb2FkZXIoKGV4dGVudCwgcmVzb2x1dGlvbiwgcHJvamVjdGlvbikgPT4ge1xuICAgICAgdGhpcy53b3JrZXJbKHRoaXMuY3VycmVudFdvcmtlcisrKSAlIHRoaXMud29ya2VyLmxlbmd0aF1cbiAgICAgICAgLnRoZW4oKHcpID0+XG4gICAgICAgICAgdy5kYi5xdWVyeShcbiAgICAgICAgICAgICdTRUxFQ1QgdGlsZV9kYXRhIEZST00gdGlsZXMgV0hFUkUgem9vbV9sZXZlbCA9ID8gQU5EIHRpbGVfY29sdW1uID0gPyBBTkQgdGlsZV9yb3cgPSA/JyxcbiAgICAgICAgICAgIFt0aWxlLnRpbGVDb29yZFswXSwgdGlsZS50aWxlQ29vcmRbMV0sICgxIDw8IHRpbGUudGlsZUNvb3JkWzBdKSAtIDEgLSB0aWxlLnRpbGVDb29yZFsyXV1cbiAgICAgICAgICApKVxuICAgICAgICAudGhlbigocikgPT4ge1xuICAgICAgICAgIGlmIChyICYmIHJbMF0gJiYgclswXVsndGlsZV9kYXRhJ10pIHtcbiAgICAgICAgICAgIGNvbnN0IGZvcm1hdCA9IHRpbGUuZ2V0Rm9ybWF0KCk7XG4gICAgICAgICAgICBjb25zdCBmZWF0dXJlcyA9IGZvcm1hdC5yZWFkRmVhdHVyZXMoclswXVsndGlsZV9kYXRhJ10sIHtcbiAgICAgICAgICAgICAgZXh0ZW50LFxuICAgICAgICAgICAgICBmZWF0dXJlUHJvamVjdGlvbjogcHJvamVjdGlvblxuICAgICAgICAgICAgfSkgYXMgRmVhdHVyZTxHZW9tZXRyeT5bXTtcbiAgICAgICAgICAgIHRpbGUuc2V0RmVhdHVyZXMoZmVhdHVyZXMpO1xuICAgICAgICAgICAgdGlsZS5vbkxvYWQoZmVhdHVyZXMsIHByb2plY3Rpb24pO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH1cbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYE5vIGRhdGEgZm9yICR7dGlsZS50aWxlQ29vcmR9YCk7XG4gICAgICAgIH0pXG4gICAgICAgIC5jYXRjaCgoZSkgPT4ge1xuICAgICAgICAgIGNvbnNvbGUud2FybihlKTtcbiAgICAgICAgICB0aWxlLm9uRXJyb3IoKTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJ0YXJnZXQiLCJsYXllcnMiLCJzb3VyY2UiLCJ1cmwiLCJhdHRyaWJ1dGlvbnMiLCJtYXhab29tIiwibWluWm9vbSIsInNxbFdvcmtlcnMiLCJzdHlsZSIsImZlYXR1cmUiLCJyZXNvbHV0aW9uIiwiZ2V0IiwidmlldyIsImNlbnRlciIsInpvb20iLCJzdHlsZVRvd24iLCJzaXplIiwid2lkdGgiLCJmb250IiwiY29sb3IxIiwiaW1hZ2UiLCJmaWxsIiwiY29sb3IiLCJyYWRpdXMiLCJzdHJva2UiLCJ0ZXh0Iiwic3R5bGVCb3JkZXIiLCJyb2FkU3R5bGVDYWNoZSIsInJvYWRDb2xvciIsIndhdGVyU3R5bGUiLCJyb2FkU3R5bGUiLCJraW5kIiwicmFpbHdheSIsInNvcnRfa2V5Iiwic3R5bGVLZXkiLCJ6SW5kZXgiLCJNQlRpbGVzRm9ybWF0IiwiRmVhdHVyZSIsImNvbnN0cnVjdG9yIiwib3B0aW9ucyIsInN1cGVyIiwidGhpcyIsImRhdGFQcm9qZWN0aW9uIiwiUHJvamVjdGlvbiIsImNvZGUiLCJ1bml0cyIsImZlYXR1cmVDbGFzc18iLCJmZWF0dXJlQ2xhc3MiLCJnZW9tZXRyeU5hbWVfIiwiZ2VvbWV0cnlOYW1lIiwibGF5ZXJzXyIsImlkUHJvcGVydHlfIiwiaWRQcm9wZXJ0eSIsImV4dGVudCIsInN1cHBvcnRlZE1lZGlhVHlwZXMiLCJyZWFkRmVhdHVyZSIsInByb3BlcnRpZXMiLCJpZCIsInBvaW50cyIsImxvYWRHZW9tZXRyeSIsImZsYXRDb29yZGluYXRlcyIsImVuZHMiLCJ0eXBlIiwiTUJUeXBlcyIsImkiLCJsZW5ndGgiLCJqIiwicHVzaCIsIngiLCJ5IiwidHJhbnNmb3JtIiwicmVhZEZlYXR1cmVzIiwiZmVhdHVyZXMiLCJ0aWxlIiwiVmVjdG9yVGlsZSIsImFkYXB0T3B0aW9ucyIsInNldFdvcmxkRXh0ZW50Iiwic2V0RXh0ZW50IiwibGF5ZXJOYW1lIiwiT2JqZWN0Iiwia2V5cyIsImluY2x1ZGVzIiwibCIsImlkeCIsInZlY3RvckZlYXR1cmUiLCJnZXRQcm9wZXJ0aWVzIiwibGF5ZXIiLCJyZWFkUHJvamVjdGlvbiIsIndvcmtlclVybCIsIlVSTCIsIndhc21VcmwiLCJNQlRpbGVzU291cmNlIiwiY2FjaGVTaXplIiwidGlsZUNhY2hlU2l6ZSIsInVuZGVmaW5lZCIsImZvcm1hdCIsInRpbGVVcmxGdW5jdGlvbiIsImNvb3JkcyIsInNldFRpbGVMb2FkRnVuY3Rpb24iLCJ0aWxlTG9hZGVyIiwiYmluZCIsImNvbmZpZyIsImZyb20iLCJzZXJ2ZXJNb2RlIiwicmVxdWVzdENodW5rU2l6ZSIsIndvcmtlciIsImNyZWF0ZURiV29ya2VyIiwidG9TdHJpbmciLCJjdXJyZW50V29ya2VyIiwibWV0YWRhdGEiLCJ0aGVuIiwidyIsImRiIiwicXVlcnkiLCJyIiwiZGF0YSIsInJlZHVjZSIsImEiLCJjb25zb2xlIiwiZGVidWciLCJtYXh6b29tIiwibWluem9vbSIsIndhcm4iLCJFcnJvciIsImNhdGNoIiwiZSIsInRpbGVDb29yZCIsInNldExvYWRlciIsInByb2plY3Rpb24iLCJnZXRGb3JtYXQiLCJmZWF0dXJlUHJvamVjdGlvbiIsInNldEZlYXR1cmVzIiwib25Mb2FkIiwib25FcnJvciJdLCJzb3VyY2VSb290IjoiIn0=
"use strict";(self.webpackChunkol_mbtiles=self.webpackChunkol_mbtiles||[]).push([[491],{9491:(e,t,o)=>{o.r(t),o.d(t,{default:()=>u});var r=o(8854),n=o(2479),a=o(9090),i=o(9731),l=o(6263),s=o(8661),d=o(5901),c=o(5917);function u(){return new r.Z({target:"map",layers:[new n.Z({source:new l.Z}),new i.Z({source:new d.B({url:"https://velivole.b-cdn.net/maptiler-osm-2017-07-03-v3.6.1-europe.mbtiles",layers:["transportation","water","waterway"],attributions:["MapTiler","OSM","https://data.maptiler.com/downloads/dataset/osm/europe/"],maxZoom:14,minZoom:0}),style:function(e){switch(e.get("layer")){case"water":case"waterway":return c.d_;case"transportation":return(0,c.xl)(e);default:return null}}})],view:new a.ZP({center:(0,s.mi)([12,50]),zoom:6})})}},5917:(e,t,o)=>{o.d(t,{d_:()=>m,kY:()=>d,xl:()=>h,y8:()=>s});var r=o(7539),n=o(283),a=o(1345),i=o(8958),l=o(1280);function s(e,t){let o,s;switch(e){case 0:o=6,s="2em";break;case 1:o=5,s="1.2em";break;case 2:o=3,s="0.8em";break;default:o=1,s="0.5em"}s+=" helvetica, sans-serif";const d="#00007f";return new r.ZP({image:new n.Z({fill:new a.Z({color:d}),radius:o,stroke:new i.Z({color:d,width:o})}),text:new l.Z({font:s,text:t.get("n"),fill:new a.Z({color:"#ffffff"}),stroke:new i.Z({color:d,width:2})})})}const d=new r.ZP({stroke:new i.Z({color:"blue",width:2})}),c={},u={major_road:"#776",minor_road:"#ccb",highway:"#f39"},m=(new r.ZP({fill:new a.Z({color:"#666"}),stroke:new i.Z({color:"#444",width:1})}),new r.ZP({fill:new a.Z({color:"#9db9e8"})})),h=function(e){const t=e.get("kind"),o=e.get("railway"),n=e.get("sort_key"),a=t+"/"+o+"/"+n;let l=c[a];if(!l){let e,s;o?(e="#7de",s=1):(e=u[t],s="highway"==t?1.5:1),l=new r.ZP({stroke:new i.Z({color:e,width:s}),zIndex:n}),c[a]=l}return l}},5901:(e,t,o)=>{o.d(t,{B:()=>y});var r=o(2891),n=o.n(r),a=o(7205),i=o(3614),l=o.n(i),s=o(8929),d=o(7885),c=o(9646),u=o(9619),m=o(3433),h=o(8661);class w extends c.ZP{constructor(e){var t,o,r;super(),e=e||{},this.dataProjection=new u.Z({code:"",units:"tile-pixels"}),this.featureClass_=e.featureClass?e.featureClass:m.ZP,this.geometryName_=null!==(t=e.geometryName)&&void 0!==t?t:"Geometry",this.layers_=null!==(o=e.layers)&&void 0!==o?o:null,this.idProperty_=e.idProperty,this.extent=null!==(r=e.extent)&&void 0!==r?r:4096,this.supportedMediaTypes=["application/vnd-mbtiles"]}readFeature(e,t){const o=e.properties;let r;this.idProperty_?(r=o[this.idProperty_],delete o[this.idProperty_]):r=e.id;const n=e.loadGeometry(),a=[],i=[],l=w.MBTypes[n.length>1?"multi":"mono"][e.type];if("Unknown"===l)return null;for(let e=0;e<n.length;e++)if(0!=n[e].length){for(let t=0;t<n[e].length;t++)a.push(n[e][t].x,n[e][t].y);i.push(a.length)}const s=new this.featureClass_(l,a,i,o,r);return s.transform(t.dataProjection),s}readFeatures(e,t){const o=this.layers_,r=[],n=new s.VectorTile(new(l())(d.ec(e)));t=this.adaptOptions(t);const a=(0,h.U2)(t.dataProjection);a.setWorldExtent(t.extent),a.setExtent([0,0,this.extent,this.extent]),t.dataProjection=a;for(const e of Object.keys(n.layers)){if(o&&!o.includes(e))continue;const a=n.layers[e];for(let o=0;o<a.length;o++){const n=a.feature(o),i=this.readFeature(n,t);i.getProperties().layer=e,r.push(i)}}return r}readProjection(){return this.dataProjection}}w.MBTypes={mono:["Unknown","Point","LineString","Polygon"],multi:["Unknown","MultiPoint","MultiLineString","Polygon"]};const f=null!==n()&&void 0!==n()?n():r;class y extends a.Z{constructor(e){var t,o;super(Object.assign(Object.assign({},e),{url:void 0,format:new w({layers:e.layers}),tileUrlFunction:e=>`${e[0]}:${e[1]}:${e[2]}`})),this.setTileLoadFunction(this.tileLoader.bind(this));const r={from:"inline",config:{serverMode:"full",requestChunkSize:1024,url:e.url}};this.worker=[];for(let n=0;n<(null!==(t=e.sqlWorkers)&&void 0!==t?t:4);n++)this.worker[n]=f.createDbWorker([r],y.workerUrl.toString(),y.wasmUrl.toString(),null!==(o=e.maxSingleTransfer)&&void 0!==o?o:10485760);this.currentWorker=0,this.metadata=this.worker[this.currentWorker++%this.worker.length].then((e=>e.db.query('SELECT name,value FROM metadata WHERE name="maxzoom" or name="minzoom"'))).then((t=>{if(t&&2==t.length){const o=t.reduce(((e,t)=>(e[t.name]=t.value,e)),{});return console.debug("Loaded metadata",o),e.maxZoom==o.maxzoom&&e.minZoom==o.minzoom||console.warn(`minZoom/maxZoom ${o.minzoom}/${o.maxzoom} of retrieved MBTiles do not match Openlayers configuration ${e.minZoom}/${e.maxZoom}`),o}throw new Error("Could not load metadata")})).catch((e=>(console.warn(e),null)))}tileLoader(e,t){console.debug("loading tile",[e.tileCoord[0],e.tileCoord[1],e.tileCoord[2]]),e.setLoader(((t,o,r)=>{this.worker[this.currentWorker++%this.worker.length].then((t=>t.db.query("SELECT tile_data FROM tiles WHERE zoom_level = ? AND tile_column = ? AND tile_row = ?",[e.tileCoord[0],e.tileCoord[1],(1<<e.tileCoord[0])-1-e.tileCoord[2]]))).then((o=>{if(o&&o[0]&&o[0].tile_data){const n=e.getFormat().readFeatures(o[0].tile_data,{extent:t,featureProjection:r});return e.setFeatures(n),void e.onLoad(n,r)}throw new Error(`No data for ${e.tileCoord}`)})).catch((t=>{console.warn(t),e.onError()}))}))}destroy(){for(const e of this.worker)e.then((e=>{e.release()}))}}y.workerUrl=new URL(o(421),o.b),y.wasmUrl=new URL(o(3611),o.b)}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFZQyxLQUNsQzNGLEtBQUs4RCxPQUFROUQsS0FBS3FFLGdCQUFtQnJFLEtBQUs4RCxPQUFPdkMsUUFDOUNnRCxNQUFNQyxHQUNMQSxFQUFFQyxHQUFHQyxNQUNILHdGQUNBLENBQUMxQyxFQUFLd0QsVUFBVSxHQUFJeEQsRUFBS3dELFVBQVUsSUFBSyxHQUFLeEQsRUFBS3dELFVBQVUsSUFBTSxFQUFJeEQsRUFBS3dELFVBQVUsT0FFeEZqQixNQUFNSSxJQUNMLEdBQUlBLEdBQUtBLEVBQUUsSUFBTUEsRUFBRSxHQUFjLFVBQUcsQ0FDbEMsTUFDTTVDLEVBRFNDLEVBQUs0RCxZQUNJOUQsYUFBYTZDLEVBQUUsR0FBYyxVQUFHLENBQ3REL0QsU0FDQWlGLGtCQUFtQkYsSUFJckIsT0FGQTNELEVBQUs4RCxZQUFZL0QsUUFDakJDLEVBQUsrRCxPQUFPaEUsRUFBVTRELEUsQ0FHeEIsTUFBTSxJQUFJUCxNQUFNLGVBQWVwRCxFQUFLd0QsWUFBWSxJQUVqREgsT0FBT0MsSUFDTlAsUUFBUUksS0FBS0csR0FDYnRELEVBQUtnRSxTQUFTLEdBQ2QsR0FFUixDQUVBQyxVQUNFLElBQUssTUFBTW5DLEtBQVU5RCxLQUFLOEQsT0FDeEJBLEVBQU9TLE1BQU1DLElBQ1hBLEVBQUUwQixTQUFTLEdBR2pCLEVBckdPLEVBQUFqQyxVQUFZLElBQUlrQyxJQUNyQixZQUdLLEVBQUFoQyxRQUFVLElBQUlnQyxJQUNuQixZIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vb2wtbWJ0aWxlcy8uL2V4YW1wbGVzL2NvZGUvb3NtLXZlY3Rvci10aWxlcy50cyIsIndlYnBhY2s6Ly9vbC1tYnRpbGVzLy4vZXhhbXBsZXMvc3R5bGUudHMiLCJ3ZWJwYWNrOi8vb2wtbWJ0aWxlcy8uL3NyYy9tYnRpbGVzLWZvcm1hdC50cyIsIndlYnBhY2s6Ly9vbC1tYnRpbGVzLy4vc3JjL21idGlsZXMtc291cmNlLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBNYXAgZnJvbSAnb2wvTWFwLmpzJztcbmltcG9ydCBUaWxlTGF5ZXIgZnJvbSAnb2wvbGF5ZXIvVGlsZS5qcyc7XG5pbXBvcnQgVmlldyBmcm9tICdvbC9WaWV3LmpzJztcbmltcG9ydCBWZWN0b3JUaWxlTGF5ZXIgZnJvbSAnb2wvbGF5ZXIvVmVjdG9yVGlsZSc7XG5pbXBvcnQgVGlsZURlYnVnIGZyb20gJ29sL3NvdXJjZS9UaWxlRGVidWcnO1xuaW1wb3J0IHsgZnJvbUxvbkxhdCB9IGZyb20gJ29sL3Byb2onO1xuXG5pbXBvcnQgeyBNQlRpbGVzU291cmNlIH0gZnJvbSAnb2wtbWJ0aWxlcyc7XG5pbXBvcnQgeyB3YXRlclN0eWxlLCByb2FkU3R5bGUgfSBmcm9tICcuLi9zdHlsZSc7XG5cbi8vIE1CVGlsZXMgZnJvbVxuLy8gaHR0cHM6Ly9kYXRhLm1hcHRpbGVyLmNvbS9kb3dubG9hZHMvZGF0YXNldC9vc20vZXVyb3BlL1xuLy8gMzQuNCBHQiBvcmlnaW5hbCBmaWxlXG4vLyBkb3duIHRvIDE5LjJHQiBhZnRlciB2YWN1dW0gKE1hcFRpbGVyLCB3dGY/KVxuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiAoKSB7XG4gIHJldHVybiBuZXcgTWFwKHtcbiAgICB0YXJnZXQ6ICdtYXAnLFxuICAgIGxheWVyczogW1xuICAgICAgbmV3IFRpbGVMYXllcih7XG4gICAgICAgIHNvdXJjZTogbmV3IFRpbGVEZWJ1ZygpXG4gICAgICB9KSxcbiAgICAgIG5ldyBWZWN0b3JUaWxlTGF5ZXIoe1xuICAgICAgICBzb3VyY2U6IG5ldyBNQlRpbGVzU291cmNlKHtcbiAgICAgICAgICB1cmw6ICdodHRwczovL3ZlbGl2b2xlLmItY2RuLm5ldC9tYXB0aWxlci1vc20tMjAxNy0wNy0wMy12My42LjEtZXVyb3BlLm1idGlsZXMnLFxuICAgICAgICAgIGxheWVyczogWyd0cmFuc3BvcnRhdGlvbicsICd3YXRlcicsICd3YXRlcndheSddLFxuICAgICAgICAgIGF0dHJpYnV0aW9uczogWydNYXBUaWxlcicsICdPU00nLCAnaHR0cHM6Ly9kYXRhLm1hcHRpbGVyLmNvbS9kb3dubG9hZHMvZGF0YXNldC9vc20vZXVyb3BlLyddLFxuICAgICAgICAgIG1heFpvb206IDE0LFxuICAgICAgICAgIG1pblpvb206IDBcbiAgICAgICAgfSksXG4gICAgICAgIHN0eWxlOiBmdW5jdGlvbiAoZmVhdHVyZSkge1xuICAgICAgICAgIHN3aXRjaCAoZmVhdHVyZS5nZXQoJ2xheWVyJykpIHtcbiAgICAgICAgICAgIGNhc2UgJ3dhdGVyJzpcbiAgICAgICAgICAgIGNhc2UgJ3dhdGVyd2F5JzpcbiAgICAgICAgICAgICAgcmV0dXJuIHdhdGVyU3R5bGU7XG4gICAgICAgICAgICBjYXNlICd0cmFuc3BvcnRhdGlvbic6XG4gICAgICAgICAgICAgIHJldHVybiByb2FkU3R5bGUoZmVhdHVyZSk7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pXG4gICAgXSxcbiAgICB2aWV3OiBuZXcgVmlldyh7XG4gICAgICBjZW50ZXI6IGZyb21Mb25MYXQoWzEyLCA1MF0pLFxuICAgICAgem9vbTogNlxuICAgIH0pLFxuICB9KTtcbn0iLCJpbXBvcnQgRmVhdHVyZSBmcm9tICdvbC9GZWF0dXJlJztcbmltcG9ydCB7IFN0eWxlLCBUZXh0LCBGaWxsLCBTdHJva2UsIENpcmNsZSB9IGZyb20gJ29sL3N0eWxlJztcblxuZXhwb3J0IGZ1bmN0aW9uIHN0eWxlVG93bihzaXplOiBudW1iZXIsIGZlYXR1cmU6IEZlYXR1cmUpOiBTdHlsZSB7XG4gIGxldCB3aWR0aDogbnVtYmVyO1xuICBsZXQgZm9udDogc3RyaW5nO1xuICBzd2l0Y2ggKHNpemUpIHtcbiAgICBjYXNlIDA6XG4gICAgICB3aWR0aCA9IDY7XG4gICAgICBmb250ID0gJzJlbSc7XG4gICAgICBicmVhaztcbiAgICBjYXNlIDE6XG4gICAgICB3aWR0aCA9IDU7XG4gICAgICBmb250ID0gJzEuMmVtJztcbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgMjpcbiAgICAgIHdpZHRoID0gMztcbiAgICAgIGZvbnQgPSAnMC44ZW0nO1xuICAgICAgYnJlYWs7XG4gICAgZGVmYXVsdDpcbiAgICAgIHdpZHRoID0gMTtcbiAgICAgIGZvbnQgPSAnMC41ZW0nO1xuICAgICAgYnJlYWs7XG4gIH1cbiAgZm9udCArPSAnIGhlbHZldGljYSwgc2Fucy1zZXJpZic7XG4gIGNvbnN0IGNvbG9yMSA9ICcjMDAwMDdmJztcbiAgY29uc3QgY29sb3IyID0gJyNmZmZmZmYnO1xuXG4gIGNvbnN0IHN0eWxlID0gbmV3IFN0eWxlKHtcbiAgICBpbWFnZTogbmV3IENpcmNsZSh7XG4gICAgICBmaWxsOiBuZXcgRmlsbCh7XG4gICAgICAgIGNvbG9yOiBjb2xvcjEsXG4gICAgICB9KSxcbiAgICAgIHJhZGl1czogd2lkdGgsXG4gICAgICBzdHJva2U6IG5ldyBTdHJva2Uoe1xuICAgICAgICBjb2xvcjogY29sb3IxLFxuICAgICAgICB3aWR0aDogd2lkdGgsXG4gICAgICB9KSxcbiAgICB9KSxcbiAgICB0ZXh0OiBuZXcgVGV4dCh7XG4gICAgICBmb250OiBmb250LFxuICAgICAgdGV4dDogZmVhdHVyZS5nZXQoJ24nKSxcbiAgICAgIGZpbGw6IG5ldyBGaWxsKHtcbiAgICAgICAgY29sb3I6IGNvbG9yMlxuICAgICAgfSksXG4gICAgICBzdHJva2U6IG5ldyBTdHJva2Uoe1xuICAgICAgICBjb2xvcjogY29sb3IxLFxuICAgICAgICB3aWR0aDogMlxuICAgICAgfSlcbiAgICB9KVxuICB9KTtcbiAgcmV0dXJuIHN0eWxlO1xufVxuXG5leHBvcnQgY29uc3Qgc3R5bGVCb3JkZXIgPSBuZXcgU3R5bGUoe1xuICBzdHJva2U6IG5ldyBTdHJva2Uoe1xuICAgIGNvbG9yOiAnYmx1ZScsXG4gICAgd2lkdGg6IDJcbiAgfSlcbn0pO1xuXG5cbi8vIFN0eWxlcyBmcm9tIGh0dHBzOi8vb3BlbmxheWVycy5vcmcvZW4vbGF0ZXN0L2V4YW1wbGVzL29zbS12ZWN0b3ItdGlsZXMuaHRtbFxuY29uc3Qgcm9hZFN0eWxlQ2FjaGUgPSB7fTtcbmNvbnN0IHJvYWRDb2xvciA9IHtcbiAgJ21ham9yX3JvYWQnOiAnIzc3NicsXG4gICdtaW5vcl9yb2FkJzogJyNjY2InLFxuICAnaGlnaHdheSc6ICcjZjM5Jyxcbn07XG5leHBvcnQgY29uc3QgYnVpbGRpbmdTdHlsZSA9IG5ldyBTdHlsZSh7XG4gIGZpbGw6IG5ldyBGaWxsKHtcbiAgICBjb2xvcjogJyM2NjYnXG4gIH0pLFxuICBzdHJva2U6IG5ldyBTdHJva2Uoe1xuICAgIGNvbG9yOiAnIzQ0NCcsXG4gICAgd2lkdGg6IDEsXG4gIH0pLFxufSk7XG5leHBvcnQgY29uc3Qgd2F0ZXJTdHlsZSA9IG5ldyBTdHlsZSh7XG4gIGZpbGw6IG5ldyBGaWxsKHtcbiAgICBjb2xvcjogJyM5ZGI5ZTgnLFxuICB9KSxcbn0pO1xuZXhwb3J0IGNvbnN0IHJvYWRTdHlsZSA9IGZ1bmN0aW9uIChmZWF0dXJlKSB7XG4gIGNvbnN0IGtpbmQgPSBmZWF0dXJlLmdldCgna2luZCcpO1xuICBjb25zdCByYWlsd2F5ID0gZmVhdHVyZS5nZXQoJ3JhaWx3YXknKTtcbiAgY29uc3Qgc29ydF9rZXkgPSBmZWF0dXJlLmdldCgnc29ydF9rZXknKTtcbiAgY29uc3Qgc3R5bGVLZXkgPSBraW5kICsgJy8nICsgcmFpbHdheSArICcvJyArIHNvcnRfa2V5O1xuICBsZXQgc3R5bGUgPSByb2FkU3R5bGVDYWNoZVtzdHlsZUtleV07XG4gIGlmICghc3R5bGUpIHtcbiAgICBsZXQgY29sb3IsIHdpZHRoO1xuICAgIGlmIChyYWlsd2F5KSB7XG4gICAgICBjb2xvciA9ICcjN2RlJztcbiAgICAgIHdpZHRoID0gMTtcbiAgICB9IGVsc2Uge1xuICAgICAgY29sb3IgPSByb2FkQ29sb3Jba2luZF07XG4gICAgICB3aWR0aCA9IGtpbmQgPT0gJ2hpZ2h3YXknID8gMS41IDogMTtcbiAgICB9XG4gICAgc3R5bGUgPSBuZXcgU3R5bGUoe1xuICAgICAgc3Ryb2tlOiBuZXcgU3Ryb2tlKHtcbiAgICAgICAgY29sb3I6IGNvbG9yLFxuICAgICAgICB3aWR0aDogd2lkdGgsXG4gICAgICB9KSxcbiAgICAgIHpJbmRleDogc29ydF9rZXksXG4gICAgfSk7XG4gICAgcm9hZFN0eWxlQ2FjaGVbc3R5bGVLZXldID0gc3R5bGU7XG4gIH1cbiAgcmV0dXJuIHN0eWxlO1xufTtcbiIsImltcG9ydCBQcm90b2J1ZiBmcm9tICdwYmYnO1xuaW1wb3J0IHsgVmVjdG9yVGlsZSwgVmVjdG9yVGlsZUZlYXR1cmUgfSBmcm9tICdAbWFwYm94L3ZlY3Rvci10aWxlJztcbmltcG9ydCAqIGFzIHBha28gZnJvbSAncGFrbyc7XG5cbmltcG9ydCBGZWF0dXJlRm9ybWF0LCB7IFJlYWRPcHRpb25zIH0gZnJvbSAnb2wvZm9ybWF0L0ZlYXR1cmUuanMnO1xuaW1wb3J0IFByb2plY3Rpb24gZnJvbSAnb2wvcHJvai9Qcm9qZWN0aW9uLmpzJztcbmltcG9ydCBSZW5kZXJGZWF0dXJlIGZyb20gJ29sL3JlbmRlci9GZWF0dXJlLmpzJztcbmltcG9ydCB7IEZlYXR1cmVMaWtlIH0gZnJvbSAnb2wvRmVhdHVyZS5qcyc7XG5pbXBvcnQgeyBnZXQgYXMgZ2V0UHJvamVjdGlvbiB9IGZyb20gJ29sL3Byb2ouanMnO1xuaW1wb3J0IHsgVHlwZSB9IGZyb20gJ29sL2dlb20vR2VvbWV0cnknO1xuXG5kZWNsYXJlIG1vZHVsZSAnQG1hcGJveC92ZWN0b3ItdGlsZScge1xuICBpbnRlcmZhY2UgVmVjdG9yVGlsZUZlYXR1cmUge1xuICAgIHRvR2VvSlNPTih4OiBudW1iZXIsIHk6IG51bWJlciwgejogbnVtYmVyLCBwcm9qZWN0PzogKHh5OiBbbnVtYmVyLCBudW1iZXJdKSA9PiBbbnVtYmVyLCBudW1iZXJdKTogR2VvSlNPTi5GZWF0dXJlO1xuICB9XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgT3B0aW9ucyB7XG4gIGxheWVycz86IHN0cmluZ1tdO1xuICBmZWF0dXJlQ2xhc3M/OiB0eXBlb2YgUmVuZGVyRmVhdHVyZTtcbiAgZ2VvbWV0cnlOYW1lPzogc3RyaW5nO1xuICBpZFByb3BlcnR5Pzogc3RyaW5nO1xuICBleHRlbnQ/OiBudW1iZXI7XG59XG5cbmV4cG9ydCBjbGFzcyBNQlRpbGVzRm9ybWF0IGV4dGVuZHMgRmVhdHVyZUZvcm1hdCB7XG4gIGRhdGFQcm9qZWN0aW9uOiBQcm9qZWN0aW9uO1xuICBwcml2YXRlIGZlYXR1cmVDbGFzc186IHR5cGVvZiBSZW5kZXJGZWF0dXJlO1xuICBwcml2YXRlIGdlb21ldHJ5TmFtZV86IHN0cmluZztcbiAgcHJpdmF0ZSBsYXllcnNfOiBzdHJpbmdbXSB8IG51bGw7XG4gIHByaXZhdGUgaWRQcm9wZXJ0eV86IHN0cmluZztcbiAgc3VwcG9ydGVkTWVkaWFUeXBlczogc3RyaW5nW107XG4gIGV4dGVudDogbnVtYmVyO1xuICBzdGF0aWMgTUJUeXBlcyA9IHtcbiAgICBtb25vOiBbJ1Vua25vd24nLCAnUG9pbnQnLCAnTGluZVN0cmluZycsICdQb2x5Z29uJyBdLFxuICAgIG11bHRpOiBbJ1Vua25vd24nLCAnTXVsdGlQb2ludCcsICdNdWx0aUxpbmVTdHJpbmcnLCAnUG9seWdvbiddXG4gICB9IGFzIFJlY29yZDwnbW9ubycgfCAnbXVsdGknLCAoVHlwZSB8ICdVbmtub3duJylbXT47XG5cbiAgY29uc3RydWN0b3Iob3B0aW9ucz86IE9wdGlvbnMpIHtcbiAgICBzdXBlcigpO1xuXG4gICAgb3B0aW9ucyA9IG9wdGlvbnMgPyBvcHRpb25zIDoge307XG5cbiAgICB0aGlzLmRhdGFQcm9qZWN0aW9uID0gbmV3IFByb2plY3Rpb24oe1xuICAgICAgY29kZTogJycsXG4gICAgICB1bml0czogJ3RpbGUtcGl4ZWxzJyxcbiAgICB9KTtcblxuICAgIHRoaXMuZmVhdHVyZUNsYXNzXyA9IG9wdGlvbnMuZmVhdHVyZUNsYXNzID8gb3B0aW9ucy5mZWF0dXJlQ2xhc3MgOiBSZW5kZXJGZWF0dXJlO1xuICAgIHRoaXMuZ2VvbWV0cnlOYW1lXyA9IG9wdGlvbnMuZ2VvbWV0cnlOYW1lID8/ICdHZW9tZXRyeSc7XG4gICAgdGhpcy5sYXllcnNfID0gb3B0aW9ucy5sYXllcnMgPz8gbnVsbDtcbiAgICB0aGlzLmlkUHJvcGVydHlfID0gb3B0aW9ucy5pZFByb3BlcnR5O1xuICAgIHRoaXMuZXh0ZW50ID0gb3B0aW9ucy5leHRlbnQgPz8gNDA5NjtcblxuICAgIC8qKlxuICAgICAqIEFzIHRoaXMgaXMgdGhlIHZlcnkgZmlyc3QgdGltZSBNQlRpbGVzIHdpbGwgYmUgZGlzdHJpYnV0ZWQgYnkgSFRUUFxuICAgICAqIHRoZXJlIGlzIHN0aWxsIG5vIG9mZmljaWFsIE1JTUUgdHlwZVxuICAgICAqL1xuICAgIHRoaXMuc3VwcG9ydGVkTWVkaWFUeXBlcyA9IFtcbiAgICAgICdhcHBsaWNhdGlvbi92bmQtbWJ0aWxlcydcbiAgICBdO1xuICB9XG5cbiAgcmVhZEZlYXR1cmUoc291cmNlOiBWZWN0b3JUaWxlRmVhdHVyZSwgb3B0aW9ucz86IFJlYWRPcHRpb25zKTogRmVhdHVyZUxpa2Uge1xuICAgIGNvbnN0IHByb3BlcnRpZXMgPSBzb3VyY2UucHJvcGVydGllcztcblxuICAgIGxldCBpZDogc3RyaW5nIHwgbnVtYmVyO1xuICAgIGlmICghdGhpcy5pZFByb3BlcnR5Xykge1xuICAgICAgaWQgPSBzb3VyY2UuaWQ7XG4gICAgfSBlbHNlIHtcbiAgICAgIGlkID0gcHJvcGVydGllc1t0aGlzLmlkUHJvcGVydHlfXSBhcyBzdHJpbmcgfCBudW1iZXI7XG4gICAgICBkZWxldGUgcHJvcGVydGllc1t0aGlzLmlkUHJvcGVydHlfXTtcbiAgICB9XG4gICAgY29uc3QgcG9pbnRzID0gc291cmNlLmxvYWRHZW9tZXRyeSgpO1xuICAgIGNvbnN0IGZsYXRDb29yZGluYXRlcyA9IFtdIGFzIG51bWJlcltdO1xuICAgIGNvbnN0IGVuZHMgPSBbXSBhcyBudW1iZXJbXTtcblxuICAgIGNvbnN0IHR5cGU6IFR5cGUgfCAnVW5rbm93bicgPSBNQlRpbGVzRm9ybWF0Lk1CVHlwZXNbcG9pbnRzLmxlbmd0aCA+IDEgPyAnbXVsdGknIDogJ21vbm8nXVtzb3VyY2UudHlwZV07XG4gICAgaWYgKHR5cGUgPT09ICdVbmtub3duJylcbiAgICAgIHJldHVybiBudWxsO1xuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBwb2ludHMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGlmIChwb2ludHNbaV0ubGVuZ3RoID09IDApXG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBwb2ludHNbaV0ubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgZmxhdENvb3JkaW5hdGVzLnB1c2gocG9pbnRzW2ldW2pdLngsIHBvaW50c1tpXVtqXS55KTtcbiAgICAgIH1cbiAgICAgIGVuZHMucHVzaChmbGF0Q29vcmRpbmF0ZXMubGVuZ3RoKTtcbiAgICB9XG5cbiAgICBjb25zdCBmZWF0dXJlID0gbmV3IHRoaXMuZmVhdHVyZUNsYXNzXyh0eXBlLCBmbGF0Q29vcmRpbmF0ZXMsIGVuZHMsIHByb3BlcnRpZXMsIGlkKTtcbiAgICBmZWF0dXJlLnRyYW5zZm9ybShvcHRpb25zLmRhdGFQcm9qZWN0aW9uKTtcblxuICAgIHJldHVybiBmZWF0dXJlO1xuICB9XG5cbiAgcmVhZEZlYXR1cmVzKHNvdXJjZTogQXJyYXlCdWZmZXIsIG9wdGlvbnM/OiBSZWFkT3B0aW9ucyk6IEZlYXR1cmVMaWtlW10ge1xuICAgIGNvbnN0IGxheWVycyA9IHRoaXMubGF5ZXJzXztcblxuICAgIGNvbnN0IGZlYXR1cmVzOiBGZWF0dXJlTGlrZVtdID0gW107XG4gICAgY29uc3QgdGlsZSA9IG5ldyBWZWN0b3JUaWxlKG5ldyBQcm90b2J1ZihwYWtvLnVuZ3ppcChzb3VyY2UpKSk7XG4gICAgb3B0aW9ucyA9IHRoaXMuYWRhcHRPcHRpb25zKG9wdGlvbnMpO1xuICAgIGNvbnN0IGRhdGFQcm9qZWN0aW9uID0gZ2V0UHJvamVjdGlvbihvcHRpb25zLmRhdGFQcm9qZWN0aW9uKTtcbiAgICBkYXRhUHJvamVjdGlvbi5zZXRXb3JsZEV4dGVudChvcHRpb25zLmV4dGVudCk7XG4gICAgZGF0YVByb2plY3Rpb24uc2V0RXh0ZW50KFswLCAwLCB0aGlzLmV4dGVudCwgdGhpcy5leHRlbnRdKTtcbiAgICBvcHRpb25zLmRhdGFQcm9qZWN0aW9uID0gZGF0YVByb2plY3Rpb247XG5cbiAgICBmb3IgKGNvbnN0IGxheWVyTmFtZSBvZiBPYmplY3Qua2V5cyh0aWxlLmxheWVycykpIHtcbiAgICAgIGlmIChsYXllcnMgJiYgIWxheWVycy5pbmNsdWRlcyhsYXllck5hbWUpKSB7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuICAgICAgY29uc3QgbCA9IHRpbGUubGF5ZXJzW2xheWVyTmFtZV07XG4gICAgICBmb3IgKGxldCBpZHggPSAwOyBpZHggPCBsLmxlbmd0aDsgaWR4KyspIHtcbiAgICAgICAgY29uc3QgdmVjdG9yRmVhdHVyZSA9IGwuZmVhdHVyZShpZHgpO1xuICAgICAgICBjb25zdCBmZWF0dXJlID0gdGhpcy5yZWFkRmVhdHVyZSh2ZWN0b3JGZWF0dXJlLCBvcHRpb25zKTtcbiAgICAgICAgZmVhdHVyZS5nZXRQcm9wZXJ0aWVzKCkubGF5ZXIgPSBsYXllck5hbWU7XG4gICAgICAgIGZlYXR1cmVzLnB1c2goZmVhdHVyZSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIGZlYXR1cmVzO1xuICB9XG5cbiAgcmVhZFByb2plY3Rpb24oKSB7XG4gICAgcmV0dXJuIHRoaXMuZGF0YVByb2plY3Rpb247XG4gIH1cblxufSIsIi8vIFdoeSBpcyB0aGlzIGhvcnJvciBuZWNlc3Nhcnk/XG4vLyBCZWNhdXNlIG9mIGh0dHBzOi8vZ2l0aHViLmNvbS9ub2RlanMvY2pzLW1vZHVsZS1sZXhlci9wdWxsLzI0XG5pbXBvcnQgc3FsaHR0cERlZmF1bHQgZnJvbSAnc3FsLmpzLWh0dHB2ZnMnO1xuaW1wb3J0ICogYXMgc3FsaHR0cEFsbCBmcm9tICdzcWwuanMtaHR0cHZmcyc7XG5jb25zdCBzcWxodHRwID0gc3FsaHR0cERlZmF1bHQgPz8gc3FsaHR0cEFsbDtcbmltcG9ydCB0eXBlIHsgV29ya2VySHR0cHZmcyB9IGZyb20gJ3NxbC5qcy1odHRwdmZzJztcbmltcG9ydCB7IFNwbGl0RmlsZUNvbmZpZ1B1cmUgfSBmcm9tICdzcWwuanMtaHR0cHZmcy9kaXN0L3NxbGl0ZS53b3JrZXInO1xuXG5pbXBvcnQgVmVjdG9yVGlsZVNvdXJjZSwgeyBPcHRpb25zIGFzIFZlY3RvclRpbGVPcHRpb25zIH0gZnJvbSAnb2wvc291cmNlL1ZlY3RvclRpbGUuanMnO1xuaW1wb3J0IFZlY3RvclRpbGUgZnJvbSAnb2wvVmVjdG9yVGlsZS5qcyc7XG5pbXBvcnQgeyBUaWxlQ29vcmQgfSBmcm9tICdvbC90aWxlY29vcmQuanMnO1xuaW1wb3J0IEZlYXR1cmUgZnJvbSAnb2wvRmVhdHVyZS5qcyc7XG5pbXBvcnQgeyBHZW9tZXRyeSB9IGZyb20gJ29sL2dlb20uanMnO1xuXG5pbXBvcnQgeyBNQlRpbGVzRm9ybWF0IH0gZnJvbSAnLi9tYnRpbGVzLWZvcm1hdCc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgT3B0aW9ucyBleHRlbmRzIFZlY3RvclRpbGVPcHRpb25zIHtcbiAgLyoqXG4gICAqIE51bWJlciBvZiBwYXJhbGxlbCB3b3JrZXJzIHRvIHVzZSBmb3IgcmV0cmlldmluZyB0aWxlcywgQGRlZmF1bHQgNFxuICAgKi9cbiAgc3FsV29ya2Vycz86IG51bWJlcjtcbiAgLyoqXG4gICAqIExpc3Qgb2YgbGF5ZXIgbmFtZXMgdG8gc2VsZWN0aXZlbHkgaW5jbHVkZSwgQGRlZmF1bHQgZXZlcnl0aGluZ1xuICAgKi9cbiAgbGF5ZXJzPzogc3RyaW5nW107XG4gIC8qKlxuICAgKiBNYXhpbXVtIGFtb3VudCBvZiBieXRlcyB0byB0cmFuc2ZlciBmb3IgYSBzaW5nbGUgdGlsZS5cbiAgICogVGhpcyBpcyBhIHByb3RlY3Rpb24gYWdhaW5zdCByZXF1ZXN0aW5nIGZyb20gYSBkYXRhYmFzZSB3aXRob3V0IGluZGV4LlxuICAgKiBAZGVmYXVsdCAxMDQ4NTc2MFxuICAgKi9cbiAgbWF4U2luZ2xlVHJhbnNmZXI/OiBudW1iZXI7XG5cbiAgdGlsZVVybEZ1bmN0aW9uPzogbmV2ZXI7XG4gIHRpbGVMb2FkRnVuY3Rpb24/OiBuZXZlcjtcbiAgZm9ybWF0PzogbmV2ZXI7XG59XG5cbmludGVyZmFjZSBNZXRhZGF0YSB7XG4gIG1pbnpvb206IG51bWJlcjtcbiAgbWF4em9vbTogbnVtYmVyO1xufVxuXG4vKipcbiAqIEEgdGlsZSBzb3VyY2UgaW4gYSByZW1vdGUgLm1idGlsZXMgZmlsZSBhY2Nlc3NpYmxlIGJ5IEhUVFBcbiAqL1xuZXhwb3J0IGNsYXNzIE1CVGlsZXNTb3VyY2UgZXh0ZW5kcyBWZWN0b3JUaWxlU291cmNlIHtcbiAgcHJpdmF0ZSB3b3JrZXI6IFByb21pc2U8V29ya2VySHR0cHZmcz5bXTtcbiAgcHJpdmF0ZSBjdXJyZW50V29ya2VyOiBudW1iZXI7XG4gIG1ldGFkYXRhOiBQcm9taXNlPE1ldGFkYXRhIHwgbnVsbD47XG4gIHN0YXRpYyB3b3JrZXJVcmwgPSBuZXcgVVJMKFxuICAgICdzcWwuanMtaHR0cHZmcy9kaXN0L3NxbGl0ZS53b3JrZXIuanMnLFxuICAgIGltcG9ydC5tZXRhLnVybCxcbiAgKTtcbiAgc3RhdGljIHdhc21VcmwgPSBuZXcgVVJMKFxuICAgICdzcWwuanMtaHR0cHZmcy9kaXN0L3NxbC13YXNtLndhc20nLFxuICAgIGltcG9ydC5tZXRhLnVybCxcbiAgKTsgXG5cbiAgY29uc3RydWN0b3Iob3B0aW9uczogT3B0aW9ucykge1xuICAgIHN1cGVyKHtcbiAgICAgIC4uLm9wdGlvbnMsXG4gICAgICB1cmw6IHVuZGVmaW5lZCxcbiAgICAgIGZvcm1hdDogbmV3IE1CVGlsZXNGb3JtYXQoe1xuICAgICAgICBsYXllcnM6IG9wdGlvbnMubGF5ZXJzXG4gICAgICB9KSxcbiAgICAgIC8vIFRoaXMgaXMgcmVxdWlyZWQgdG8gcHJldmVudCBPcGVubGF5ZXJzJyBjYWNoZSBmcm9tIHRoaW5raW5nIHRoYXQgYWxsIHRpbGVzIHNoYXJlIHRoZSBzYW1lIFVSTFxuICAgICAgdGlsZVVybEZ1bmN0aW9uOiAoY29vcmRzOiBUaWxlQ29vcmQpID0+IGAke2Nvb3Jkc1swXX06JHtjb29yZHNbMV19OiR7Y29vcmRzWzJdfWBcbiAgICB9KTtcblxuICAgIHRoaXMuc2V0VGlsZUxvYWRGdW5jdGlvbih0aGlzLnRpbGVMb2FkZXIuYmluZCh0aGlzKSk7XG5cbiAgICBjb25zdCBjb25maWcgPSB7XG4gICAgICBmcm9tOiAnaW5saW5lJyxcbiAgICAgIGNvbmZpZzoge1xuICAgICAgICBzZXJ2ZXJNb2RlOiAnZnVsbCcsXG4gICAgICAgIHJlcXVlc3RDaHVua1NpemU6IDEwMjQsXG4gICAgICAgIHVybDogb3B0aW9ucy51cmxcbiAgICAgIH1cbiAgICB9IGFzIFNwbGl0RmlsZUNvbmZpZ1B1cmU7XG5cbiAgICB0aGlzLndvcmtlciA9IFtdO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgKG9wdGlvbnMuc3FsV29ya2VycyA/PyA0KTsgaSsrKSB7XG4gICAgICB0aGlzLndvcmtlcltpXSA9IHNxbGh0dHAuY3JlYXRlRGJXb3JrZXIoXG4gICAgICAgIFtjb25maWddLFxuICAgICAgICBNQlRpbGVzU291cmNlLndvcmtlclVybC50b1N0cmluZygpLFxuICAgICAgICBNQlRpbGVzU291cmNlLndhc21VcmwudG9TdHJpbmcoKSxcbiAgICAgICAgb3B0aW9ucy5tYXhTaW5nbGVUcmFuc2ZlciA/PyAxMDI0ICogMTAyNCAqIDEwXG4gICAgICApO1xuICAgIH1cbiAgICB0aGlzLmN1cnJlbnRXb3JrZXIgPSAwO1xuXG4gICAgdGhpcy5tZXRhZGF0YSA9IHRoaXMud29ya2VyWyh0aGlzLmN1cnJlbnRXb3JrZXIrKykgJSB0aGlzLndvcmtlci5sZW5ndGhdXG4gICAgICAudGhlbigodykgPT4gdy5kYi5xdWVyeSgnU0VMRUNUIG5hbWUsdmFsdWUgRlJPTSBtZXRhZGF0YSBXSEVSRSBuYW1lPVwibWF4em9vbVwiIG9yIG5hbWU9XCJtaW56b29tXCInKSlcbiAgICAgIC50aGVuKChyKSA9PiB7XG4gICAgICAgIC8vIEFsYXMsIGF0IHRoZSBtb21lbnQgaXQgaXMgbm90IHBvc3NpYmxlIHRvIHJlcGxhY2UgdGhlIFRpbGVHcmlkIGFmdGVyIGNvbnN0cnVjdGluZyB0aGUgbGF5ZXJcbiAgICAgICAgaWYgKHIgJiYgci5sZW5ndGggPT0gMikge1xuICAgICAgICAgIGNvbnN0IGRhdGEgPSByLnJlZHVjZSgoYSwgeCkgPT4ge1xuICAgICAgICAgICAgYVt4WyduYW1lJ11dID0geFsndmFsdWUnXTtcbiAgICAgICAgICAgIHJldHVybiBhO1xuICAgICAgICAgIH0sIHt9KSBhcyBSZWNvcmQ8c3RyaW5nLCBudW1iZXI+O1xuICAgICAgICAgIGNvbnNvbGUuZGVidWcoJ0xvYWRlZCBtZXRhZGF0YScsIGRhdGEpO1xuICAgICAgICAgIGlmIChvcHRpb25zLm1heFpvb20gIT0gZGF0YS5tYXh6b29tIHx8IG9wdGlvbnMubWluWm9vbSAhPSBkYXRhLm1pbnpvb20pIHtcbiAgICAgICAgICAgIGNvbnNvbGUud2FybihgbWluWm9vbS9tYXhab29tICR7ZGF0YS5taW56b29tfS8ke2RhdGEubWF4em9vbX1gICtcbiAgICAgICAgICAgICAgYCBvZiByZXRyaWV2ZWQgTUJUaWxlcyBkbyBub3QgbWF0Y2ggT3BlbmxheWVycyBjb25maWd1cmF0aW9uICR7b3B0aW9ucy5taW5ab29tfS8ke29wdGlvbnMubWF4Wm9vbX1gKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIGRhdGEgYXMgdW5rbm93biBhcyBNZXRhZGF0YTtcbiAgICAgICAgfVxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0NvdWxkIG5vdCBsb2FkIG1ldGFkYXRhJyk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKGUgPT4ge1xuICAgICAgICBjb25zb2xlLndhcm4oZSk7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfSk7XG4gIH1cblxuICBwcml2YXRlIHRpbGVMb2FkZXIodGlsZTogVmVjdG9yVGlsZSwgX3VybDogc3RyaW5nKSB7XG4gICAgY29uc29sZS5kZWJ1ZygnbG9hZGluZyB0aWxlJywgW3RpbGUudGlsZUNvb3JkWzBdLCB0aWxlLnRpbGVDb29yZFsxXSwgdGlsZS50aWxlQ29vcmRbMl1dKTtcbiAgICB0aWxlLnNldExvYWRlcigoZXh0ZW50LCByZXNvbHV0aW9uLCBwcm9qZWN0aW9uKSA9PiB7XG4gICAgICB0aGlzLndvcmtlclsodGhpcy5jdXJyZW50V29ya2VyKyspICUgdGhpcy53b3JrZXIubGVuZ3RoXVxuICAgICAgICAudGhlbigodykgPT5cbiAgICAgICAgICB3LmRiLnF1ZXJ5KFxuICAgICAgICAgICAgJ1NFTEVDVCB0aWxlX2RhdGEgRlJPTSB0aWxlcyBXSEVSRSB6b29tX2xldmVsID0gPyBBTkQgdGlsZV9jb2x1bW4gPSA/IEFORCB0aWxlX3JvdyA9ID8nLFxuICAgICAgICAgICAgW3RpbGUudGlsZUNvb3JkWzBdLCB0aWxlLnRpbGVDb29yZFsxXSwgKDEgPDwgdGlsZS50aWxlQ29vcmRbMF0pIC0gMSAtIHRpbGUudGlsZUNvb3JkWzJdXVxuICAgICAgICAgICkpXG4gICAgICAgIC50aGVuKChyKSA9PiB7XG4gICAgICAgICAgaWYgKHIgJiYgclswXSAmJiByWzBdWyd0aWxlX2RhdGEnXSkge1xuICAgICAgICAgICAgY29uc3QgZm9ybWF0ID0gdGlsZS5nZXRGb3JtYXQoKTtcbiAgICAgICAgICAgIGNvbnN0IGZlYXR1cmVzID0gZm9ybWF0LnJlYWRGZWF0dXJlcyhyWzBdWyd0aWxlX2RhdGEnXSwge1xuICAgICAgICAgICAgICBleHRlbnQsXG4gICAgICAgICAgICAgIGZlYXR1cmVQcm9qZWN0aW9uOiBwcm9qZWN0aW9uXG4gICAgICAgICAgICB9KSBhcyBGZWF0dXJlPEdlb21ldHJ5PltdO1xuICAgICAgICAgICAgdGlsZS5zZXRGZWF0dXJlcyhmZWF0dXJlcyk7XG4gICAgICAgICAgICB0aWxlLm9uTG9hZChmZWF0dXJlcywgcHJvamVjdGlvbik7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgTm8gZGF0YSBmb3IgJHt0aWxlLnRpbGVDb29yZH1gKTtcbiAgICAgICAgfSlcbiAgICAgICAgLmNhdGNoKChlKSA9PiB7XG4gICAgICAgICAgY29uc29sZS53YXJuKGUpO1xuICAgICAgICAgIHRpbGUub25FcnJvcigpO1xuICAgICAgICB9KTtcbiAgICB9KTtcbiAgfVxuXG4gIGRlc3Ryb3koKSB7XG4gICAgZm9yIChjb25zdCB3b3JrZXIgb2YgdGhpcy53b3JrZXIpIHtcbiAgICAgIHdvcmtlci50aGVuKCh3KSA9PiB7XG4gICAgICAgIHcucmVsZWFzZSgpO1xuICAgICAgfSk7XG4gICAgfVxuICB9XG59XG4iXSwibmFtZXMiOlsidGFyZ2V0IiwibGF5ZXJzIiwic291cmNlIiwidXJsIiwiYXR0cmlidXRpb25zIiwibWF4Wm9vbSIsIm1pblpvb20iLCJzdHlsZSIsImZlYXR1cmUiLCJnZXQiLCJ2aWV3IiwiY2VudGVyIiwiem9vbSIsInN0eWxlVG93biIsInNpemUiLCJ3aWR0aCIsImZvbnQiLCJjb2xvcjEiLCJpbWFnZSIsImZpbGwiLCJjb2xvciIsInJhZGl1cyIsInN0cm9rZSIsInRleHQiLCJzdHlsZUJvcmRlciIsInJvYWRTdHlsZUNhY2hlIiwicm9hZENvbG9yIiwid2F0ZXJTdHlsZSIsInJvYWRTdHlsZSIsImtpbmQiLCJyYWlsd2F5Iiwic29ydF9rZXkiLCJzdHlsZUtleSIsInpJbmRleCIsIk1CVGlsZXNGb3JtYXQiLCJGZWF0dXJlIiwiY29uc3RydWN0b3IiLCJvcHRpb25zIiwic3VwZXIiLCJ0aGlzIiwiZGF0YVByb2plY3Rpb24iLCJQcm9qZWN0aW9uIiwiY29kZSIsInVuaXRzIiwiZmVhdHVyZUNsYXNzXyIsImZlYXR1cmVDbGFzcyIsImdlb21ldHJ5TmFtZV8iLCJnZW9tZXRyeU5hbWUiLCJsYXllcnNfIiwiaWRQcm9wZXJ0eV8iLCJpZFByb3BlcnR5IiwiZXh0ZW50Iiwic3VwcG9ydGVkTWVkaWFUeXBlcyIsInJlYWRGZWF0dXJlIiwicHJvcGVydGllcyIsImlkIiwicG9pbnRzIiwibG9hZEdlb21ldHJ5IiwiZmxhdENvb3JkaW5hdGVzIiwiZW5kcyIsInR5cGUiLCJNQlR5cGVzIiwibGVuZ3RoIiwiaSIsImoiLCJwdXNoIiwieCIsInkiLCJ0cmFuc2Zvcm0iLCJyZWFkRmVhdHVyZXMiLCJmZWF0dXJlcyIsInRpbGUiLCJWZWN0b3JUaWxlIiwiYWRhcHRPcHRpb25zIiwic2V0V29ybGRFeHRlbnQiLCJzZXRFeHRlbnQiLCJsYXllck5hbWUiLCJPYmplY3QiLCJrZXlzIiwiaW5jbHVkZXMiLCJsIiwiaWR4IiwidmVjdG9yRmVhdHVyZSIsImdldFByb3BlcnRpZXMiLCJsYXllciIsInJlYWRQcm9qZWN0aW9uIiwibW9ubyIsIm11bHRpIiwic3FsaHR0cCIsIk1CVGlsZXNTb3VyY2UiLCJ1bmRlZmluZWQiLCJmb3JtYXQiLCJ0aWxlVXJsRnVuY3Rpb24iLCJjb29yZHMiLCJzZXRUaWxlTG9hZEZ1bmN0aW9uIiwidGlsZUxvYWRlciIsImJpbmQiLCJjb25maWciLCJmcm9tIiwic2VydmVyTW9kZSIsInJlcXVlc3RDaHVua1NpemUiLCJ3b3JrZXIiLCJzcWxXb3JrZXJzIiwiY3JlYXRlRGJXb3JrZXIiLCJ3b3JrZXJVcmwiLCJ0b1N0cmluZyIsIndhc21VcmwiLCJtYXhTaW5nbGVUcmFuc2ZlciIsImN1cnJlbnRXb3JrZXIiLCJtZXRhZGF0YSIsInRoZW4iLCJ3IiwiZGIiLCJxdWVyeSIsInIiLCJkYXRhIiwicmVkdWNlIiwiYSIsImNvbnNvbGUiLCJkZWJ1ZyIsIm1heHpvb20iLCJtaW56b29tIiwid2FybiIsIkVycm9yIiwiY2F0Y2giLCJlIiwiX3VybCIsInRpbGVDb29yZCIsInNldExvYWRlciIsInJlc29sdXRpb24iLCJwcm9qZWN0aW9uIiwiZ2V0Rm9ybWF0IiwiZmVhdHVyZVByb2plY3Rpb24iLCJzZXRGZWF0dXJlcyIsIm9uTG9hZCIsIm9uRXJyb3IiLCJkZXN0cm95IiwicmVsZWFzZSIsIlVSTCJdLCJzb3VyY2VSb290IjoiIn0=
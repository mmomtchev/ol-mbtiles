"use strict";(self.webpackChunkol_mbtiles=self.webpackChunkol_mbtiles||[]).push([[824],{4824:(e,o,t)=>{t.r(o),t.d(o,{default:()=>p});var n=t(8854),r=t(8266),i=t(2479),l=t(9090),s=t(9731),a=t(6263),c=t(8661),d=t(5686),u=t(5917),h=function(e,o,t,n){return new(t||(t=Promise))((function(r,i){function l(e){try{a(n.next(e))}catch(e){i(e)}}function s(e){try{a(n.throw(e))}catch(e){i(e)}}function a(e){var o;e.done?r(e.value):(o=e.value,o instanceof t?o:new t((function(e){e(o)}))).then(l,s)}a((n=n.apply(e,o||[])).next())}))};function p(){return h(this,void 0,void 0,(function*(){return new n.Z({target:"map",layers:[new i.Z({source:new r.Z}),new i.Z({source:new a.Z}),new s.Z({source:new d.H5(yield(0,d.ri)({url:"https://velivole.b-cdn.net/mbtiles/place/0.mbtiles"})),style:u.y8.bind(null,0),renderBuffer:1024,minZoom:6}),new s.Z({source:new d.H5(yield(0,d.ri)({url:"https://velivole.b-cdn.net/mbtiles/place/1.mbtiles"})),style:u.y8.bind(null,1),renderBuffer:256,minZoom:8}),new s.Z({source:new d.H5(yield(0,d.ri)({url:"https://velivole.b-cdn.net/mbtiles/place/2.mbtiles"})),style:u.y8.bind(null,2),minZoom:10})],view:new l.ZP({center:(0,c.mi)([6,45]),zoom:8})})}))}},5917:(e,o,t)=>{t.d(o,{Hh:()=>Z,Xu:()=>h,d_:()=>p,kY:()=>c,oj:()=>w,xl:()=>m,y8:()=>a});var n=t(7539),r=t(283),i=t(1345),l=t(8958),s=t(1280);function a(e,o){let t,a;switch(e){case 0:t=6,a="2em";break;case 1:t=5,a="1.2em";break;case 2:t=3,a="0.8em";break;default:t=1,a="0.5em"}a+=" helvetica, sans-serif";const c="#00007f";return new n.ZP({image:new r.Z({fill:new i.Z({color:c}),radius:t,stroke:new l.Z({color:c,width:t})}),text:new s.Z({font:a,text:o.get("n"),fill:new i.Z({color:"#ffffff"}),stroke:new l.Z({color:c,width:2})})})}const c=new n.ZP({stroke:new l.Z({color:"blue",width:2})}),d={},u={motorway:"#776",trunk:"#ccb",highway:"#f39"},h=new n.ZP({fill:new i.Z({color:"#666"}),stroke:new l.Z({color:"#444",width:1})}),p=new n.ZP({fill:new i.Z({color:"#9db9e8"})}),w=new n.ZP({stroke:new l.Z({color:"#8B008B",width:2})}),m=function(e){const o=e.get("class"),t=e.get("railway"),r=e.get("sort_key"),i=o+"/"+t+"/"+r;let s=d[i];if(!s){let e,a;t?(e="#7de",a=1):(e=u[o],a="highway"==o?1.5:1),s=new n.ZP({stroke:new l.Z({color:e,width:a}),zIndex:r}),d[i]=s}return s},f=new n.ZP({image:new r.Z({radius:5,fill:new i.Z({color:"#000080"})})}),v=new l.Z({color:"white",width:2}),Z=function(e){if("country"==e.get("class"))return null;if(e.get("name")){const o=f.clone();return o.setText(new s.Z({text:e.get("name"),offsetY:-5,font:"bold 16px sans-serif",stroke:v})),o}return null}},5686:(e,o,t)=>{t.d(o,{Yr:()=>P,H5:()=>b,ri:()=>u});var n,r=t(9759),i=t(8661),l=t(8641),s=t(8738);const a="undefined"!=typeof OL_MBTILES_DEBUG&&OL_MBTILES_DEBUG||"undefined"!=typeof process&&void 0!==(null===(n=null===process||void 0===process?void 0:process.env)||void 0===n?void 0:n.OL_MBTILES_DEBUG)&&process.env.OL_MBTILES_DEBUG?console.debug.bind(console):()=>{},c={jpg:"raster",png:"raster",webp:"raster",pbf:"vector",mvt:"vector"};function d(e){var o,t,n;return{workers:null!==(o=null==e?void 0:e.sqlWorkers)&&void 0!==o?o:4,httpOptions:{maxPageSize:null!==(t=null==e?void 0:e.maxSqlPageSize)&&void 0!==t?t:4096,cacheSize:null!==(n=null==e?void 0:e.sqlCacheSize)&&void 0!==n?n:4096}}}function u(e){const o=(0,r.he)(d(e)).then((o=>o.open(e.url).then((()=>o))));return o.then((e=>e.exec("SELECT name,value FROM metadata"))).then((e=>{if(e&&e.length){const o=e.reduce(((e,o)=>(e[o.row[0]]=o.row[1],e)),{});return a("Loaded metadata",o),o}throw new Error("Could not load metadata")})).then((t=>{var n,r,a,d,u,h,p,w;const m=Object.assign({},e),f=null===(r=null===(n=t.format)||void 0===n?void 0:n.toLowerCase)||void 0===r?void 0:r.call(n);c[f]||console.warn("Unknown tile format",f),m.projection=null!==(a=e.projection)&&void 0!==a?a:"EPSG:3857",m.attributions=null!==(d=t.attribution)&&void 0!==d?d:t.description,m.maxZoom=null!==(u=e.maxZoom)&&void 0!==u?u:+t.maxzoom,m.minZoom=null!==(h=e.minZoom)&&void 0!==h?h:+t.minzoom;const v=null===(w=null===(p=(0,i.U2)(m.projection))||void 0===p?void 0:p.getExtent)||void 0===w?void 0:w.call(p),Z=t.bounds,g=Z?(0,i.$A)(Z.split(",").map((e=>+e)),"EPSG:4326",m.projection):v;if("raster"===c[f]){if(void 0===m.maxZoom||void 0===m.minZoom||void 0===v)throw new Error("Cannot determine tilegrid, need minZoom, maxZoom");const e=[(0,l.dz)(v)/256];for(let o=1;o<=m.maxZoom;o++)e.push(e[e.length-1]/2);m.tileGrid=new s.Z({origin:[v[0],v[2]],extent:g,minZoom:m.minZoom,resolutions:e})}else m.extent=v;return m.pool=o,m.url=e.url,m}))}var h=t(7205),p=t(3614),w=t.n(p),m=t(8929),f=t(7885),v=t(9646),Z=t(9619),g=t(3433);class y extends v.ZP{constructor(e){var o,t,n;super(),e=e||{},this.dataProjection=new Z.Z({code:"",units:"tile-pixels"}),this.featureClass_=e.featureClass?e.featureClass:g.ZP,this.geometryName_=null!==(o=e.geometryName)&&void 0!==o?o:"Geometry",this.layers_=null!==(t=e.layers)&&void 0!==t?t:null,this.idProperty_=e.idProperty,this.extent=null!==(n=e.extent)&&void 0!==n?n:4096,this.supportedMediaTypes=["application/vnd-mbtiles"]}readFeature(e,o){const t=e.properties;let n;this.idProperty_?(n=t[this.idProperty_],delete t[this.idProperty_]):n=e.id;const r=e.loadGeometry(),i=[],l=[],s=y.MBTypes[r.length>1?"multi":"mono"][e.type];if("Unknown"===s)return null;for(let e=0;e<r.length;e++)if(0!=r[e].length){for(let o=0;o<r[e].length;o++)i.push(r[e][o].x,r[e][o].y);l.push(i.length)}const a=new this.featureClass_(s,i,l,t,n);return a.transform(null==o?void 0:o.dataProjection),a}readFeatures(e,o){const t=this.layers_,n=[],r=new m.VectorTile(new(w())(f.ZP.ungzip(e)));o=this.adaptOptions(o);const l=(0,i.U2)(null==o?void 0:o.dataProjection),s=null==o?void 0:o.extent;if(!l||!o||!s)throw new Error("Cannot determine the projection/extent");l.setWorldExtent(s),l.setExtent([0,0,this.extent,this.extent]),o.dataProjection=l;for(const e of Object.keys(r.layers)){if(t&&!t.includes(e))continue;const i=r.layers[e];for(let t=0;t<i.length;t++){const r=i.feature(t),l=this.readFeature(r,o);l.getProperties().layer=e,n.push(l)}}return n}readProjection(){return this.dataProjection}}y.MBTypes={mono:["Unknown","Point","LineString","Polygon"],multi:["Unknown","MultiPoint","MultiLineString","Polygon"]};class b extends h.Z{constructor(e){var o;if(void 0===e.url&&void 0===e.pool)throw new Error("Must specify url");super(Object.assign(Object.assign({},e),{url:void 0,format:new y({layers:e.layers}),tileUrlFunction:o=>`${e.url}#${o[0]}:${o[1]}:${o[2]}`})),this.setTileLoadFunction(this.tileLoader.bind(this)),this.pool=null!==(o=e.pool)&&void 0!==o?o:(0,r.he)(d(e)).then((o=>o.open(e.url).then((()=>o))))}tileLoader(e,o){const t=e;a("loading tile",[t.tileCoord[0],t.tileCoord[1],t.tileCoord[2]]),t.setLoader(((e,o,n)=>{this.pool.then((e=>e.exec("SELECT tile_data FROM tiles WHERE zoom_level = $zoom AND tile_column = $col AND tile_row = $row",{$zoom:t.tileCoord[0],$col:t.tileCoord[1],$row:(1<<t.tileCoord[0])-1-t.tileCoord[2]}))).then((o=>{if(o&&o[0]&&o[0].row[0]){const r=t.getFormat().readFeatures(o[0].row[0],{extent:e,featureProjection:n});return t.setFeatures(r),void t.onLoad(r,n)}throw new Error(`No data for ${t.tileCoord}`)})).catch((e=>{a(e),t.onError()}))}))}disposeInternal(){return this.pool.then((e=>e.close()))}}var x=t(928),E=t(7195);class P extends x.Z{constructor(e){var o;if(void 0===e.url&&void 0===e.pool)throw new Error("Must specify url");super(Object.assign(Object.assign({},e),{url:void 0,tileUrlFunction:o=>`${e.url}#${o[0]}:${o[1]}:${o[2]}`})),this.setTileLoadFunction(this.tileLoader.bind(this)),this.pool=null!==(o=e.pool)&&void 0!==o?o:(0,r.he)(d(e)).then((o=>o.open(e.url).then((()=>o))))}tileLoader(e,o){a("loading tile",[e.tileCoord[0],e.tileCoord[1],e.tileCoord[2]]);const t=e.getImage();this.pool.then((o=>o.exec("SELECT tile_data FROM tiles WHERE zoom_level = $zoom AND tile_column = $col AND tile_row = $row",{$zoom:e.tileCoord[0],$col:e.tileCoord[1],$row:(1<<e.tileCoord[0])-1-e.tileCoord[2]}))).then((o=>{if(!(o&&o[0]&&o[0].row[0]instanceof Uint8Array))throw new Error(`No data for ${e.tileCoord}`);{const e=new Blob([o[0].row[0]]),n=URL.createObjectURL(e);t.src=n}})).catch((o=>{a(o),e.setState(E.Z.ERROR)}))}disposeInternal(){return this.pool.then((e=>e.close()))}}},8266:(e,o,t)=>{t.d(o,{Z:()=>i});var n=t(4680);class r extends n.Z{constructor(e){let o;o=void 0!==(e=e||{}).attributions?e.attributions:['&#169; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors.'];const t=void 0!==e.crossOrigin?e.crossOrigin:"anonymous",n=void 0!==e.url?e.url:"https://tile.openstreetmap.org/{z}/{x}/{y}.png";super({attributions:o,attributionsCollapsible:!1,cacheSize:e.cacheSize,crossOrigin:t,interpolate:e.interpolate,maxZoom:void 0!==e.maxZoom?e.maxZoom:19,opaque:void 0===e.opaque||e.opaque,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileLoadFunction:e.tileLoadFunction,transition:e.transition,url:n,wrapX:e.wrapX,zDirection:e.zDirection})}}const i=r}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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UU0sVUFDbkIySCxZQUFhQSxFQUNiRSxZQUFhbkksRUFBUW1JLFlBQ3JCbkcsYUFBNkJPLElBQXBCdkMsRUFBUWdDLFFBQXdCaEMsRUFBUWdDLFFBQVUsR0FDM0RvRyxZQUEyQjdGLElBQW5CdkMsRUFBUW9JLFFBQXVCcEksRUFBUW9JLE9BQy9DQywyQkFBNEJySSxFQUFRcUksMkJBQ3BDQyxpQkFBa0J0SSxFQUFRc0ksaUJBQzFCQyxXQUFZdkksRUFBUXVJLFdBQ3BCckwsSUFBS0EsRUFDTHNMLE1BQU94SSxFQUFRd0ksTUFDZkMsV0FBWXpJLEVBQVF5SSxZQUV4QixFQUdGLFMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9vbC1tYnRpbGVzLy4vZXhhbXBsZXMvY29kZS92ZWxpdm9sZS50cyIsIndlYnBhY2s6Ly9vbC1tYnRpbGVzLy4vZXhhbXBsZXMvc3R5bGUudHMiLCJ3ZWJwYWNrOi8vb2wtbWJ0aWxlcy8uL3NyYy9kZWJ1Zy50cyIsIndlYnBhY2s6Ly9vbC1tYnRpbGVzLy4vc3JjL21idGlsZXMudHMiLCJ3ZWJwYWNrOi8vb2wtbWJ0aWxlcy8uL3NyYy9tYnRpbGVzLWZvcm1hdC50cyIsIndlYnBhY2s6Ly9vbC1tYnRpbGVzLy4vc3JjL21idGlsZXMtdmVjdG9yLXNvdXJjZS50cyIsIndlYnBhY2s6Ly9vbC1tYnRpbGVzLy4vc3JjL21idGlsZXMtcmFzdGVyLXNvdXJjZS50cyIsIndlYnBhY2s6Ly9vbC1tYnRpbGVzLy4vbm9kZV9tb2R1bGVzL29sL3NvdXJjZS9PU00uanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IE1hcCBmcm9tICdvbC9NYXAuanMnO1xuaW1wb3J0IE9TTSBmcm9tICdvbC9zb3VyY2UvT1NNLmpzJztcbmltcG9ydCBUaWxlTGF5ZXIgZnJvbSAnb2wvbGF5ZXIvVGlsZS5qcyc7XG5pbXBvcnQgVmlldyBmcm9tICdvbC9WaWV3LmpzJztcbmltcG9ydCBWZWN0b3JUaWxlTGF5ZXIgZnJvbSAnb2wvbGF5ZXIvVmVjdG9yVGlsZSc7XG5pbXBvcnQgVGlsZURlYnVnIGZyb20gJ29sL3NvdXJjZS9UaWxlRGVidWcnO1xuaW1wb3J0IHsgZnJvbUxvbkxhdCB9IGZyb20gJ29sL3Byb2onO1xuXG5pbXBvcnQgeyBpbXBvcnRNQlRpbGVzLCBNQlRpbGVzVmVjdG9yU291cmNlIH0gZnJvbSAnb2wtbWJ0aWxlcyc7XG5pbXBvcnQgeyBzdHlsZVRvd24gfSBmcm9tICcuLi9zdHlsZSc7XG5cbmV4cG9ydCBkZWZhdWx0IGFzeW5jIGZ1bmN0aW9uICgpIHtcbiAgcmV0dXJuIG5ldyBNYXAoe1xuICAgIHRhcmdldDogJ21hcCcsXG4gICAgbGF5ZXJzOiBbXG4gICAgICBuZXcgVGlsZUxheWVyKHtcbiAgICAgICAgc291cmNlOiBuZXcgT1NNKCksXG4gICAgICB9KSxcbiAgICAgIG5ldyBUaWxlTGF5ZXIoe1xuICAgICAgICBzb3VyY2U6IG5ldyBUaWxlRGVidWcoKVxuICAgICAgfSksXG4gICAgICBuZXcgVmVjdG9yVGlsZUxheWVyKHtcbiAgICAgICAgc291cmNlOiBuZXcgTUJUaWxlc1ZlY3RvclNvdXJjZShhd2FpdCBpbXBvcnRNQlRpbGVzKHtcbiAgICAgICAgICB1cmw6ICdodHRwczovL3ZlbGl2b2xlLmItY2RuLm5ldC9tYnRpbGVzL3BsYWNlLzAubWJ0aWxlcycsXG4gICAgICAgIH0pKSxcbiAgICAgICAgc3R5bGU6IHN0eWxlVG93bi5iaW5kKG51bGwsIDApLFxuICAgICAgICByZW5kZXJCdWZmZXI6IDEwMjQsXG4gICAgICAgIG1pblpvb206IDZcbiAgICAgIH0pLFxuICAgICAgbmV3IFZlY3RvclRpbGVMYXllcih7XG4gICAgICAgIHNvdXJjZTogbmV3IE1CVGlsZXNWZWN0b3JTb3VyY2UoYXdhaXQgaW1wb3J0TUJUaWxlcyh7XG4gICAgICAgICAgdXJsOiAnaHR0cHM6Ly92ZWxpdm9sZS5iLWNkbi5uZXQvbWJ0aWxlcy9wbGFjZS8xLm1idGlsZXMnLFxuICAgICAgICB9KSksXG4gICAgICAgIHN0eWxlOiBzdHlsZVRvd24uYmluZChudWxsLCAxKSxcbiAgICAgICAgcmVuZGVyQnVmZmVyOiAyNTYsXG4gICAgICAgIG1pblpvb206IDhcbiAgICAgIH0pLFxuICAgICAgbmV3IFZlY3RvclRpbGVMYXllcih7XG4gICAgICAgIHNvdXJjZTogbmV3IE1CVGlsZXNWZWN0b3JTb3VyY2UoYXdhaXQgaW1wb3J0TUJUaWxlcyh7XG4gICAgICAgICAgdXJsOiAnaHR0cHM6Ly92ZWxpdm9sZS5iLWNkbi5uZXQvbWJ0aWxlcy9wbGFjZS8yLm1idGlsZXMnLFxuICAgICAgICB9KSksXG4gICAgICAgIHN0eWxlOiBzdHlsZVRvd24uYmluZChudWxsLCAyKSxcbiAgICAgICAgbWluWm9vbTogMTBcbiAgICAgIH0pLFxuICAgIF0sXG4gICAgdmlldzogbmV3IFZpZXcoe1xuICAgICAgY2VudGVyOiBmcm9tTG9uTGF0KFs2LCA0NV0pLFxuICAgICAgem9vbTogOFxuICAgIH0pLFxuICB9KTtcbn0iLCJpbXBvcnQgeyBGZWF0dXJlTGlrZSB9IGZyb20gJ29sL0ZlYXR1cmUnO1xuaW1wb3J0IHsgU3R5bGUsIFRleHQsIEZpbGwsIFN0cm9rZSwgQ2lyY2xlIH0gZnJvbSAnb2wvc3R5bGUnO1xuXG5leHBvcnQgZnVuY3Rpb24gc3R5bGVUb3duKHNpemU6IG51bWJlciwgZmVhdHVyZTogRmVhdHVyZUxpa2UpOiBTdHlsZSB7XG4gIGxldCB3aWR0aDogbnVtYmVyO1xuICBsZXQgZm9udDogc3RyaW5nO1xuICBzd2l0Y2ggKHNpemUpIHtcbiAgICBjYXNlIDA6XG4gICAgICB3aWR0aCA9IDY7XG4gICAgICBmb250ID0gJzJlbSc7XG4gICAgICBicmVhaztcbiAgICBjYXNlIDE6XG4gICAgICB3aWR0aCA9IDU7XG4gICAgICBmb250ID0gJzEuMmVtJztcbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgMjpcbiAgICAgIHdpZHRoID0gMztcbiAgICAgIGZvbnQgPSAnMC44ZW0nO1xuICAgICAgYnJlYWs7XG4gICAgZGVmYXVsdDpcbiAgICAgIHdpZHRoID0gMTtcbiAgICAgIGZvbnQgPSAnMC41ZW0nO1xuICAgICAgYnJlYWs7XG4gIH1cbiAgZm9udCArPSAnIGhlbHZldGljYSwgc2Fucy1zZXJpZic7XG4gIGNvbnN0IGNvbG9yMSA9ICcjMDAwMDdmJztcbiAgY29uc3QgY29sb3IyID0gJyNmZmZmZmYnO1xuXG4gIGNvbnN0IHN0eWxlID0gbmV3IFN0eWxlKHtcbiAgICBpbWFnZTogbmV3IENpcmNsZSh7XG4gICAgICBmaWxsOiBuZXcgRmlsbCh7XG4gICAgICAgIGNvbG9yOiBjb2xvcjEsXG4gICAgICB9KSxcbiAgICAgIHJhZGl1czogd2lkdGgsXG4gICAgICBzdHJva2U6IG5ldyBTdHJva2Uoe1xuICAgICAgICBjb2xvcjogY29sb3IxLFxuICAgICAgICB3aWR0aDogd2lkdGgsXG4gICAgICB9KSxcbiAgICB9KSxcbiAgICB0ZXh0OiBuZXcgVGV4dCh7XG4gICAgICBmb250OiBmb250LFxuICAgICAgdGV4dDogZmVhdHVyZS5nZXQoJ24nKSxcbiAgICAgIGZpbGw6IG5ldyBGaWxsKHtcbiAgICAgICAgY29sb3I6IGNvbG9yMlxuICAgICAgfSksXG4gICAgICBzdHJva2U6IG5ldyBTdHJva2Uoe1xuICAgICAgICBjb2xvcjogY29sb3IxLFxuICAgICAgICB3aWR0aDogMlxuICAgICAgfSlcbiAgICB9KVxuICB9KTtcbiAgcmV0dXJuIHN0eWxlO1xufVxuXG5leHBvcnQgY29uc3Qgc3R5bGVCb3JkZXIgPSBuZXcgU3R5bGUoe1xuICBzdHJva2U6IG5ldyBTdHJva2Uoe1xuICAgIGNvbG9yOiAnYmx1ZScsXG4gICAgd2lkdGg6IDJcbiAgfSlcbn0pO1xuXG5cbi8vIFN0eWxlcyBpbnNwaXJlZCBmcm9tIGh0dHBzOi8vb3BlbmxheWVycy5vcmcvZW4vbGF0ZXN0L2V4YW1wbGVzL29zbS12ZWN0b3ItdGlsZXMuaHRtbFxuY29uc3Qgcm9hZFN0eWxlQ2FjaGU6IFJlY29yZDxzdHJpbmcsIFN0eWxlPiA9IHt9O1xuY29uc3Qgcm9hZENvbG9yOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge1xuICAnbW90b3J3YXknOiAnIzc3NicsXG4gICd0cnVuayc6ICcjY2NiJyxcbiAgJ2hpZ2h3YXknOiAnI2YzOScsXG59O1xuZXhwb3J0IGNvbnN0IGJ1aWxkaW5nU3R5bGUgPSBuZXcgU3R5bGUoe1xuICBmaWxsOiBuZXcgRmlsbCh7XG4gICAgY29sb3I6ICcjNjY2J1xuICB9KSxcbiAgc3Ryb2tlOiBuZXcgU3Ryb2tlKHtcbiAgICBjb2xvcjogJyM0NDQnLFxuICAgIHdpZHRoOiAxLFxuICB9KSxcbn0pO1xuZXhwb3J0IGNvbnN0IHdhdGVyU3R5bGUgPSBuZXcgU3R5bGUoe1xuICBmaWxsOiBuZXcgRmlsbCh7XG4gICAgY29sb3I6ICcjOWRiOWU4JyxcbiAgfSksXG59KTtcbmV4cG9ydCBjb25zdCBib3VuZGFyeVN0eWxlID0gbmV3IFN0eWxlKHtcbiAgc3Ryb2tlOiBuZXcgU3Ryb2tlKHtcbiAgICBjb2xvcjogJyM4QjAwOEInLFxuICAgIHdpZHRoOiAyLFxuICB9KSxcbn0pO1xuZXhwb3J0IGNvbnN0IHJvYWRTdHlsZSA9IGZ1bmN0aW9uIChmZWF0dXJlOiBGZWF0dXJlTGlrZSkge1xuICBjb25zdCBraW5kID0gZmVhdHVyZS5nZXQoJ2NsYXNzJyk7XG4gIGNvbnN0IHJhaWx3YXkgPSBmZWF0dXJlLmdldCgncmFpbHdheScpO1xuICBjb25zdCBzb3J0X2tleSA9IGZlYXR1cmUuZ2V0KCdzb3J0X2tleScpO1xuICBjb25zdCBzdHlsZUtleSA9IGtpbmQgKyAnLycgKyByYWlsd2F5ICsgJy8nICsgc29ydF9rZXk7XG4gIGxldCBzdHlsZSA9IHJvYWRTdHlsZUNhY2hlW3N0eWxlS2V5XTtcbiAgaWYgKCFzdHlsZSkge1xuICAgIGxldCBjb2xvciwgd2lkdGg7XG4gICAgaWYgKHJhaWx3YXkpIHtcbiAgICAgIGNvbG9yID0gJyM3ZGUnO1xuICAgICAgd2lkdGggPSAxO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb2xvciA9IHJvYWRDb2xvcltraW5kXTtcbiAgICAgIHdpZHRoID0ga2luZCA9PSAnaGlnaHdheScgPyAxLjUgOiAxO1xuICAgIH1cbiAgICBzdHlsZSA9IG5ldyBTdHlsZSh7XG4gICAgICBzdHJva2U6IG5ldyBTdHJva2Uoe1xuICAgICAgICBjb2xvcjogY29sb3IsXG4gICAgICAgIHdpZHRoOiB3aWR0aCxcbiAgICAgIH0pLFxuICAgICAgekluZGV4OiBzb3J0X2tleSxcbiAgICB9KTtcbiAgICByb2FkU3R5bGVDYWNoZVtzdHlsZUtleV0gPSBzdHlsZTtcbiAgfVxuICByZXR1cm4gc3R5bGU7XG59O1xuY29uc3QgcGxhY2VCYXNlID0gbmV3IFN0eWxlKHtcbiAgaW1hZ2U6IG5ldyBDaXJjbGUoe1xuICAgIHJhZGl1czogNSxcbiAgICBmaWxsOiBuZXcgRmlsbCh7XG4gICAgICBjb2xvcjogJyMwMDAwODAnXG4gICAgfSlcbiAgfSlcbn0pO1xuY29uc3QgdGV4dFN0cm9rZSA9IG5ldyBTdHJva2Uoe1xuICBjb2xvcjogJ3doaXRlJyxcbiAgd2lkdGg6IDJcbn0pO1xuZXhwb3J0IGNvbnN0IHBsYWNlU3R5bGUgPSBmdW5jdGlvbiAoZmVhdHVyZTogRmVhdHVyZUxpa2UpOiBTdHlsZSB7XG4gIGlmIChmZWF0dXJlLmdldCgnY2xhc3MnKSA9PSAnY291bnRyeScpXG4gICAgcmV0dXJuIG51bGwgYXMgdW5rbm93biBhcyBTdHlsZTtcbiAgaWYgKGZlYXR1cmUuZ2V0KCduYW1lJykpIHtcbiAgICBjb25zdCBzdHlsZSA9IHBsYWNlQmFzZS5jbG9uZSgpO1xuICAgIHN0eWxlLnNldFRleHQobmV3IFRleHQoe1xuICAgICAgdGV4dDogZmVhdHVyZS5nZXQoJ25hbWUnKSxcbiAgICAgIG9mZnNldFk6IC01LFxuICAgICAgZm9udDogJ2JvbGQgMTZweCBzYW5zLXNlcmlmJyxcbiAgICAgIHN0cm9rZTogdGV4dFN0cm9rZVxuICAgIH0pKTtcbiAgICByZXR1cm4gc3R5bGU7XG4gIH1cbiAgcmV0dXJuIG51bGwgYXMgdW5rbm93biBhcyBTdHlsZTtcbn07IiwiZGVjbGFyZSBjb25zdCBPTF9NQlRJTEVTX0RFQlVHOiBzdHJpbmc7XG5jb25zdCBkZWJ1Z0VuYWJsZWQgPSAodHlwZW9mIE9MX01CVElMRVNfREVCVUcgIT09ICd1bmRlZmluZWQnICYmIE9MX01CVElMRVNfREVCVUcpIHx8XG4gICh0eXBlb2YgcHJvY2VzcyAhPT0gJ3VuZGVmaW5lZCcgJiYgdHlwZW9mIHByb2Nlc3M/LmVudj8uT0xfTUJUSUxFU19ERUJVRyAhPT0gJ3VuZGVmaW5lZCcgJiYgcHJvY2Vzcy5lbnYuT0xfTUJUSUxFU19ERUJVRyk7XG5cbmV4cG9ydCBjb25zdCBkZWJ1ZyA9IGRlYnVnRW5hYmxlZCA/IGNvbnNvbGUuZGVidWcuYmluZChjb25zb2xlKSA6ICgpID0+IHVuZGVmaW5lZDtcbiIsImltcG9ydCB7IGNyZWF0ZVNRTGl0ZUhUVFBQb29sLCBTUUxpdGVIVFRQUG9vbCwgVkZTSFRUUCB9IGZyb20gJ3NxbGl0ZS13YXNtLWh0dHAnO1xuXG5pbXBvcnQgeyBPcHRpb25zIGFzIEltYWdlVGlsZU9wdGlvbnMgfSBmcm9tICdvbC9zb3VyY2UvVGlsZUltYWdlLmpzJztcbmltcG9ydCB7IE9wdGlvbnMgYXMgVmVjdG9yVGlsZU9wdGlvbnMgfSBmcm9tICdvbC9zb3VyY2UvVmVjdG9yVGlsZS5qcyc7XG5pbXBvcnQgeyBnZXQgYXMgZ2V0UHJvamVjdGlvbiwgdHJhbnNmb3JtRXh0ZW50IH0gZnJvbSAnb2wvcHJvai5qcyc7XG5pbXBvcnQgeyBnZXRXaWR0aCB9IGZyb20gJ29sL2V4dGVudC5qcyc7XG5pbXBvcnQgVGlsZUdyaWQgZnJvbSAnb2wvdGlsZWdyaWQvVGlsZUdyaWQuanMnO1xuaW1wb3J0IHsgZGVidWcgfSBmcm9tICcuL2RlYnVnJztcblxuLyoqXG4gKiBPcHRpb25zIGZvciBjcmVhdGluZyBhIE1CVGlsZXNSYXN0ZXJTb3VyY2VcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBNQlRpbGVzUmFzdGVyT3B0aW9ucyBleHRlbmRzIEltYWdlVGlsZU9wdGlvbnMge1xuICAvKipcbiAgICogTnVtYmVyIG9mIHBhcmFsbGVsIHdvcmtlcnMgdG8gdXNlIGZvciByZXRyaWV2aW5nIHRpbGVzLCBAZGVmYXVsdCA0XG4gICAqL1xuICBzcWxXb3JrZXJzPzogbnVtYmVyO1xuICAvKipcbiAgICogTGlzdCBvZiBsYXllciBuYW1lcyB0byBzZWxlY3RpdmVseSBpbmNsdWRlLCBAZGVmYXVsdCBldmVyeXRoaW5nXG4gICAqL1xuICBsYXllcnM/OiBzdHJpbmdbXTtcblxuICB0aWxlVXJsRnVuY3Rpb24/OiBuZXZlcjtcbiAgdGlsZUxvYWRGdW5jdGlvbj86IG5ldmVyO1xuXG4gIC8qKlxuICAgKiBBbHRlcm5hdGl2ZSBtZXRob2Qgb2Ygc3BlY2lmeWluZyBtaW5ab29tLCBtdXR1YWxseSBleGNsdXNpdmUgd2l0aCB0aWxlR3JpZCwgcmVxdWlyZXMgZXhwbGljaXQgcHJvamVjdGlvblxuICAgKi9cbiAgbWluWm9vbT86IG51bWJlcjtcblxuICAvKipcbiAgICogQWx0ZXJuYXRpdmUgbWV0aG9kIG9mIHNwZWNpZnlpbmcgbWluWm9vbSwgbXV0dWFsbHkgZXhjbHVzaXZlIHdpdGggdGlsZUdyaWQsIHJlcXVpcmVzIGV4cGxpY2l0IHByb2plY3Rpb25cbiAgICovXG4gIG1heFpvb20/OiBudW1iZXI7XG5cbiAgLyoqXG4gICAqIE9wdGlvbmFsIHRpbGUgZ3JpZCwgcmVmZXIgdG8gdGhlIE9wZW5sYXllcnMgbWFudWFsXG4gICAqL1xuICB0aWxlR3JpZD86IFRpbGVHcmlkO1xuXG4gIC8qKlxuICAgKiBPcHRpb25hbCBhbHJlYWR5IG9wZW4gU1FMaXRlSFRUUCBwb29sIChtdXR1YWxseSBleGNsdXNpdmUgd2l0aCB1cmwpXG4gICAqL1xuICBwb29sPzogUHJvbWlzZTxTUUxpdGVIVFRQUG9vbD47XG59XG5cbi8qKlxuICogT3B0aW9ucyBmb3IgY3JlYXRpbmcgYSBNQlRpbGVzVmVjdG9yU291cmNlXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgTUJUaWxlc1ZlY3Rvck9wdGlvbnMgZXh0ZW5kcyBWZWN0b3JUaWxlT3B0aW9ucyB7XG4gIC8qKlxuICAgKiBOdW1iZXIgb2YgcGFyYWxsZWwgd29ya2VycyB0byB1c2UgZm9yIHJldHJpZXZpbmcgdGlsZXMsIEBkZWZhdWx0IDRcbiAgICovXG4gIHNxbFdvcmtlcnM/OiBudW1iZXI7XG4gIC8qKlxuICAgKiBMaXN0IG9mIGxheWVyIG5hbWVzIHRvIHNlbGVjdGl2ZWx5IGluY2x1ZGUsIEBkZWZhdWx0IGV2ZXJ5dGhpbmdcbiAgICovXG4gIGxheWVycz86IHN0cmluZ1tdO1xuXG4gIC8qKlxuICAgKiBPcHRpb25hbCBhbHJlYWR5IG9wZW4gU1FMaXRlSFRUUCBwb29sIChtdXR1YWxseSBleGNsdXNpdmUgd2l0aCB1cmwpXG4gICAqL1xuICBwb29sPzogUHJvbWlzZTxTUUxpdGVIVFRQUG9vbD47XG5cbiAgdGlsZVVybEZ1bmN0aW9uPzogbmV2ZXI7XG4gIHRpbGVMb2FkRnVuY3Rpb24/OiBuZXZlcjtcbiAgZm9ybWF0PzogbmV2ZXI7XG59XG5cbi8qKlxuICogU2hhcmVkIG9wdGlvbnMgZm9yIGFsbCBNQlRpbGVzXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgU1FMT3B0aW9ucyB7XG4gIC8qKlxuICAgKiBVUkwgb2YgdGhlIHJlbW90ZSBNQlRpbGVzIHNvdXJjZVxuICAgKi9cbiAgdXJsOiBzdHJpbmc7XG4gIC8qKlxuICAgKiBOdW1iZXIgb2YgcGFyYWxsZWwgd29ya2VycyB0byB1c2UgZm9yIHJldHJpZXZpbmcgdGlsZXMsIEBkZWZhdWx0IDRcbiAgICovXG4gIHNxbFdvcmtlcnM/OiBudW1iZXI7XG5cbiAgLyoqXG4gICAqIE1heGltdW0gZXhwZWN0ZWQgcGFnZSBzaXplIGluIGJ5dGVzIGZvciBTUUxpdGUzIGZpbGVzLCBAZGVmYXVsdCA0MDk2XG4gICAqL1xuICBtYXhTcWxQYWdlU2l6ZT86IG51bWJlcjtcblxuICAvKipcbiAgICogTWVtb3J5IHRvIHVzZSBmb3IgU1FMaXRlIGNhY2hlIGluIEtCLCBAZGVmYXVsdCA0MDk2XG4gICAqL1xuICBzcWxDYWNoZVNpemU/OiBudW1iZXI7XG59XG5cbmV4cG9ydCB0eXBlIE1CVGlsZXNPcHRpb25zID0gTUJUaWxlc1ZlY3Rvck9wdGlvbnMgfCBNQlRpbGVzUmFzdGVyT3B0aW9ucztcblxuY29uc3QgZm9ybWF0czogUmVjb3JkPHN0cmluZywgJ3Jhc3RlcicgfCAndmVjdG9yJz4gPSB7XG4gICdqcGcnOiAncmFzdGVyJyxcbiAgJ3BuZyc6ICdyYXN0ZXInLFxuICAnd2VicCc6ICdyYXN0ZXInLFxuICAncGJmJzogJ3ZlY3RvcicsXG4gICdtdnQnOiAndmVjdG9yJ1xufTtcblxuZXhwb3J0IGZ1bmN0aW9uIGh0dHBQb29sT3B0aW9ucyhvcHRpb25zPzogU1FMT3B0aW9ucykge1xuICByZXR1cm4ge1xuICAgIHdvcmtlcnM6IG9wdGlvbnM/LnNxbFdvcmtlcnMgPz8gNCxcbiAgICBodHRwT3B0aW9uczoge1xuICAgICAgbWF4UGFnZVNpemU6IG9wdGlvbnM/Lm1heFNxbFBhZ2VTaXplID8/IDQwOTYsXG4gICAgICBjYWNoZVNpemU6IG9wdGlvbnM/LnNxbENhY2hlU2l6ZSA/PyA0MDk2XG4gICAgfSBhcyBWRlNIVFRQLk9wdGlvbnMsXG4gIH07XG59XG5cbi8qKlxuICogQXV0b21hdGljYWxseSBpbXBvcnQgTUJUaWxlcyBtZXRhZGF0YSBhbmQgcmV0dXJuIGFuIG9wdGlvbnMgb2JqZWN0XG4gKiBjb21wYXRpYmxlIHdpdGggdGhlIHNvdXJjZSBjb25zdHJ1Y3RvcnMuXG4gKiBcbiAqIEBwYXJhbSB7KE1CVGlsZXNSYXN0ZXJPcHRpb25zIHwgTUJUaWxlc1ZlY3Rvck9wdGlvbnMpICYgU1FMT3B0aW9uc30gb3B0IEFueSBNQlRpbGVze1Jhc3RlcnxWZWN0b3J9U291cmNlIG9wdGlvbnMgdG8gYmUgb3ZlcnJpZGRlblxuICogQHBhcmFtIHtzdHJpbmd9IG9wdC51cmwgVVJMIG9mIHRoZSByZW1vdGUgdGlsZXNldFxuICogQHJldHVybnMgeyhNQlRpbGVzUmFzdGVyT3B0aW9ucyB8IE1CVGlsZXNWZWN0b3JPcHRpb25zKX1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGltcG9ydE1CVGlsZXM8VCBleHRlbmRzIE1CVGlsZXNPcHRpb25zPihvcHQ6IFNRTE9wdGlvbnMgJiBUKTogUHJvbWlzZTxUPiB7XG4gIGNvbnN0IHBvb2w6IFByb21pc2U8U1FMaXRlSFRUUFBvb2w+ID0gY3JlYXRlU1FMaXRlSFRUUFBvb2woaHR0cFBvb2xPcHRpb25zKG9wdCkpXG4gICAgLnRoZW4oKHBvb2wpID0+IHBvb2wub3BlbihvcHQudXJsKS50aGVuKCgpID0+IHBvb2wpKTtcblxuICByZXR1cm4gcG9vbFxuICAgIC50aGVuKChwKSA9PiBwLmV4ZWMoJ1NFTEVDVCBuYW1lLHZhbHVlIEZST00gbWV0YWRhdGEnKSlcbiAgICAudGhlbigocikgPT4ge1xuICAgICAgaWYgKHIgJiYgci5sZW5ndGgpIHtcbiAgICAgICAgLy8gVHJhbnNmb3JtIGFuIGFycmF5IG9mIGZvcm0gWyBbJ25hbWUnLCAndmFsdWUnIF0sIC4uLiBdIHRvIG9iamVjdFxuICAgICAgICBjb25zdCBkYXRhID0gci5yZWR1Y2UoKGEsIHgpID0+IHtcbiAgICAgICAgICBhW3gucm93WzBdIGFzIHN0cmluZ10gPSB4LnJvd1sxXSBhcyBzdHJpbmc7XG4gICAgICAgICAgcmV0dXJuIGE7XG4gICAgICAgIH0sIHt9IGFzIFJlY29yZDxzdHJpbmcsIHN0cmluZz4pO1xuICAgICAgICBkZWJ1ZygnTG9hZGVkIG1ldGFkYXRhJywgZGF0YSk7XG4gICAgICAgIHJldHVybiBkYXRhO1xuICAgICAgfVxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdDb3VsZCBub3QgbG9hZCBtZXRhZGF0YScpO1xuICAgIH0pXG4gICAgLnRoZW4oKG1kKSA9PiB7XG4gICAgICBjb25zdCBvcHRzOiBUID0gey4uLm9wdH0gYXMgVDtcblxuICAgICAgY29uc3QgZm9ybWF0ID0gKG1kWydmb3JtYXQnXSBhcyBzdHJpbmcpPy50b0xvd2VyQ2FzZT8uKCk7XG4gICAgICBpZiAoIWZvcm1hdHNbZm9ybWF0XSlcbiAgICAgICAgY29uc29sZS53YXJuKCdVbmtub3duIHRpbGUgZm9ybWF0JywgZm9ybWF0KTtcblxuICAgICAgLy8gU29tZXRpbWVzLCBJIHdvbmRlciBpZiBNYXBib3ggZG9lc24ndCBob2xkIGEgcGF0ZW50IG9yIHNvbWVcbiAgICAgIC8vIG90aGVyIGtpbmQgb2YgaW52ZXN0bWVudCByZWxhdGVkIHRvIGV2ZXJ5b25lIHVzaW5nIDM4NTdcbiAgICAgIG9wdHMucHJvamVjdGlvbiA9IG9wdC5wcm9qZWN0aW9uID8/ICdFUFNHOjM4NTcnO1xuICAgICAgb3B0cy5hdHRyaWJ1dGlvbnMgPSAobWQuYXR0cmlidXRpb24gPz8gbWQuZGVzY3JpcHRpb24pIGFzIHN0cmluZztcbiAgICAgIG9wdHMubWF4Wm9vbSA9IG9wdC5tYXhab29tID8/ICttZFsnbWF4em9vbSddO1xuICAgICAgb3B0cy5taW5ab29tID0gb3B0Lm1pblpvb20gPz8gK21kWydtaW56b29tJ107XG5cbiAgICAgIGNvbnN0IHByb2pFeHRlbnQgPSBnZXRQcm9qZWN0aW9uKG9wdHMucHJvamVjdGlvbik/LmdldEV4dGVudD8uKCk7XG4gICAgICBjb25zdCBib3VuZHMgPSBtZFsnYm91bmRzJ107XG4gICAgICBjb25zdCBleHRlbnQgPSBib3VuZHMgP1xuICAgICAgICB0cmFuc2Zvcm1FeHRlbnQoYm91bmRzLnNwbGl0KCcsJykubWFwKChyKSA9PiArciksICdFUFNHOjQzMjYnLCBvcHRzLnByb2plY3Rpb24pIDpcbiAgICAgICAgcHJvakV4dGVudDtcblxuICAgICAgaWYgKGZvcm1hdHNbZm9ybWF0XSA9PT0gJ3Jhc3RlcicpIHtcbiAgICAgICAgaWYgKG9wdHMubWF4Wm9vbSA9PT0gdW5kZWZpbmVkIHx8IG9wdHMubWluWm9vbSA9PT0gdW5kZWZpbmVkIHx8IHByb2pFeHRlbnQgPT09IHVuZGVmaW5lZClcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0Nhbm5vdCBkZXRlcm1pbmUgdGlsZWdyaWQsIG5lZWQgbWluWm9vbSwgbWF4Wm9vbScpO1xuICAgICAgICBjb25zdCBiYXNlUmVzb2x1dGlvbiA9IGdldFdpZHRoKHByb2pFeHRlbnQpIC8gMjU2O1xuICAgICAgICBjb25zdCByZXNvbHV0aW9ucyA9IFtiYXNlUmVzb2x1dGlvbl07XG4gICAgICAgIGZvciAobGV0IHogPSAxOyB6IDw9IG9wdHMubWF4Wm9vbTsgeisrKVxuICAgICAgICAgIHJlc29sdXRpb25zLnB1c2gocmVzb2x1dGlvbnNbcmVzb2x1dGlvbnMubGVuZ3RoIC0gMV0gLyAyKTtcblxuICAgICAgICBvcHRzLnRpbGVHcmlkID0gbmV3IFRpbGVHcmlkKHtcbiAgICAgICAgICBvcmlnaW46IFtwcm9qRXh0ZW50WzBdLCBwcm9qRXh0ZW50WzJdXSxcbiAgICAgICAgICBleHRlbnQsXG4gICAgICAgICAgbWluWm9vbTogb3B0cy5taW5ab29tLFxuICAgICAgICAgIHJlc29sdXRpb25zXG4gICAgICAgIH0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29uc3QgdmVjdG9yT3B0cyA9IG9wdHMgYXMgTUJUaWxlc1ZlY3Rvck9wdGlvbnM7XG4gICAgICAgIC8vIEFsYXMgVmVjdG9yVGlsZVNvdXJjZSBpbiBPcGVubGF5ZXJzIGRvZXMgbm90IHN1cHBvcnRcbiAgICAgICAgLy8gY29uc3RyYWluaW5nIHRoZSBleHRlbnQgd2hpbGUga2VlcGluZyB0aGUgb3JpZ2luXG4gICAgICAgIHZlY3Rvck9wdHMuZXh0ZW50ID0gcHJvakV4dGVudDtcbiAgICAgIH1cbiAgICAgIG9wdHMucG9vbCA9IHBvb2w7XG4gICAgICBvcHRzLnVybCA9IG9wdC51cmw7XG5cbiAgICAgIHJldHVybiBvcHRzO1xuICAgIH0pO1xufVxuIiwiaW1wb3J0IFByb3RvYnVmIGZyb20gJ3BiZic7XG5pbXBvcnQgeyBWZWN0b3JUaWxlLCBWZWN0b3JUaWxlRmVhdHVyZSB9IGZyb20gJ0BtYXBib3gvdmVjdG9yLXRpbGUnO1xuaW1wb3J0IHBha28gZnJvbSAncGFrbyc7XG5cbmltcG9ydCBGZWF0dXJlRm9ybWF0LCB7IFJlYWRPcHRpb25zIH0gZnJvbSAnb2wvZm9ybWF0L0ZlYXR1cmUuanMnO1xuaW1wb3J0IFByb2plY3Rpb24gZnJvbSAnb2wvcHJvai9Qcm9qZWN0aW9uLmpzJztcbmltcG9ydCBSZW5kZXJGZWF0dXJlIGZyb20gJ29sL3JlbmRlci9GZWF0dXJlLmpzJztcbmltcG9ydCB7IEZlYXR1cmVMaWtlIH0gZnJvbSAnb2wvRmVhdHVyZS5qcyc7XG5pbXBvcnQgeyBnZXQgYXMgZ2V0UHJvamVjdGlvbiB9IGZyb20gJ29sL3Byb2ouanMnO1xuaW1wb3J0IHsgVHlwZSB9IGZyb20gJ29sL2dlb20vR2VvbWV0cnkuanMnO1xuXG5kZWNsYXJlIG1vZHVsZSAnQG1hcGJveC92ZWN0b3ItdGlsZScge1xuICBpbnRlcmZhY2UgVmVjdG9yVGlsZUZlYXR1cmUge1xuICAgIHRvR2VvSlNPTih4OiBudW1iZXIsIHk6IG51bWJlciwgejogbnVtYmVyLCBwcm9qZWN0PzogKHh5OiBbbnVtYmVyLCBudW1iZXJdKSA9PiBbbnVtYmVyLCBudW1iZXJdKTogR2VvSlNPTi5GZWF0dXJlO1xuICB9XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgT3B0aW9ucyB7XG4gIGxheWVycz86IHN0cmluZ1tdO1xuICBmZWF0dXJlQ2xhc3M/OiB0eXBlb2YgUmVuZGVyRmVhdHVyZTtcbiAgZ2VvbWV0cnlOYW1lPzogc3RyaW5nO1xuICBpZFByb3BlcnR5Pzogc3RyaW5nO1xuICBleHRlbnQ/OiBudW1iZXI7XG59XG5cbmV4cG9ydCBjbGFzcyBNQlRpbGVzRm9ybWF0IGV4dGVuZHMgRmVhdHVyZUZvcm1hdCB7XG4gIGRhdGFQcm9qZWN0aW9uOiBQcm9qZWN0aW9uO1xuICBwcml2YXRlIGZlYXR1cmVDbGFzc186IHR5cGVvZiBSZW5kZXJGZWF0dXJlO1xuICBwcml2YXRlIGdlb21ldHJ5TmFtZV86IHN0cmluZztcbiAgcHJpdmF0ZSBsYXllcnNfOiBzdHJpbmdbXSB8IG51bGw7XG4gIHByaXZhdGUgaWRQcm9wZXJ0eV86IHN0cmluZyB8IHVuZGVmaW5lZDtcbiAgc3VwcG9ydGVkTWVkaWFUeXBlczogc3RyaW5nW107XG4gIGV4dGVudDogbnVtYmVyO1xuICBzdGF0aWMgTUJUeXBlcyA9IHtcbiAgICBtb25vOiBbJ1Vua25vd24nLCAnUG9pbnQnLCAnTGluZVN0cmluZycsICdQb2x5Z29uJyBdLFxuICAgIG11bHRpOiBbJ1Vua25vd24nLCAnTXVsdGlQb2ludCcsICdNdWx0aUxpbmVTdHJpbmcnLCAnUG9seWdvbiddXG4gICB9IGFzIFJlY29yZDwnbW9ubycgfCAnbXVsdGknLCAoVHlwZSB8ICdVbmtub3duJylbXT47XG5cbiAgY29uc3RydWN0b3Iob3B0aW9ucz86IE9wdGlvbnMpIHtcbiAgICBzdXBlcigpO1xuXG4gICAgb3B0aW9ucyA9IG9wdGlvbnMgPyBvcHRpb25zIDoge307XG5cbiAgICB0aGlzLmRhdGFQcm9qZWN0aW9uID0gbmV3IFByb2plY3Rpb24oe1xuICAgICAgY29kZTogJycsXG4gICAgICB1bml0czogJ3RpbGUtcGl4ZWxzJyxcbiAgICB9KTtcblxuICAgIHRoaXMuZmVhdHVyZUNsYXNzXyA9IG9wdGlvbnMuZmVhdHVyZUNsYXNzID8gb3B0aW9ucy5mZWF0dXJlQ2xhc3MgOiBSZW5kZXJGZWF0dXJlO1xuICAgIHRoaXMuZ2VvbWV0cnlOYW1lXyA9IG9wdGlvbnMuZ2VvbWV0cnlOYW1lID8/ICdHZW9tZXRyeSc7XG4gICAgdGhpcy5sYXllcnNfID0gb3B0aW9ucy5sYXllcnMgPz8gbnVsbDtcbiAgICB0aGlzLmlkUHJvcGVydHlfID0gb3B0aW9ucy5pZFByb3BlcnR5O1xuICAgIHRoaXMuZXh0ZW50ID0gb3B0aW9ucy5leHRlbnQgPz8gNDA5NjtcblxuICAgIC8qXG4gICAgICogQXMgdGhpcyBpcyB0aGUgdmVyeSBmaXJzdCB0aW1lIE1CVGlsZXMgd2lsbCBiZSBkaXN0cmlidXRlZCBieSBIVFRQXG4gICAgICogdGhlcmUgaXMgc3RpbGwgbm8gb2ZmaWNpYWwgTUlNRSB0eXBlXG4gICAgICovXG4gICAgdGhpcy5zdXBwb3J0ZWRNZWRpYVR5cGVzID0gW1xuICAgICAgJ2FwcGxpY2F0aW9uL3ZuZC1tYnRpbGVzJ1xuICAgIF07XG4gIH1cblxuICByZWFkRmVhdHVyZShzb3VyY2U6IFZlY3RvclRpbGVGZWF0dXJlLCBvcHRpb25zPzogUmVhZE9wdGlvbnMpOiBGZWF0dXJlTGlrZSB7XG4gICAgY29uc3QgcHJvcGVydGllcyA9IHNvdXJjZS5wcm9wZXJ0aWVzO1xuXG4gICAgbGV0IGlkOiBzdHJpbmcgfCBudW1iZXI7XG4gICAgaWYgKCF0aGlzLmlkUHJvcGVydHlfKSB7XG4gICAgICBpZCA9IHNvdXJjZS5pZDtcbiAgICB9IGVsc2Uge1xuICAgICAgaWQgPSBwcm9wZXJ0aWVzW3RoaXMuaWRQcm9wZXJ0eV9dIGFzIHN0cmluZyB8IG51bWJlcjtcbiAgICAgIGRlbGV0ZSBwcm9wZXJ0aWVzW3RoaXMuaWRQcm9wZXJ0eV9dO1xuICAgIH1cbiAgICBjb25zdCBwb2ludHMgPSBzb3VyY2UubG9hZEdlb21ldHJ5KCk7XG4gICAgY29uc3QgZmxhdENvb3JkaW5hdGVzID0gW10gYXMgbnVtYmVyW107XG4gICAgY29uc3QgZW5kcyA9IFtdIGFzIG51bWJlcltdO1xuXG4gICAgY29uc3QgdHlwZTogVHlwZSB8ICdVbmtub3duJyA9IE1CVGlsZXNGb3JtYXQuTUJUeXBlc1twb2ludHMubGVuZ3RoID4gMSA/ICdtdWx0aScgOiAnbW9ubyddW3NvdXJjZS50eXBlXTtcbiAgICBpZiAodHlwZSA9PT0gJ1Vua25vd24nKVxuICAgIC8vIFRPRE86IGZpeCBpbiBPcGVubGF5ZXJzXG4gICAgICByZXR1cm4gbnVsbCBhcyB1bmtub3duIGFzIEZlYXR1cmVMaWtlO1xuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBwb2ludHMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGlmIChwb2ludHNbaV0ubGVuZ3RoID09IDApXG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBwb2ludHNbaV0ubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgZmxhdENvb3JkaW5hdGVzLnB1c2gocG9pbnRzW2ldW2pdLngsIHBvaW50c1tpXVtqXS55KTtcbiAgICAgIH1cbiAgICAgIGVuZHMucHVzaChmbGF0Q29vcmRpbmF0ZXMubGVuZ3RoKTtcbiAgICB9XG5cbiAgICBjb25zdCBmZWF0dXJlID0gbmV3IHRoaXMuZmVhdHVyZUNsYXNzXyh0eXBlLCBmbGF0Q29vcmRpbmF0ZXMsIGVuZHMsIHByb3BlcnRpZXMsIGlkKTtcbiAgICBmZWF0dXJlLnRyYW5zZm9ybShvcHRpb25zPy5kYXRhUHJvamVjdGlvbik7XG5cbiAgICByZXR1cm4gZmVhdHVyZTtcbiAgfVxuXG4gIHJlYWRGZWF0dXJlcyhzb3VyY2U6IEFycmF5QnVmZmVyLCBvcHRpb25zPzogUmVhZE9wdGlvbnMpOiBGZWF0dXJlTGlrZVtdIHtcbiAgICBjb25zdCBsYXllcnMgPSB0aGlzLmxheWVyc187XG5cbiAgICBjb25zdCBmZWF0dXJlczogRmVhdHVyZUxpa2VbXSA9IFtdO1xuICAgIGNvbnN0IHRpbGUgPSBuZXcgVmVjdG9yVGlsZShuZXcgUHJvdG9idWYocGFrby51bmd6aXAoc291cmNlKSkpO1xuICAgIG9wdGlvbnMgPSB0aGlzLmFkYXB0T3B0aW9ucyhvcHRpb25zKTtcbiAgICBjb25zdCBkYXRhUHJvamVjdGlvbiA9IGdldFByb2plY3Rpb24ob3B0aW9ucz8uZGF0YVByb2plY3Rpb24pO1xuICAgIGNvbnN0IGV4dGVudCA9IG9wdGlvbnM/LmV4dGVudDtcbiAgICBpZiAoIWRhdGFQcm9qZWN0aW9uIHx8ICFvcHRpb25zIHx8ICFleHRlbnQpXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0Nhbm5vdCBkZXRlcm1pbmUgdGhlIHByb2plY3Rpb24vZXh0ZW50Jyk7XG4gICAgZGF0YVByb2plY3Rpb24uc2V0V29ybGRFeHRlbnQoZXh0ZW50KTtcbiAgICBkYXRhUHJvamVjdGlvbi5zZXRFeHRlbnQoWzAsIDAsIHRoaXMuZXh0ZW50LCB0aGlzLmV4dGVudF0pO1xuICAgIG9wdGlvbnMuZGF0YVByb2plY3Rpb24gPSBkYXRhUHJvamVjdGlvbjtcblxuICAgIGZvciAoY29uc3QgbGF5ZXJOYW1lIG9mIE9iamVjdC5rZXlzKHRpbGUubGF5ZXJzKSkge1xuICAgICAgaWYgKGxheWVycyAmJiAhbGF5ZXJzLmluY2x1ZGVzKGxheWVyTmFtZSkpIHtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG4gICAgICBjb25zdCBsID0gdGlsZS5sYXllcnNbbGF5ZXJOYW1lXTtcbiAgICAgIGZvciAobGV0IGlkeCA9IDA7IGlkeCA8IGwubGVuZ3RoOyBpZHgrKykge1xuICAgICAgICBjb25zdCB2ZWN0b3JGZWF0dXJlID0gbC5mZWF0dXJlKGlkeCk7XG4gICAgICAgIGNvbnN0IGZlYXR1cmUgPSB0aGlzLnJlYWRGZWF0dXJlKHZlY3RvckZlYXR1cmUsIG9wdGlvbnMpO1xuICAgICAgICBmZWF0dXJlLmdldFByb3BlcnRpZXMoKS5sYXllciA9IGxheWVyTmFtZTtcbiAgICAgICAgZmVhdHVyZXMucHVzaChmZWF0dXJlKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gZmVhdHVyZXM7XG4gIH1cblxuICByZWFkUHJvamVjdGlvbigpIHtcbiAgICByZXR1cm4gdGhpcy5kYXRhUHJvamVjdGlvbjtcbiAgfVxufVxuIiwiaW1wb3J0IHsgY3JlYXRlU1FMaXRlSFRUUFBvb2wsIFNRTGl0ZUhUVFBQb29sIH0gZnJvbSAnc3FsaXRlLXdhc20taHR0cCc7XG5cbmltcG9ydCBWZWN0b3JUaWxlU291cmNlIGZyb20gJ29sL3NvdXJjZS9WZWN0b3JUaWxlLmpzJztcbmltcG9ydCBWZWN0b3JUaWxlIGZyb20gJ29sL1ZlY3RvclRpbGUuanMnO1xuaW1wb3J0IHsgVGlsZUNvb3JkIH0gZnJvbSAnb2wvdGlsZWNvb3JkLmpzJztcbmltcG9ydCBGZWF0dXJlIGZyb20gJ29sL0ZlYXR1cmUuanMnO1xuaW1wb3J0IHsgR2VvbWV0cnkgfSBmcm9tICdvbC9nZW9tLmpzJztcblxuaW1wb3J0IHsgaHR0cFBvb2xPcHRpb25zLCBNQlRpbGVzVmVjdG9yT3B0aW9ucywgU1FMT3B0aW9ucyB9IGZyb20gJy4vbWJ0aWxlcyc7XG5pbXBvcnQgeyBNQlRpbGVzRm9ybWF0IH0gZnJvbSAnLi9tYnRpbGVzLWZvcm1hdCc7XG5pbXBvcnQgeyBkZWJ1ZyB9IGZyb20gJy4vZGVidWcnO1xuaW1wb3J0IFRpbGUgZnJvbSAnb2wvVGlsZSc7XG5cbi8qKlxuICogQSB0aWxlIHNvdXJjZSBpbiBhIHJlbW90ZSAubWJ0aWxlcyBmaWxlIGFjY2Vzc2libGUgYnkgSFRUUFxuICogXG4gKiBXQVJOSU5HXG4gKiBJZiB5b3VyIGFwcGxpY2F0aW9uIGNvbnRpbnVvdXNseSBjcmVhdGVzIGFuZCByZW1vdmVzIE1CVGlsZXNTb3VyY2VcbiAqIG9iamVjdHMsIHNwZWNpYWwgY2FyZSBtdXN0IGJlIHRha2VuIHRvIHByb3Blcmx5IGRpc3Bvc2Ugb2YgdGhlbS5cbiAqIEFuIE1CVGlsZXNTb3VyY2UgY3JlYXRlcyBhIHRocmVhZCBwb29sIHRoYXQgdGhlIEpTIGVuZ2luZSBpcyB1bmFibGUgdG9cbiAqIGF1dG9tYXRpY2FsbHkgZ2FyYmFnZS1jb2xsZWN0IHVubGVzcyB0aGUgZGlzcG9zZSgpIG1ldGhvZFxuICogaXMgaW52b2tlZC5cbiAqIElmIHlvdSBuZWVkIHRvIGRpc3Bvc2UgYSBtYXAgdGhhdCBjYW4gcG90ZW50aWFsbHkgY29udGFpblxuICogTUJUaWxlc1NvdXJjZSBvYmplY3RzLCBjaGVjayBsb2FkRXhhbXBsZSgpIGluXG4gKiBodHRwczovL2dpdGh1Yi5jb20vbW1vbXRjaGV2L29sLW1idGlsZXMvYmxvYi9tYWluL2V4YW1wbGVzL2luZGV4LnRzI0wxNVxuICovXG5leHBvcnQgY2xhc3MgTUJUaWxlc1ZlY3RvclNvdXJjZSBleHRlbmRzIFZlY3RvclRpbGVTb3VyY2Uge1xuICBwcml2YXRlIHBvb2w6IFByb21pc2U8U1FMaXRlSFRUUFBvb2w+O1xuXG4gIC8qKlxuICAgKiBAcGFyYW0ge01CVGlsZXNWZWN0b3JPcHRpb25zfSBvcHRpb25zIG9wdGlvbnNcbiAgICovXG4gIGNvbnN0cnVjdG9yKG9wdGlvbnM6IE1CVGlsZXNWZWN0b3JPcHRpb25zICYgU1FMT3B0aW9ucykge1xuICAgIGlmIChvcHRpb25zLnVybCA9PT0gdW5kZWZpbmVkICYmIG9wdGlvbnMucG9vbCA9PT0gdW5kZWZpbmVkKVxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdNdXN0IHNwZWNpZnkgdXJsJyk7XG5cbiAgICAgIHN1cGVyKHtcbiAgICAgIC4uLm9wdGlvbnMsXG4gICAgICB1cmw6IHVuZGVmaW5lZCxcbiAgICAgIGZvcm1hdDogbmV3IE1CVGlsZXNGb3JtYXQoe1xuICAgICAgICBsYXllcnM6IG9wdGlvbnMubGF5ZXJzXG4gICAgICB9KSxcbiAgICAgIC8vIFRoaXMgaXMgcmVxdWlyZWQgdG8gcHJldmVudCBPcGVubGF5ZXJzJyBjYWNoZSBmcm9tIHRoaW5raW5nIHRoYXQgYWxsIHRpbGVzIHNoYXJlIHRoZSBzYW1lIFVSTFxuICAgICAgdGlsZVVybEZ1bmN0aW9uOiAoY29vcmRzOiBUaWxlQ29vcmQpID0+IGAke29wdGlvbnMudXJsfSMke2Nvb3Jkc1swXX06JHtjb29yZHNbMV19OiR7Y29vcmRzWzJdfWBcbiAgICB9KTtcblxuICAgIHRoaXMuc2V0VGlsZUxvYWRGdW5jdGlvbih0aGlzLnRpbGVMb2FkZXIuYmluZCh0aGlzKSk7XG5cbiAgICB0aGlzLnBvb2wgPSBvcHRpb25zLnBvb2wgPz8gY3JlYXRlU1FMaXRlSFRUUFBvb2woaHR0cFBvb2xPcHRpb25zKG9wdGlvbnMpKVxuICAgICAgLnRoZW4oKHBvb2wpID0+IHBvb2wub3BlbihvcHRpb25zLnVybCkudGhlbigoKSA9PiBwb29sKSk7XG4gIH1cblxuICBwcml2YXRlIHRpbGVMb2FkZXIoX3RpbGU6IFRpbGUsIF91cmw6IHN0cmluZykge1xuICAgIC8vIFRPRE8gZml4IHRoZSB0eXBlIGluIE9wZW5sYXllcnMgYWZ0ZXIgdGhlIHdhclxuICAgIGNvbnN0IHRpbGUgPSBfdGlsZSBhcyBWZWN0b3JUaWxlO1xuICAgIGRlYnVnKCdsb2FkaW5nIHRpbGUnLCBbdGlsZS50aWxlQ29vcmRbMF0sIHRpbGUudGlsZUNvb3JkWzFdLCB0aWxlLnRpbGVDb29yZFsyXV0pO1xuICAgIHRpbGUuc2V0TG9hZGVyKChleHRlbnQsIHJlc29sdXRpb24sIHByb2plY3Rpb24pID0+IHtcbiAgICAgIHRoaXMucG9vbFxuICAgICAgICAudGhlbigocCkgPT5cbiAgICAgICAgICBwLmV4ZWMoXG4gICAgICAgICAgICAnU0VMRUNUIHRpbGVfZGF0YSBGUk9NIHRpbGVzIFdIRVJFIHpvb21fbGV2ZWwgPSAkem9vbSBBTkQgdGlsZV9jb2x1bW4gPSAkY29sIEFORCB0aWxlX3JvdyA9ICRyb3cnLFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAkem9vbTogdGlsZS50aWxlQ29vcmRbMF0sXG4gICAgICAgICAgICAgICRjb2w6IHRpbGUudGlsZUNvb3JkWzFdLFxuICAgICAgICAgICAgICAkcm93OiAoMSA8PCB0aWxlLnRpbGVDb29yZFswXSkgLSAxIC0gdGlsZS50aWxlQ29vcmRbMl1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICApKVxuICAgICAgICAudGhlbigocikgPT4ge1xuICAgICAgICAgIGlmIChyICYmIHJbMF0gJiYgclswXS5yb3dbMF0pIHtcbiAgICAgICAgICAgIGNvbnN0IGZvcm1hdCA9IHRpbGUuZ2V0Rm9ybWF0KCk7XG4gICAgICAgICAgICBjb25zdCBmZWF0dXJlcyA9IGZvcm1hdC5yZWFkRmVhdHVyZXMoclswXS5yb3dbMF0sIHtcbiAgICAgICAgICAgICAgZXh0ZW50LFxuICAgICAgICAgICAgICBmZWF0dXJlUHJvamVjdGlvbjogcHJvamVjdGlvblxuICAgICAgICAgICAgfSkgYXMgRmVhdHVyZTxHZW9tZXRyeT5bXTtcbiAgICAgICAgICAgIHRpbGUuc2V0RmVhdHVyZXMoZmVhdHVyZXMpO1xuICAgICAgICAgICAgdGlsZS5vbkxvYWQoZmVhdHVyZXMsIHByb2plY3Rpb24pO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH1cbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYE5vIGRhdGEgZm9yICR7dGlsZS50aWxlQ29vcmR9YCk7XG4gICAgICAgIH0pXG4gICAgICAgIC5jYXRjaCgoZSkgPT4ge1xuICAgICAgICAgIGRlYnVnKGUpO1xuICAgICAgICAgIHRpbGUub25FcnJvcigpO1xuICAgICAgICB9KTtcbiAgICB9KTtcbiAgfVxuXG4gIGRpc3Bvc2VJbnRlcm5hbCgpIHtcbiAgICByZXR1cm4gdGhpcy5wb29sLnRoZW4oKHApID0+IHAuY2xvc2UoKSk7XG4gIH1cbn1cbiIsImltcG9ydCB7IGNyZWF0ZVNRTGl0ZUhUVFBQb29sLCBTUUxpdGVIVFRQUG9vbCB9IGZyb20gJ3NxbGl0ZS13YXNtLWh0dHAnO1xuXG5pbXBvcnQgSW1hZ2VUaWxlU291cmNlIGZyb20gJ29sL3NvdXJjZS9UaWxlSW1hZ2UuanMnO1xuaW1wb3J0IFRpbGUgZnJvbSAnb2wvVGlsZS5qcyc7XG5pbXBvcnQgSW1hZ2VUaWxlIGZyb20gJ29sL0ltYWdlVGlsZS5qcyc7XG5pbXBvcnQgeyBUaWxlQ29vcmQgfSBmcm9tICdvbC90aWxlY29vcmQuanMnO1xuaW1wb3J0IFRpbGVTdGF0ZSBmcm9tICdvbC9UaWxlU3RhdGUuanMnO1xuXG5pbXBvcnQgeyBodHRwUG9vbE9wdGlvbnMsIE1CVGlsZXNSYXN0ZXJPcHRpb25zLCBTUUxPcHRpb25zIH0gZnJvbSAnLi9tYnRpbGVzJztcbmltcG9ydCB7IGRlYnVnIH0gZnJvbSAnLi9kZWJ1Zyc7XG5cbi8qKlxuICogQSB0aWxlIHNvdXJjZSBpbiBhIHJlbW90ZSAubWJ0aWxlcyBmaWxlIGFjY2Vzc2libGUgYnkgSFRUUFxuICogXG4gKiBXQVJOSU5HXG4gKiBJZiB5b3VyIGFwcGxpY2F0aW9uIGNvbnRpbnVvdXNseSBjcmVhdGVzIGFuZCByZW1vdmVzIE1CVGlsZXNTb3VyY2VcbiAqIG9iamVjdHMsIHNwZWNpYWwgY2FyZSBtdXN0IGJlIHRha2VuIHRvIHByb3Blcmx5IGRpc3Bvc2Ugb2YgdGhlbS5cbiAqIEFuIE1CVGlsZXNTb3VyY2UgY3JlYXRlcyBhIHRocmVhZCBwb29sIHRoYXQgdGhlIEpTIGVuZ2luZSBpcyB1bmFibGUgdG9cbiAqIGF1dG9tYXRpY2FsbHkgZ2FyYmFnZS1jb2xsZWN0IHVubGVzcyB0aGUgZGlzcG9zZSgpIG1ldGhvZFxuICogaXMgaW52b2tlZC5cbiAqIElmIHlvdSBuZWVkIHRvIGRpc3Bvc2UgYSBtYXAgdGhhdCBjYW4gcG90ZW50aWFsbHkgY29udGFpblxuICogTUJUaWxlc1NvdXJjZSBvYmplY3RzLCBjaGVjayBsb2FkRXhhbXBsZSgpIGluXG4gKiBodHRwczovL2dpdGh1Yi5jb20vbW1vbXRjaGV2L29sLW1idGlsZXMvYmxvYi9tYWluL2V4YW1wbGVzL2luZGV4LnRzI0wxNVxuICovXG5leHBvcnQgY2xhc3MgTUJUaWxlc1Jhc3RlclNvdXJjZSBleHRlbmRzIEltYWdlVGlsZVNvdXJjZSB7XG4gIHByaXZhdGUgcG9vbDogUHJvbWlzZTxTUUxpdGVIVFRQUG9vbD47XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7TUJUaWxlc1Jhc3Rlck9wdGlvbnN9IG9wdGlvbnMgb3B0aW9uc1xuICAgKi9cbiAgY29uc3RydWN0b3Iob3B0aW9uczogTUJUaWxlc1Jhc3Rlck9wdGlvbnMgJiBTUUxPcHRpb25zKSB7XG4gICAgaWYgKG9wdGlvbnMudXJsID09PSB1bmRlZmluZWQgJiYgb3B0aW9ucy5wb29sID09PSB1bmRlZmluZWQpXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ011c3Qgc3BlY2lmeSB1cmwnKTtcblxuICAgIHN1cGVyKHtcbiAgICAgIC4uLm9wdGlvbnMsXG4gICAgICB1cmw6IHVuZGVmaW5lZCxcbiAgICAgIC8vIFRoaXMgaXMgcmVxdWlyZWQgdG8gcHJldmVudCBPcGVubGF5ZXJzJyBjYWNoZSBmcm9tIHRoaW5raW5nIHRoYXQgYWxsIHRpbGVzIHNoYXJlIHRoZSBzYW1lIFVSTFxuICAgICAgdGlsZVVybEZ1bmN0aW9uOiAoY29vcmRzOiBUaWxlQ29vcmQpID0+IGAke29wdGlvbnMudXJsfSMke2Nvb3Jkc1swXX06JHtjb29yZHNbMV19OiR7Y29vcmRzWzJdfWBcbiAgICB9KTtcblxuICAgIHRoaXMuc2V0VGlsZUxvYWRGdW5jdGlvbih0aGlzLnRpbGVMb2FkZXIuYmluZCh0aGlzKSk7XG5cbiAgICB0aGlzLnBvb2wgPSBvcHRpb25zLnBvb2wgPz8gY3JlYXRlU1FMaXRlSFRUUFBvb2woaHR0cFBvb2xPcHRpb25zKG9wdGlvbnMpKVxuICAgICAgLnRoZW4oKHBvb2wpID0+IHBvb2wub3BlbihvcHRpb25zLnVybCkudGhlbigoKSA9PiBwb29sKSk7XG4gIH1cblxuICAvLyBUT0RPIGZpeCB0aGUgdGlsZSB0eXBlIGluIE9wZW5sYXllcnNcbiAgcHJpdmF0ZSB0aWxlTG9hZGVyKHRpbGU6IFRpbGUsIF91cmw6IHN0cmluZykge1xuICAgIGRlYnVnKCdsb2FkaW5nIHRpbGUnLCBbdGlsZS50aWxlQ29vcmRbMF0sIHRpbGUudGlsZUNvb3JkWzFdLCB0aWxlLnRpbGVDb29yZFsyXV0pO1xuICAgIGNvbnN0IGltYWdlID0gKHRpbGUgYXMgSW1hZ2VUaWxlKS5nZXRJbWFnZSgpIGFzIEhUTUxJbWFnZUVsZW1lbnQ7XG4gICAgdGhpcy5wb29sXG4gICAgICAudGhlbigocCkgPT5cbiAgICAgICAgcC5leGVjKFxuICAgICAgICAgICdTRUxFQ1QgdGlsZV9kYXRhIEZST00gdGlsZXMgV0hFUkUgem9vbV9sZXZlbCA9ICR6b29tIEFORCB0aWxlX2NvbHVtbiA9ICRjb2wgQU5EIHRpbGVfcm93ID0gJHJvdycsXG4gICAgICAgICAge1xuICAgICAgICAgICAgJHpvb206IHRpbGUudGlsZUNvb3JkWzBdLFxuICAgICAgICAgICAgJGNvbDogdGlsZS50aWxlQ29vcmRbMV0sXG4gICAgICAgICAgICAkcm93OiAoMSA8PCB0aWxlLnRpbGVDb29yZFswXSkgLSAxIC0gdGlsZS50aWxlQ29vcmRbMl1cbiAgICAgICAgICB9XG4gICAgICAgICkpXG4gICAgICAudGhlbigocikgPT4ge1xuICAgICAgICBpZiAociAmJiByWzBdKSB7XG4gICAgICAgICAgaWYgKHJbMF0ucm93WzBdIGluc3RhbmNlb2YgVWludDhBcnJheSkge1xuICAgICAgICAgICAgY29uc3QgYmxvYiA9IG5ldyBCbG9iKFtyWzBdLnJvd1swXSBhcyBVaW50OEFycmF5XSk7XG4gICAgICAgICAgICBjb25zdCBpbWFnZVVybCA9IFVSTC5jcmVhdGVPYmplY3RVUkwoYmxvYik7XG4gICAgICAgICAgICBpbWFnZS5zcmMgPSBpbWFnZVVybDtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBObyBkYXRhIGZvciAke3RpbGUudGlsZUNvb3JkfWApO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaCgoZSkgPT4ge1xuICAgICAgICBkZWJ1ZyhlKTtcbiAgICAgICAgdGlsZS5zZXRTdGF0ZShUaWxlU3RhdGUuRVJST1IpO1xuICAgICAgfSk7XG4gIH1cblxuICBkaXNwb3NlSW50ZXJuYWwoKSB7XG4gICAgcmV0dXJuIHRoaXMucG9vbC50aGVuKChwKSA9PiBwLmNsb3NlKCkpO1xuICB9XG59XG4iLCIvKipcbiAqIEBtb2R1bGUgb2wvc291cmNlL09TTVxuICovXG5cbmltcG9ydCBYWVogZnJvbSAnLi9YWVouanMnO1xuXG4vKipcbiAqIFRoZSBhdHRyaWJ1dGlvbiBjb250YWluaW5nIGEgbGluayB0byB0aGUgT3BlblN0cmVldE1hcCBDb3B5cmlnaHQgYW5kIExpY2Vuc2VcbiAqIHBhZ2UuXG4gKiBAY29uc3RcbiAqIEB0eXBlIHtzdHJpbmd9XG4gKiBAYXBpXG4gKi9cbmV4cG9ydCBjb25zdCBBVFRSSUJVVElPTiA9XG4gICcmIzE2OTsgJyArXG4gICc8YSBocmVmPVwiaHR0cHM6Ly93d3cub3BlbnN0cmVldG1hcC5vcmcvY29weXJpZ2h0XCIgdGFyZ2V0PVwiX2JsYW5rXCI+T3BlblN0cmVldE1hcDwvYT4gJyArXG4gICdjb250cmlidXRvcnMuJztcblxuLyoqXG4gKiBAdHlwZWRlZiB7T2JqZWN0fSBPcHRpb25zXG4gKiBAcHJvcGVydHkge2ltcG9ydChcIi4vU291cmNlLmpzXCIpLkF0dHJpYnV0aW9uTGlrZX0gW2F0dHJpYnV0aW9uc10gQXR0cmlidXRpb25zLlxuICogQHByb3BlcnR5IHtudW1iZXJ9IFtjYWNoZVNpemVdIEluaXRpYWwgdGlsZSBjYWNoZSBzaXplLiBXaWxsIGF1dG8tZ3JvdyB0byBob2xkIGF0IGxlYXN0IHRoZSBudW1iZXIgb2YgdGlsZXMgaW4gdGhlIHZpZXdwb3J0LlxuICogQHByb3BlcnR5IHtudWxsfHN0cmluZ30gW2Nyb3NzT3JpZ2luPSdhbm9ueW1vdXMnXSBUaGUgYGNyb3NzT3JpZ2luYCBhdHRyaWJ1dGUgZm9yIGxvYWRlZCBpbWFnZXMuICBOb3RlIHRoYXRcbiAqIHlvdSBtdXN0IHByb3ZpZGUgYSBgY3Jvc3NPcmlnaW5gIHZhbHVlIGlmIHlvdSB3YW50IHRvIGFjY2VzcyBwaXhlbCBkYXRhIHdpdGggdGhlIENhbnZhcyByZW5kZXJlci5cbiAqIFNlZSBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9IVE1ML0NPUlNfZW5hYmxlZF9pbWFnZSBmb3IgbW9yZSBkZXRhaWwuXG4gKiBAcHJvcGVydHkge2Jvb2xlYW59IFtpbnRlcnBvbGF0ZT10cnVlXSBVc2UgaW50ZXJwb2xhdGVkIHZhbHVlcyB3aGVuIHJlc2FtcGxpbmcuICBCeSBkZWZhdWx0LFxuICogbGluZWFyIGludGVycG9sYXRpb24gaXMgdXNlZCB3aGVuIHJlc2FtcGxpbmcuICBTZXQgdG8gZmFsc2UgdG8gdXNlIHRoZSBuZWFyZXN0IG5laWdoYm9yIGluc3RlYWQuXG4gKiBAcHJvcGVydHkge251bWJlcn0gW21heFpvb209MTldIE1heCB6b29tLlxuICogQHByb3BlcnR5IHtib29sZWFufSBbb3BhcXVlPXRydWVdIFdoZXRoZXIgdGhlIGxheWVyIGlzIG9wYXF1ZS5cbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBbcmVwcm9qZWN0aW9uRXJyb3JUaHJlc2hvbGQ9MC41XSBNYXhpbXVtIGFsbG93ZWQgcmVwcm9qZWN0aW9uIGVycm9yIChpbiBwaXhlbHMpLlxuICogSGlnaGVyIHZhbHVlcyBjYW4gaW5jcmVhc2UgcmVwcm9qZWN0aW9uIHBlcmZvcm1hbmNlLCBidXQgZGVjcmVhc2UgcHJlY2lzaW9uLlxuICogQHByb3BlcnR5IHtpbXBvcnQoXCIuLi9UaWxlLmpzXCIpLkxvYWRGdW5jdGlvbn0gW3RpbGVMb2FkRnVuY3Rpb25dIE9wdGlvbmFsIGZ1bmN0aW9uIHRvIGxvYWQgYSB0aWxlIGdpdmVuIGEgVVJMLiBUaGUgZGVmYXVsdCBpc1xuICogYGBganNcbiAqIGZ1bmN0aW9uKGltYWdlVGlsZSwgc3JjKSB7XG4gKiAgIGltYWdlVGlsZS5nZXRJbWFnZSgpLnNyYyA9IHNyYztcbiAqIH07XG4gKiBgYGBcbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBbdHJhbnNpdGlvbj0yNTBdIER1cmF0aW9uIG9mIHRoZSBvcGFjaXR5IHRyYW5zaXRpb24gZm9yIHJlbmRlcmluZy5cbiAqIFRvIGRpc2FibGUgdGhlIG9wYWNpdHkgdHJhbnNpdGlvbiwgcGFzcyBgdHJhbnNpdGlvbjogMGAuXG4gKiBAcHJvcGVydHkge3N0cmluZ30gW3VybD0naHR0cHM6Ly90aWxlLm9wZW5zdHJlZXRtYXAub3JnL3t6fS97eH0ve3l9LnBuZyddIFVSTCB0ZW1wbGF0ZS5cbiAqIE11c3QgaW5jbHVkZSBge3h9YCwgYHt5fWAgb3IgYHsteX1gLCBhbmQgYHt6fWAgcGxhY2Vob2xkZXJzLlxuICogQHByb3BlcnR5IHtib29sZWFufSBbd3JhcFg9dHJ1ZV0gV2hldGhlciB0byB3cmFwIHRoZSB3b3JsZCBob3Jpem9udGFsbHkuXG4gKiBAcHJvcGVydHkge251bWJlcnxpbXBvcnQoXCIuLi9hcnJheS5qc1wiKS5OZWFyZXN0RGlyZWN0aW9uRnVuY3Rpb259IFt6RGlyZWN0aW9uPTBdXG4gKiBDaG9vc2Ugd2hldGhlciB0byB1c2UgdGlsZXMgd2l0aCBhIGhpZ2hlciBvciBsb3dlciB6b29tIGxldmVsIHdoZW4gYmV0d2VlbiBpbnRlZ2VyXG4gKiB6b29tIGxldmVscy4gU2VlIHtAbGluayBtb2R1bGU6b2wvdGlsZWdyaWQvVGlsZUdyaWR+VGlsZUdyaWQjZ2V0WkZvclJlc29sdXRpb259LlxuICovXG5cbi8qKlxuICogQGNsYXNzZGVzY1xuICogTGF5ZXIgc291cmNlIGZvciB0aGUgT3BlblN0cmVldE1hcCB0aWxlIHNlcnZlci5cbiAqIEBhcGlcbiAqL1xuY2xhc3MgT1NNIGV4dGVuZHMgWFlaIHtcbiAgLyoqXG4gICAqIEBwYXJhbSB7T3B0aW9uc30gW29wdGlvbnNdIE9wZW4gU3RyZWV0IE1hcCBvcHRpb25zLlxuICAgKi9cbiAgY29uc3RydWN0b3Iob3B0aW9ucykge1xuICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xuXG4gICAgbGV0IGF0dHJpYnV0aW9ucztcbiAgICBpZiAob3B0aW9ucy5hdHRyaWJ1dGlvbnMgIT09IHVuZGVmaW5lZCkge1xuICAgICAgYXR0cmlidXRpb25zID0gb3B0aW9ucy5hdHRyaWJ1dGlvbnM7XG4gICAgfSBlbHNlIHtcbiAgICAgIGF0dHJpYnV0aW9ucyA9IFtBVFRSSUJVVElPTl07XG4gICAgfVxuXG4gICAgY29uc3QgY3Jvc3NPcmlnaW4gPVxuICAgICAgb3B0aW9ucy5jcm9zc09yaWdpbiAhPT0gdW5kZWZpbmVkID8gb3B0aW9ucy5jcm9zc09yaWdpbiA6ICdhbm9ueW1vdXMnO1xuXG4gICAgY29uc3QgdXJsID1cbiAgICAgIG9wdGlvbnMudXJsICE9PSB1bmRlZmluZWRcbiAgICAgICAgPyBvcHRpb25zLnVybFxuICAgICAgICA6ICdodHRwczovL3RpbGUub3BlbnN0cmVldG1hcC5vcmcve3p9L3t4fS97eX0ucG5nJztcblxuICAgIHN1cGVyKHtcbiAgICAgIGF0dHJpYnV0aW9uczogYXR0cmlidXRpb25zLFxuICAgICAgYXR0cmlidXRpb25zQ29sbGFwc2libGU6IGZhbHNlLFxuICAgICAgY2FjaGVTaXplOiBvcHRpb25zLmNhY2hlU2l6ZSxcbiAgICAgIGNyb3NzT3JpZ2luOiBjcm9zc09yaWdpbixcbiAgICAgIGludGVycG9sYXRlOiBvcHRpb25zLmludGVycG9sYXRlLFxuICAgICAgbWF4Wm9vbTogb3B0aW9ucy5tYXhab29tICE9PSB1bmRlZmluZWQgPyBvcHRpb25zLm1heFpvb20gOiAxOSxcbiAgICAgIG9wYXF1ZTogb3B0aW9ucy5vcGFxdWUgIT09IHVuZGVmaW5lZCA/IG9wdGlvbnMub3BhcXVlIDogdHJ1ZSxcbiAgICAgIHJlcHJvamVjdGlvbkVycm9yVGhyZXNob2xkOiBvcHRpb25zLnJlcHJvamVjdGlvbkVycm9yVGhyZXNob2xkLFxuICAgICAgdGlsZUxvYWRGdW5jdGlvbjogb3B0aW9ucy50aWxlTG9hZEZ1bmN0aW9uLFxuICAgICAgdHJhbnNpdGlvbjogb3B0aW9ucy50cmFuc2l0aW9uLFxuICAgICAgdXJsOiB1cmwsXG4gICAgICB3cmFwWDogb3B0aW9ucy53cmFwWCxcbiAgICAgIHpEaXJlY3Rpb246IG9wdGlvbnMuekRpcmVjdGlvbixcbiAgICB9KTtcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBPU007XG4iXSwibmFtZXMiOlsidGFyZ2V0IiwibGF5ZXJzIiwic291cmNlIiwidXJsIiwic3R5bGUiLCJyZW5kZXJCdWZmZXIiLCJtaW5ab29tIiwidmlldyIsImNlbnRlciIsInpvb20iLCJzdHlsZVRvd24iLCJzaXplIiwiZmVhdHVyZSIsIndpZHRoIiwiZm9udCIsImNvbG9yMSIsImltYWdlIiwiZmlsbCIsImNvbG9yIiwicmFkaXVzIiwic3Ryb2tlIiwidGV4dCIsImdldCIsInN0eWxlQm9yZGVyIiwicm9hZFN0eWxlQ2FjaGUiLCJyb2FkQ29sb3IiLCJidWlsZGluZ1N0eWxlIiwid2F0ZXJTdHlsZSIsImJvdW5kYXJ5U3R5bGUiLCJyb2FkU3R5bGUiLCJraW5kIiwicmFpbHdheSIsInNvcnRfa2V5Iiwic3R5bGVLZXkiLCJ6SW5kZXgiLCJwbGFjZUJhc2UiLCJ0ZXh0U3Ryb2tlIiwicGxhY2VTdHlsZSIsImNsb25lIiwic2V0VGV4dCIsIm9mZnNldFkiLCJkZWJ1ZyIsIk9MX01CVElMRVNfREVCVUciLCJwcm9jZXNzIiwiZW52IiwiY29uc29sZSIsImJpbmQiLCJmb3JtYXRzIiwiaHR0cFBvb2xPcHRpb25zIiwib3B0aW9ucyIsIndvcmtlcnMiLCJzcWxXb3JrZXJzIiwiaHR0cE9wdGlvbnMiLCJtYXhQYWdlU2l6ZSIsIm1heFNxbFBhZ2VTaXplIiwiY2FjaGVTaXplIiwic3FsQ2FjaGVTaXplIiwiaW1wb3J0TUJUaWxlcyIsIm9wdCIsInBvb2wiLCJ0aGVuIiwib3BlbiIsInAiLCJleGVjIiwiciIsImxlbmd0aCIsImRhdGEiLCJyZWR1Y2UiLCJhIiwieCIsInJvdyIsIkVycm9yIiwibWQiLCJvcHRzIiwiZm9ybWF0IiwidG9Mb3dlckNhc2UiLCJ3YXJuIiwicHJvamVjdGlvbiIsImF0dHJpYnV0aW9ucyIsImF0dHJpYnV0aW9uIiwiZGVzY3JpcHRpb24iLCJtYXhab29tIiwicHJvakV4dGVudCIsImdldEV4dGVudCIsImJvdW5kcyIsImV4dGVudCIsInNwbGl0IiwibWFwIiwidW5kZWZpbmVkIiwicmVzb2x1dGlvbnMiLCJ6IiwicHVzaCIsInRpbGVHcmlkIiwiVGlsZUdyaWQiLCJvcmlnaW4iLCJNQlRpbGVzRm9ybWF0IiwiRmVhdHVyZSIsImNvbnN0cnVjdG9yIiwic3VwZXIiLCJ0aGlzIiwiZGF0YVByb2plY3Rpb24iLCJQcm9qZWN0aW9uIiwiY29kZSIsInVuaXRzIiwiZmVhdHVyZUNsYXNzXyIsImZlYXR1cmVDbGFzcyIsImdlb21ldHJ5TmFtZV8iLCJnZW9tZXRyeU5hbWUiLCJsYXllcnNfIiwiaWRQcm9wZXJ0eV8iLCJpZFByb3BlcnR5Iiwic3VwcG9ydGVkTWVkaWFUeXBlcyIsInJlYWRGZWF0dXJlIiwicHJvcGVydGllcyIsImlkIiwicG9pbnRzIiwibG9hZEdlb21ldHJ5IiwiZmxhdENvb3JkaW5hdGVzIiwiZW5kcyIsInR5cGUiLCJNQlR5cGVzIiwiaSIsImoiLCJ5IiwidHJhbnNmb3JtIiwicmVhZEZlYXR1cmVzIiwiZmVhdHVyZXMiLCJ0aWxlIiwiVmVjdG9yVGlsZSIsImFkYXB0T3B0aW9ucyIsInNldFdvcmxkRXh0ZW50Iiwic2V0RXh0ZW50IiwibGF5ZXJOYW1lIiwiT2JqZWN0Iiwia2V5cyIsImluY2x1ZGVzIiwibCIsImlkeCIsInZlY3RvckZlYXR1cmUiLCJnZXRQcm9wZXJ0aWVzIiwibGF5ZXIiLCJyZWFkUHJvamVjdGlvbiIsIm1vbm8iLCJtdWx0aSIsIk1CVGlsZXNWZWN0b3JTb3VyY2UiLCJ0aWxlVXJsRnVuY3Rpb24iLCJjb29yZHMiLCJzZXRUaWxlTG9hZEZ1bmN0aW9uIiwidGlsZUxvYWRlciIsIl90aWxlIiwiX3VybCIsInRpbGVDb29yZCIsInNldExvYWRlciIsInJlc29sdXRpb24iLCIkem9vbSIsIiRjb2wiLCIkcm93IiwiZ2V0Rm9ybWF0IiwiZmVhdHVyZVByb2plY3Rpb24iLCJzZXRGZWF0dXJlcyIsIm9uTG9hZCIsImNhdGNoIiwiZSIsIm9uRXJyb3IiLCJkaXNwb3NlSW50ZXJuYWwiLCJjbG9zZSIsIk1CVGlsZXNSYXN0ZXJTb3VyY2UiLCJnZXRJbWFnZSIsIlVpbnQ4QXJyYXkiLCJibG9iIiwiQmxvYiIsImltYWdlVXJsIiwiVVJMIiwiY3JlYXRlT2JqZWN0VVJMIiwic3JjIiwic2V0U3RhdGUiLCJUaWxlU3RhdGUiLCJPU00iLCJjcm9zc09yaWdpbiIsImF0dHJpYnV0aW9uc0NvbGxhcHNpYmxlIiwiaW50ZXJwb2xhdGUiLCJvcGFxdWUiLCJyZXByb2plY3Rpb25FcnJvclRocmVzaG9sZCIsInRpbGVMb2FkRnVuY3Rpb24iLCJ0cmFuc2l0aW9uIiwid3JhcFgiLCJ6RGlyZWN0aW9uIl0sInNvdXJjZVJvb3QiOiIifQ==